const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./p5.min.7_hCuTSf.js","./_commonjsHelpers.Cpj98o6Y.js"])))=>i.map(i=>d[i]);
import{s as pt,e as vt,c as Et,b as St,f as st,m as K,i as bt,X as Pt,n as ot,Y as kt,p as _t,k as J,y as h,v as Rt}from"./scheduler.D7Q2dnVI.js";import{S as yt,i as Ct,b as Tt,d as wt,m as jt,t as Bt,a as It,e as Mt}from"./index.BmfHaTgE.js";import{_ as Ot}from"./preload-helper.C1FmrZbK.js";import{b as At}from"./paths.7cD6-8Sb.js";import{w as Lt}from"./index.CTu8yMmy.js";import{g as it,c as Y,r as at,p as $,i as ct,b as Nt,e as Z,j as q,k as lt,s as ut,w as V,h as Q,d as ft,a as Ft,l as Ut,m as zt}from"./stores.KMo0qmFd.js";import{c as W}from"./constants.BfKEPlZp.js";function Ht(e){let n,r,i;return{c(){n=vt("div"),this.h()},l(c){n=Et(c,"DIV",{style:!0,class:!0}),St(n).forEach(st),this.h()},h(){K(n,"style",e[0]),K(n,"class","m-0")},m(c,E){bt(c,n,E),r||(i=Pt(e[1].call(null,n)),r=!0)},p(c,[E]){E&1&&K(n,"style",c[0])},i:ot,o:ot,d(c){c&&st(n),r=!1,i()}}}function Dt(e,n){return n.forEach(([r,i])=>e[r]=i),e}function Gt(e,n,r){let{target:i=void 0}=n,{sketch:c=void 0}=n,{parentDivStyle:E="display: block;"}=n,{debug:w=!1}=n,F;const z=kt(),M={ref(){z("ref",i)},instance(){z("instance",F)}};function L(o){return r(2,i=o),{destroy(){r(2,i=void 0)}}}return _t(async()=>{const o=await Ot(()=>import("./p5.min.7_hCuTSf.js").then(t=>t.p),__vite__mapDeps([0,1]),import.meta.url),{default:C}=o,x=Object.entries(o).filter(([t,s])=>s instanceof Function&&t[0]!=="_"&&t!=="default");w&&console.log("available p5 native classes",x),F=new C(t=>(t=Dt(t,x),w&&console.log("p5 instance",t),window._p5Instance=t,c(t)),i),M.ref(),M.instance()}),e.$$set=o=>{"target"in o&&r(2,i=o.target),"sketch"in o&&r(3,c=o.sketch),"parentDivStyle"in o&&r(0,E=o.parentDivStyle),"debug"in o&&r(4,w=o.debug)},[E,L,i,c,w]}class Jt extends yt{constructor(n){super(),Ct(this,n,Gt,Ht,pt,{target:2,sketch:3,parentDivStyle:0,debug:4})}}const ht=Lt(!1);function Yt(e){let n,r;return n=new Jt({props:{sketch:e[0]}}),{c(){Tt(n.$$.fragment)},l(i){wt(n.$$.fragment,i)},m(i,c){jt(n,i,c),r=!0},p:ot,i(i){r||(Bt(n.$$.fragment,i),r=!0)},o(i){It(n.$$.fragment,i),r=!1},d(i){Mt(n,i)}}}function dt(e,n){const r=e.x-n.x,i=e.y-n.y;return r*r+i*i}function Zt(e,n,r){let i,c,E,w;J(e,ht,t=>r(6,i=t)),J(e,it,t=>r(1,c=t)),J(e,Y,t=>r(2,E=t)),J(e,at,t=>r(3,w=t));let F;const z=t=>{t.preload=()=>{F=t.loadFont(At+"/font/CircularStd-Book.otf",()=>{ct.set(!0)})},t.setup=()=>{const s=t.createCanvas(h(V),h(Q));Nt.set(s.canvas),t.colorMode(t.HSL),t.background(0),t.frameRate(30),h(ft).length>0&&M()},t.draw=()=>{t.background(0,.1);const s=h(Z),f=h(q),l=h(lt),a=h(it),u=h(Y),m=u.highlightedEntities||h(Ft),d=u.stroke||h(Ut),p=h(ct),y=u.speed||h(zt),O=h(ut),_=h(at),P=Math.max(...Object.values(O));h($)&&(M(),$.set(!1)),S(t,s,O,P,l,m,u,d,y,a);const R={highlighted:[],normal:[]};Object.values(s).forEach(g=>{if(g.isStationary)return;m.length===0||m.includes(g.moveBy)?R.highlighted.push(g):R.normal.push(g)}),R.highlighted.length>0&&R.highlighted.forEach(g=>{o(t,g,!0,l,a,y,d,u,m)}),R.normal.length>0&&R.normal.forEach(g=>{o(t,g,!1,l,a,y,d,u,m)}),p&&x(t,f,l,u,_)}};function M(){const t=new Map,s={},f=h(Y);h(ft).forEach(l=>{const a=l[f.moveBy],u=l[f.clusterBy];s[a]||(s[a]={categories:[],moveBy:a,dataPoints:[],currentCategoryIndex:0,position:null,t:0,isStationary:!0,trail:[],loopsCompleted:0,loopsToComplete:f.loops||1}),s[a].dataPoints.push(l),s[a].categories.push(u),u!==s[a].categories[0]&&(s[a].isStationary=!1),t.has(u)||t.set(u,[]),t.get(u).push(l)}),Z.set(s),q.set(Array.from(t.entries()).sort(([l],[a])=>!isNaN(l)&&!isNaN(a)?+l-+a:l.localeCompare(a))),L()}function L(){const s=(h(V)-100)/2,f=(h(Q)-50*2)/2,l={},a=h(q).length,u=Math.PI;h(q).forEach(([p],y)=>{const O=u+y/a*Math.PI*2;l[p]={x:h(V)/2+s*Math.cos(O),y:h(Q)/2+f*Math.sin(O)}}),lt.set(l);const m=h(Z),d={};Object.values(m).forEach(p=>{const y=p.categories[0];l[y]&&(p.position={...l[y]},p.t=0,p.currentCategoryIndex=0,p.isStationary&&(d[y]||(d[y]=0),d[y]++))}),Z.set(m),S.trails={},ut.set(d)}function o(t,s,f,l,a,u,m,d,p){if(s.isStationary||!s.position)return;const y=p.length===0||f,O=W[d.clusterBy]||{start:[0,0,100],end:[0,0,0]},_=s.categories,P=s.currentCategoryIndex,R=s.position;let g=s.t||0;const U=_[P%_.length],k=_[(P+1)%_.length],v=l[U],j=l[k];if(v&&j){const H=s.isGoingBack?[0,0,40]:C(t,s,O,g,s.isGoingBack);m=s.isGoingBack?m/3:m,t.stroke(y?[...H]:[0,0,40]),t.strokeWeight(y?m:.5),t.noFill(),t.strokeJoin(t.ROUND);let T={x:null,y:null};if(a){const N={x:v.x-12.5,y:v.y-12.5},rt={x:j.x+25/2,y:j.y+25/2};T.x=t.bezierPoint(v.x,N.x-25,rt.x-25,j.x,g),T.y=t.bezierPoint(v.y,N.y+25,rt.y+25,j.y,g)}else T.x=t.lerp(v.x,j.x,g),T.y=t.lerp(v.y,j.y,g);const B=s.trail||[],X=B[B.length-1],A=1;(!X||dt(X,T)>=A*A)&&(B.length>=2&&B.shift(),B.push({x:T.x,y:T.y}));const I=.004*u;g+=I,g>1&&(g=0,s.currentCategoryIndex=(P+1)%_.length,s.currentCategoryIndex==_.length-1?(s.isGoingBack=!0,i!==!0&&!s.isStationary&&Rt(ht,i=!0,i)):s.isGoingBack=!1),s.t=g,R.x=T.x,R.y=T.y,t.beginShape();for(let D=0;D<B.length;D++){const N=B[D];t.vertex(N.x,N.y)}t.endShape()}}function C(t,s,f,l,a){var u;return a?f.end:f.start,a?f.start:f.end,(u=W[h(Y).clusterBy])==null?void 0:u.start}function S(t,s,f,l,a,u,m,d,p,y){const O=.004*p;S.trails||(S.trails={});const _=S.trails;Object.keys(f).forEach(P=>{const R=f[P],g=a[P],U=g;if(P&&R&&g){_[P]||(_[P]={t:null,trail:[],isGoingBack:!1});const k=_[P];k.t+=O,k.t>1&&(k.t=null);const v=25,j=k.t;let H={x:0,y:0};if(y){const A={x:g.x-v/2,y:g.y-v/2},I={x:U.x+v/2,y:U.y+v/2};H.x=t.bezierPoint(g.x,A.x-v,I.x-v,U.x,j),H.y=t.bezierPoint(g.y,A.y+v,I.y+v,U.y,j)}const T=1,B=k.trail[k.trail.length-1];if((!B||dt(B,H)>=T*T)&&(k.trail.length>=10&&k.trail.shift(),k.trail.push(H)),(u.length===0||u.some(A=>{const I=s[A];return I&&I.categories.includes(P)&&I.isStationary}))&&m.clusterBy){const A=W[m.clusterBy]||{start:[0,0,100],end:[0,0,0]},I=C(t,null,A,k.t,!1),D=t.map(R,1,l,d,d*5);t.noFill(),t.stroke(...I),t.strokeWeight(D),t.strokeJoin(t.ROUND),t.beginShape(),k.trail.forEach(N=>t.vertex(N.x,N.y)),t.endShape()}}})}function x(t,s,f,l,a){var u;t.fill(...((u=W[l.clusterBy])==null?void 0:u.end)||[0,0,40]),t.noStroke(),t.textFont(F),s.forEach(([m])=>{const d=f[m];if(d){if(t.push(),a)t.translate(d.x,d.y);else{let p=Math.atan2(d.y-h(Q)/2,d.x-h(V)/2);p>Math.PI/2||p<-Math.PI/2?(p+=Math.PI,t.textAlign(t.RIGHT,t.BOTTOM)):t.textAlign(t.LEFT,t.TOP),t.translate(d.x,d.y),t.rotate(p)}t.textSize(14),t.text(m,0,0),t.pop()}})}return e.$$.update=()=>{e.$$.dirty&14&&(E.clusterBy||E.moveBy||w||E.speed||c)&&(M(),$.set(!1))},[z,c,E,w]}class le extends yt{constructor(n){super(),Ct(this,n,Zt,Yt,pt,{})}}var gt={},tt={},et=34,G=10,nt=13;function xt(e){return new Function("d","return {"+e.map(function(n,r){return JSON.stringify(n)+": d["+r+'] || ""'}).join(",")+"}")}function qt(e,n){var r=xt(e);return function(i,c){return n(r(i),c,e)}}function mt(e){var n=Object.create(null),r=[];return e.forEach(function(i){for(var c in i)c in n||r.push(n[c]=c)}),r}function b(e,n){var r=e+"",i=r.length;return i<n?new Array(n-i+1).join(0)+r:r}function Vt(e){return e<0?"-"+b(-e,6):e>9999?"+"+b(e,6):b(e,4)}function Qt(e){var n=e.getUTCHours(),r=e.getUTCMinutes(),i=e.getUTCSeconds(),c=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":Vt(e.getUTCFullYear())+"-"+b(e.getUTCMonth()+1,2)+"-"+b(e.getUTCDate(),2)+(c?"T"+b(n,2)+":"+b(r,2)+":"+b(i,2)+"."+b(c,3)+"Z":i?"T"+b(n,2)+":"+b(r,2)+":"+b(i,2)+"Z":r||n?"T"+b(n,2)+":"+b(r,2)+"Z":"")}function Wt(e){var n=new RegExp('["'+e+`
\r]`),r=e.charCodeAt(0);function i(o,C){var S,x,t=c(o,function(s,f){if(S)return S(s,f-1);x=s,S=C?qt(s,C):xt(s)});return t.columns=x||[],t}function c(o,C){var S=[],x=o.length,t=0,s=0,f,l=x<=0,a=!1;o.charCodeAt(x-1)===G&&--x,o.charCodeAt(x-1)===nt&&--x;function u(){if(l)return tt;if(a)return a=!1,gt;var d,p=t,y;if(o.charCodeAt(p)===et){for(;t++<x&&o.charCodeAt(t)!==et||o.charCodeAt(++t)===et;);return(d=t)>=x?l=!0:(y=o.charCodeAt(t++))===G?a=!0:y===nt&&(a=!0,o.charCodeAt(t)===G&&++t),o.slice(p+1,d-1).replace(/""/g,'"')}for(;t<x;){if((y=o.charCodeAt(d=t++))===G)a=!0;else if(y===nt)a=!0,o.charCodeAt(t)===G&&++t;else if(y!==r)continue;return o.slice(p,d)}return l=!0,o.slice(p,x)}for(;(f=u())!==tt;){for(var m=[];f!==gt&&f!==tt;)m.push(f),f=u();C&&(m=C(m,s++))==null||S.push(m)}return S}function E(o,C){return o.map(function(S){return C.map(function(x){return L(S[x])}).join(e)})}function w(o,C){return C==null&&(C=mt(o)),[C.map(L).join(e)].concat(E(o,C)).join(`
`)}function F(o,C){return C==null&&(C=mt(o)),E(o,C).join(`
`)}function z(o){return o.map(M).join(`
`)}function M(o){return o.map(L).join(e)}function L(o){return o==null?"":o instanceof Date?Qt(o):n.test(o+="")?'"'+o.replace(/"/g,'""')+'"':o}return{parse:i,parseRows:c,format:w,formatBody:F,formatRows:z,formatRow:M,formatValue:L}}var Xt=Wt("	"),Kt=Xt.parse;function $t(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.text()}function te(e,n){return fetch(e,n).then($t)}function ee(e){return function(n,r,i){return arguments.length===2&&typeof r=="function"&&(i=r,r=void 0),te(n,r).then(function(c){return e(c,i)})}}var ue=ee(Kt);export{le as S,ht as m,ue as t};
