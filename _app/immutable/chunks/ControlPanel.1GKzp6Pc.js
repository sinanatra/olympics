import{s as We,e as b,a as A,t as W,c as B,b as F,m as Ee,g as D,f as j,d as X,o as m,i as de,h as u,u as ne,j as pe,n as Ae,v as Ve,w as Xe,k as ye,x as se,y as Se,z as fe,A as he}from"./scheduler.C4GZKIzL.js";import{e as $}from"./each.D6YF6ztN.js";import{S as Ye,i as Ze}from"./index.DmHFZWEd.js";import{c as Fe,a as re,b as H,f as De,e as $e}from"./stores.DNmsBm8e.js";import{c as Pe,f as xe}from"./constants.B-I1Kvm2.js";function Ne(e,t,r){const i=e.slice();return i[33]=t[r][0],i[34]=t[r][1],i}function Te(e,t,r){const i=e.slice();return i[34]=t[r][0],i[37]=t[r][1],i}function Me(e,t,r){const i=e.slice();return i[40]=t[r],i}function Ue(e,t,r){const i=e.slice();return i[43]=t[r],i}function Qe(e){let t,r=e[43].label+"",i;return{c(){t=b("span"),i=W(r),this.h()},l(h){t=B(h,"SPAN",{class:!0});var o=F(t);i=X(o,r),o.forEach(j),this.h()},h(){m(t,"class","filter svelte-6j7tjw")},m(h,o){de(h,t,o),u(t,i)},p(h,o){o[0]&1&&r!==(r=h[43].label+"")&&pe(i,r)},d(h){h&&j(t)}}}function He(e){let t,r=e[40]+"",i,h,o,p;function _(){return e[19](e[40])}return{c(){t=b("span"),i=W(r),h=A(),this.h()},l(c){t=B(c,"SPAN",{class:!0});var d=F(t);i=X(d,r),h=D(d),d.forEach(j),this.h()},h(){m(t,"class","svelte-6j7tjw"),fe(t,"selected",e[40]===e[4].clusterBy)},m(c,d){de(c,t,d),u(t,i),u(t,h),o||(p=ne(t,"click",_),o=!0)},p(c,d){e=c,d[0]&64&&r!==(r=e[40]+"")&&pe(i,r),d[0]&80&&fe(t,"selected",e[40]===e[4].clusterBy)},d(c){c&&j(t),o=!1,p()}}}function Re(e){let t,r=e[34]+"",i,h,o,p;function _(){return e[20](e[34])}return{c(){t=b("span"),i=W(r),h=A(),this.h()},l(c){t=B(c,"SPAN",{style:!0,class:!0});var d=F(t);i=X(d,r),h=D(d),d.forEach(j),this.h()},h(){var c;he(t,"font-size",e[13](e[37])+"px"),m(t,"class","svelte-6j7tjw"),fe(t,"selected",((c=e[4].filters[e[4].clusterBy])==null?void 0:c[0])===e[34])},m(c,d){de(c,t,d),u(t,i),u(t,h),o||(p=ne(t,"click",_),o=!0)},p(c,d){var R;e=c,d[0]&2&&r!==(r=e[34]+"")&&pe(i,r),d[0]&2&&he(t,"font-size",e[13](e[37])+"px"),d[0]&18&&fe(t,"selected",((R=e[4].filters[e[4].clusterBy])==null?void 0:R[0])===e[34])},d(c){c&&j(t),o=!1,p()}}}function Je(e){let t,r=e[33]+"",i,h,o;function p(){return e[21](e[33])}return{c(){t=b("span"),i=W(r),this.h()},l(_){t=B(_,"SPAN",{style:!0,class:!0});var c=F(t);i=X(c,r),c.forEach(j),this.h()},h(){he(t,"font-size",e[12](e[34])+"px"),m(t,"class","svelte-6j7tjw"),fe(t,"highlighted",e[3].includes(e[33]))},m(_,c){de(_,t,c),u(t,i),h||(o=ne(t,"click",p),h=!0)},p(_,c){e=_,c[0]&4&&r!==(r=e[33]+"")&&pe(i,r),c[0]&4&&he(t,"font-size",e[12](e[34])+"px"),c[0]&12&&fe(t,"highlighted",e[3].includes(e[33]))},d(_){_&&j(t),h=!1,o()}}}function Ke(e){let t,r,i=e[2].length+"",h;return{c(){t=b("p"),r=W("100 out of "),h=W(i),this.h()},l(o){t=B(o,"P",{style:!0});var p=F(t);r=X(p,"100 out of "),h=X(p,i),p.forEach(j),this.h()},h(){he(t,"border-top","1px solid"),he(t,"padding-top","10px")},m(o,p){de(o,t,p),u(t,r),u(t,h)},p(o,p){p[0]&4&&i!==(i=o[2].length+"")&&pe(h,i)},d(o){o&&j(t)}}}function et(e){let t,r,i,h="",o,p,_,c,d,R="Reset",x,I,ee="Copy Config",te,E,y,v,ie="Cluster By:",J,z,_e,M,N,ae,le=e[4].clusterBy+"",oe,ve,ge,K,me,U,l,a,g,f,q,T,Q,G=$(e[0]),C=[];for(let n=0;n<G.length;n+=1)C[n]=Qe(Ue(e,G,n));let Y=$(e[6]),w=[];for(let n=0;n<Y.length;n+=1)w[n]=He(Me(e,Y,n));let Z=$(e[1].sort()),V=[];for(let n=0;n<Z.length;n+=1)V[n]=Re(Te(e,Z,n));let ce=$(e[2].slice(0,100).sort(Ge)),S=[];for(let n=0;n<ce.length;n+=1)S[n]=Je(Ne(e,ce,n));let O=e[2].length>100&&Ke(e);return{c(){t=b("header"),r=b("div"),i=b("div"),i.innerHTML=h,o=A(),p=b("div"),_=b("div");for(let n=0;n<C.length;n+=1)C[n].c();c=A(),d=b("button"),d.textContent=R,x=A(),I=b("button"),I.textContent=ee,te=A(),E=b("div"),y=b("div"),v=b("label"),v.textContent=ie,J=A(),z=b("div");for(let n=0;n<w.length;n+=1)w[n].c();_e=A(),M=b("div"),N=b("label"),ae=W("Filter "),oe=W(le),ve=W(":"),ge=A(),K=b("div");for(let n=0;n<V.length;n+=1)V[n].c();me=A(),U=b("div"),l=b("input"),g=A(),f=b("div");for(let n=0;n<S.length;n+=1)S[n].c();q=A(),O&&O.c(),this.h()},l(n){t=B(n,"HEADER",{class:!0});var k=F(t);r=B(k,"DIV",{class:!0});var s=F(r);i=B(s,"DIV",{class:!0,"data-svelte-h":!0}),Ee(i)!=="svelte-13k81q4"&&(i.innerHTML=h),o=D(s),p=B(s,"DIV",{class:!0});var P=F(p);_=B(P,"DIV",{class:!0});var je=F(_);for(let L=0;L<C.length;L+=1)C[L].l(je);c=D(je),d=B(je,"BUTTON",{class:!0,"data-svelte-h":!0}),Ee(d)!=="svelte-qy1k7w"&&(d.textContent=R),je.forEach(j),x=D(P),I=B(P,"BUTTON",{class:!0,"data-svelte-h":!0}),Ee(I)!=="svelte-i2notl"&&(I.textContent=ee),P.forEach(j),s.forEach(j),te=D(k),E=B(k,"DIV",{class:!0});var ue=F(E);y=B(ue,"DIV",{class:!0});var Ce=F(y);v=B(Ce,"LABEL",{class:!0,"data-svelte-h":!0}),Ee(v)!=="svelte-1ekr4iz"&&(v.textContent=ie),J=D(Ce),z=B(Ce,"DIV",{class:!0});var ze=F(z);for(let L=0;L<w.length;L+=1)w[L].l(ze);ze.forEach(j),Ce.forEach(j),_e=D(ue),M=B(ue,"DIV",{class:!0});var be=F(M);N=B(be,"LABEL",{class:!0});var Be=F(N);ae=X(Be,"Filter "),oe=X(Be,le),ve=X(Be,":"),Be.forEach(j),ge=D(be),K=B(be,"DIV",{class:!0});var qe=F(K);for(let L=0;L<V.length;L+=1)V[L].l(qe);qe.forEach(j),be.forEach(j),me=D(ue),U=B(ue,"DIV",{class:!0});var we=F(U);l=B(we,"INPUT",{type:!0,placeholder:!0,class:!0}),g=D(we),f=B(we,"DIV",{class:!0});var ke=F(f);for(let L=0;L<S.length;L+=1)S[L].l(ke);q=D(ke),O&&O.l(ke),ke.forEach(j),we.forEach(j),ue.forEach(j),k.forEach(j),this.h()},h(){m(i,"class","caption"),m(d,"class","reset svelte-6j7tjw"),m(_,"class","active-filters svelte-6j7tjw"),m(I,"class","copy-config svelte-6j7tjw"),m(p,"class","header-buttons svelte-6j7tjw"),m(r,"class","header-info svelte-6j7tjw"),m(v,"class","svelte-6j7tjw"),m(z,"class","options svelte-6j7tjw"),m(y,"class","category svelte-6j7tjw"),m(N,"class","svelte-6j7tjw"),m(K,"class","options tiny svelte-6j7tjw"),m(M,"class","filtered-cluster-values svelte-6j7tjw"),m(l,"type","text"),m(l,"placeholder",a="Filter "+e[4].moveBy+"..."),l.value=e[5],m(l,"class","svelte-6j7tjw"),m(f,"class","options tiny svelte-6j7tjw"),m(U,"class","filtered-entities svelte-6j7tjw"),m(E,"class","categories svelte-6j7tjw"),m(t,"class","svelte-6j7tjw")},m(n,k){de(n,t,k),u(t,r),u(r,i),u(r,o),u(r,p),u(p,_);for(let s=0;s<C.length;s+=1)C[s]&&C[s].m(_,null);u(_,c),u(_,d),u(p,x),u(p,I),u(t,te),u(t,E),u(E,y),u(y,v),u(y,J),u(y,z);for(let s=0;s<w.length;s+=1)w[s]&&w[s].m(z,null);u(E,_e),u(E,M),u(M,N),u(N,ae),u(N,oe),u(N,ve),u(M,ge),u(M,K);for(let s=0;s<V.length;s+=1)V[s]&&V[s].m(K,null);u(E,me),u(E,U),u(U,l),u(U,g),u(U,f);for(let s=0;s<S.length;s+=1)S[s]&&S[s].m(f,null);u(f,q),O&&O.m(f,null),T||(Q=[ne(d,"click",e[10]),ne(_,"click",e[10]),ne(I,"click",e[11]),ne(l,"input",e[7])],T=!0)},p(n,k){if(k[0]&1){G=$(n[0]);let s;for(s=0;s<G.length;s+=1){const P=Ue(n,G,s);C[s]?C[s].p(P,k):(C[s]=Qe(P),C[s].c(),C[s].m(_,c))}for(;s<C.length;s+=1)C[s].d(1);C.length=G.length}if(k[0]&336){Y=$(n[6]);let s;for(s=0;s<Y.length;s+=1){const P=Me(n,Y,s);w[s]?w[s].p(P,k):(w[s]=He(P),w[s].c(),w[s].m(z,null))}for(;s<w.length;s+=1)w[s].d(1);w.length=Y.length}if(k[0]&16&&le!==(le=n[4].clusterBy+"")&&pe(oe,le),k[0]&8730){Z=$(n[1].sort());let s;for(s=0;s<Z.length;s+=1){const P=Te(n,Z,s);V[s]?V[s].p(P,k):(V[s]=Re(P),V[s].c(),V[s].m(K,null))}for(;s<V.length;s+=1)V[s].d(1);V.length=Z.length}if(k[0]&16&&a!==(a="Filter "+n[4].moveBy+"...")&&m(l,"placeholder",a),k[0]&32&&l.value!==n[5]&&(l.value=n[5]),k[0]&4108){ce=$(n[2].slice(0,100).sort(Ge));let s;for(s=0;s<ce.length;s+=1){const P=Ne(n,ce,s);S[s]?S[s].p(P,k):(S[s]=Je(P),S[s].c(),S[s].m(f,q))}for(;s<S.length;s+=1)S[s].d(1);S.length=ce.length}n[2].length>100?O?O.p(n,k):(O=Ke(n),O.c(),O.m(f,null)):O&&(O.d(1),O=null)},i:Ae,o:Ae,d(n){n&&j(t),Ve(C,n),Ve(w,n),Ve(V,n),Ve(S,n),O&&O.d(),T=!1,Xe(Q)}}}const Ie=12,tt=30,Le=12,lt=30;function Oe(e,t){const r={city:"cities",sport:"sports",height:"heights",noc:"NOCs",team:"teams",weight:"weights",year:"years",age:"ages",event:"events",medal:"medals",name:"names",is:"are"};return e===1?t:r[t]||`${t}s`}function st(e){return e.clusterBy?e.clusterBy:"all clusters"}const Ge=([e],[t])=>e.localeCompare(t);function rt(e,t,r){let i,h,o,p,_,c,d,R,x,I,ee,te,E,y,v,ie,J;ye(e,Fe,l=>r(28,E=l)),ye(e,re,l=>r(3,y=l)),ye(e,H,l=>r(4,v=l)),ye(e,De,l=>r(29,ie=l)),ye(e,$e,l=>r(18,J=l));let z=v.queryValue||"";H.update(l=>({...l,filters:l.filters||{}}));function _e(l){r(5,z=l.target.value),H.update(a=>({...a,queryValue:z}))}function M(l){var q;const a=v.filters||{},g=l.dataPoints;for(const[T,Q]of Object.entries(a)){if(!Q||Q.length===0)continue;if(!g.some(C=>{var w;const Y=(w=C[T])==null?void 0:w.toString().toLowerCase();return Q.some(Z=>Y===Z.toLowerCase())}))return!1}const f=((q=v.queryValue)==null?void 0:q.toLowerCase())||"";if(f.length>=0){const T=v.queryCategory||"name";if(!g.some(G=>{var C;return(C=G[T])==null?void 0:C.toString().toLowerCase().includes(f)}))return!1}return y.length>0?y.includes(l.moveBy):!0}function N(l,a){l==="clusterBy"?H.update(g=>({...g,clusterBy:a})):l==="moveBy"&&H.update(g=>({...g,moveBy:a}))}function ae(l){const a=v.clusterBy;H.update(g=>{var T;const f={...g.filters};return((T=f[a])==null?void 0:T[0])===l?delete f[a]:f[a]=[l],{...g,filters:f}})}function le(){H.update(l=>({...l,queryValue:"",filters:{}})),r(5,z=""),re.set([])}function oe(){const l={title:"Default Title",caption:"Add a caption here",media:!1,config:{clusterBy:v.clusterBy,moveBy:v.moveBy,filters:v.filters,queryValue:z,queryCategory:v.queryCategory||"name",speed:v.speed||6,stroke:v.stroke||10,loops:v.loopsToComplete||1,highlightedEntities:Se(re)}},a=JSON.stringify(l,null,2);navigator.clipboard.writeText(a).then(()=>{alert("Config copied to clipboard!")}).catch(g=>{console.error("Could not copy text: ",g)})}function ve(l){return d===R?Ie:Ie+(l-d)*(tt-Ie)/(R-d)}function ge(l){return ee===te?Le:Le+(l-ee)*(lt-Le)/(te-ee)}const K=l=>N("clusterBy",l),me=l=>{se(re,y=[],y),ae(l)},U=l=>{se(re,y=[],y),re.update(a=>(a.includes(l)||a.push(l),a))};return e.$$.update=()=>{if(e.$$.dirty[0]&262160&&(()=>{const l=new Set;return Object.values(J).forEach(a=>{a.dataPoints.forEach(g=>{const f=g[v.clusterBy];f&&l.add(f)})}),Array.from(l)})(),e.$$.dirty[0]&262144&&r(16,h=Object.entries(J).filter(([l,a])=>M(a)).reduce((l,[a,g])=>(l[a]=g,l),{})),e.$$.dirty[0]&65536&&r(2,p=Object.entries(h||{}).map(([l,a])=>[l,a.dataPoints.length])),e.$$.dirty[0]&4&&r(14,_=p.map(([l,a])=>l)),e.$$.dirty[0]&278528&&Object.entries(J).length!=_.length&&se(re,y=_,y),e.$$.dirty[0]&25){r(0,o=[]);const l=v.filters||{};for(const[a,g]of Object.entries(l))for(const f of g)o.push({label:f,type:a});y.length===1&&o.push({label:y[0],type:"name"})}e.$$.dirty[0]&4&&r(17,c=p.map(([l,a])=>a)),e.$$.dirty[0]&131072&&(d=c.length>0?Math.min(...c):0),e.$$.dirty[0]&131072&&(R=c.length>0?Math.max(...c):1),e.$$.dirty[0]&65552&&r(1,x=(()=>{const l={};return Object.values(h).forEach(a=>{a.dataPoints.forEach(g=>{const f=g[v.clusterBy];f&&(l[f]=(l[f]||0)+1)})}),se(De,ie=Object.entries(l),ie),Object.entries(l)})()),e.$$.dirty[0]&2&&r(15,I=x.map(([l,a])=>a)),e.$$.dirty[0]&32768&&(ee=I.length>0?Math.min(...I):0),e.$$.dirty[0]&32768&&(te=I.length>0?Math.max(...I):1),e.$$.dirty[0]&16409&&(()=>{st(v);const l=y.length>0?y.length:_.length;let a="";if(o.length>0){const g=o.find(f=>f.type==="name");if(g&&o.length===1)a=g.label.split(" ").map(f=>f.charAt(0).toUpperCase()+f.slice(1).toLowerCase()).join(" "),a=`${a} is`,se(Fe,E=`${a} ${Pe[Se(H).clusterBy].text}`,E);else{const f=o.map(q=>q.type==="name"?q.label.split(" ").map(Q=>Q.charAt(0).toUpperCase()+Q.slice(1).toLowerCase()).join(" "):`${q.type} → ${q.label}`).join(", ");a=`${l} ${Oe(l,"participant")} {${f}} ${Oe(l,"is")}`,se(Fe,E=`${a} ${Pe[Se(H).clusterBy].text}`,E)}}else a=`${l} ${Oe(l,"participant")} ${Oe(l,"is")}`,se(Fe,E=`${a} ${Pe[Se(H).clusterBy].text}`,E);return a})()},r(6,i=xe),r(0,o=[]),[o,x,p,y,v,z,i,_e,N,ae,le,oe,ve,ge,_,I,h,c,J,K,me,U]}class ut extends Ye{constructor(t){super(),Ze(this,t,rt,et,We,{},null,[-1,-1])}}export{ut as C};
