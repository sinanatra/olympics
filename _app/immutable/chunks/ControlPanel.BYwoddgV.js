import{s as Ge,e as y,t as K,a as A,c as b,b as F,d as G,f as m,g as T,l as Ie,m as v,i as de,h,q as re,j as ie,n as De,r as Fe,u as We,k as ve,v as me,w as he,x as fe,y as Xe}from"./scheduler.D7Q2dnVI.js";import{e as x}from"./each.D6YF6ztN.js";import{S as Ye,i as Ze}from"./index.BmfHaTgE.js";import{c as Oe,a as ye,b as ne,f as Le,e as $e}from"./stores.CxXQ8zAK.js";import{f as xe}from"./constants.UMJNy51y.js";function Ne(e,t,n){const i=e.slice();return i[33]=t[n][0],i[34]=t[n][1],i}function Ae(e,t,n){const i=e.slice();return i[34]=t[n][0],i[37]=t[n][1],i}function Te(e,t,n){const i=e.slice();return i[40]=t[n],i}function Me(e,t,n){const i=e.slice();return i[43]=t[n],i}function Qe(e){let t,n=e[43].label+"",i;return{c(){t=y("span"),i=K(n),this.h()},l(f){t=b(f,"SPAN",{class:!0});var o=F(t);i=G(o,n),o.forEach(m),this.h()},h(){v(t,"class","filter svelte-1ahhu9d")},m(f,o){de(f,t,o),h(t,i)},p(f,o){o[0]&1&&n!==(n=f[43].label+"")&&ie(i,n)},d(f){f&&m(t)}}}function Ue(e){let t,n=e[40]+"",i,f,o,p;function _(){return e[20](e[40])}return{c(){t=y("span"),i=K(n),f=A(),this.h()},l(c){t=b(c,"SPAN",{class:!0});var d=F(t);i=G(d,n),f=T(d),d.forEach(m),this.h()},h(){v(t,"class","svelte-1ahhu9d"),he(t,"selected",e[40]===e[4].clusterBy)},m(c,d){de(c,t,d),h(t,i),h(t,f),o||(p=re(t,"click",_),o=!0)},p(c,d){e=c,d[0]&128&&n!==(n=e[40]+"")&&ie(i,n),d[0]&144&&he(t,"selected",e[40]===e[4].clusterBy)},d(c){c&&m(t),o=!1,p()}}}function Re(e){let t,n=e[34]+"",i,f,o,p;function _(){return e[21](e[34])}return{c(){t=y("span"),i=K(n),f=A(),this.h()},l(c){t=b(c,"SPAN",{style:!0,class:!0});var d=F(t);i=G(d,n),f=T(d),d.forEach(m),this.h()},h(){var c;fe(t,"font-size",e[14](e[37])+"px"),v(t,"class","svelte-1ahhu9d"),he(t,"selected",((c=e[4].filters[e[4].clusterBy])==null?void 0:c[0])===e[34])},m(c,d){de(c,t,d),h(t,i),h(t,f),o||(p=re(t,"click",_),o=!0)},p(c,d){var W;e=c,d[0]&2&&n!==(n=e[34]+"")&&ie(i,n),d[0]&2&&fe(t,"font-size",e[14](e[37])+"px"),d[0]&18&&he(t,"selected",((W=e[4].filters[e[4].clusterBy])==null?void 0:W[0])===e[34])},d(c){c&&m(t),o=!1,p()}}}function He(e){let t,n=e[33]+"",i,f,o;function p(){return e[22](e[33])}return{c(){t=y("span"),i=K(n),this.h()},l(_){t=b(_,"SPAN",{style:!0,class:!0});var c=F(t);i=G(c,n),c.forEach(m),this.h()},h(){fe(t,"font-size",e[13](e[34])+"px"),v(t,"class","svelte-1ahhu9d"),he(t,"highlighted",e[3].includes(e[33]))},m(_,c){de(_,t,c),h(t,i),f||(o=re(t,"click",p),f=!0)},p(_,c){e=_,c[0]&4&&n!==(n=e[33]+"")&&ie(i,n),c[0]&4&&fe(t,"font-size",e[13](e[34])+"px"),c[0]&12&&he(t,"highlighted",e[3].includes(e[33]))},d(_){_&&m(t),f=!1,o()}}}function Je(e){let t,n,i=e[2].length+"",f;return{c(){t=y("p"),n=K("100 out of "),f=K(i),this.h()},l(o){t=b(o,"P",{style:!0});var p=F(t);n=G(p,"100 out of "),f=G(p,i),p.forEach(m),this.h()},h(){fe(t,"border-top","1px solid"),fe(t,"padding-top","10px")},m(o,p){de(o,t,p),h(t,n),h(t,f)},p(o,p){p[0]&4&&i!==(i=o[2].length+"")&&ie(f,i)},d(o){o&&m(t)}}}function et(e){let t,n,i,f,o,p,_,c,d,W="Reset",ee,j,te="Copy Config",le,D,P,S,C="Cluster By:",se,L,X,R,H,ae,$=e[4].clusterBy+"",oe,pe,_e,Y,ge,J,N,s,a,u,g,M,w,Q=x(e[0]),E=[];for(let r=0;r<Q.length;r+=1)E[r]=Qe(Me(e,Q,r));let U=x(e[7]),k=[];for(let r=0;r<U.length;r+=1)k[r]=Ue(Te(e,U,r));let Z=x(e[1]),V=[];for(let r=0;r<Z.length;r+=1)V[r]=Re(Ae(e,Z,r));let ce=x(e[2].slice(0,100).sort(Ke)),O=[];for(let r=0;r<ce.length;r+=1)O[r]=He(Ne(e,ce,r));let I=e[2].length>100&&Je(e);return{c(){t=y("header"),n=y("div"),i=y("div"),f=K(e[6]),o=A(),p=y("div"),_=y("div");for(let r=0;r<E.length;r+=1)E[r].c();c=A(),d=y("button"),d.textContent=W,ee=A(),j=y("button"),j.textContent=te,le=A(),D=y("div"),P=y("div"),S=y("label"),S.textContent=C,se=A(),L=y("div");for(let r=0;r<k.length;r+=1)k[r].c();X=A(),R=y("div"),H=y("label"),ae=K("Filter "),oe=K($),pe=K(":"),_e=A(),Y=y("div");for(let r=0;r<V.length;r+=1)V[r].c();ge=A(),J=y("div"),N=y("input"),a=A(),u=y("div");for(let r=0;r<O.length;r+=1)O[r].c();g=A(),I&&I.c(),this.h()},l(r){t=b(r,"HEADER",{class:!0});var B=F(t);n=b(B,"DIV",{class:!0});var l=F(n);i=b(l,"DIV",{class:!0});var z=F(i);f=G(z,e[6]),z.forEach(m),o=T(l),p=b(l,"DIV",{class:!0});var be=F(p);_=b(be,"DIV",{class:!0});var Ce=F(_);for(let q=0;q<E.length;q+=1)E[q].l(Ce);c=T(Ce),d=b(Ce,"BUTTON",{class:!0,"data-svelte-h":!0}),Ie(d)!=="svelte-qy1k7w"&&(d.textContent=W),Ce.forEach(m),ee=T(be),j=b(be,"BUTTON",{class:!0,"data-svelte-h":!0}),Ie(j)!=="svelte-i2notl"&&(j.textContent=te),be.forEach(m),l.forEach(m),le=T(B),D=b(B,"DIV",{class:!0});var ue=F(D);P=b(ue,"DIV",{class:!0});var Ee=F(P);S=b(Ee,"LABEL",{class:!0,"data-svelte-h":!0}),Ie(S)!=="svelte-1ekr4iz"&&(S.textContent=C),se=T(Ee),L=b(Ee,"DIV",{class:!0});var we=F(L);for(let q=0;q<k.length;q+=1)k[q].l(we);we.forEach(m),Ee.forEach(m),X=T(ue),R=b(ue,"DIV",{class:!0});var Be=F(R);H=b(Be,"LABEL",{class:!0});var ke=F(H);ae=G(ke,"Filter "),oe=G(ke,$),pe=G(ke,":"),ke.forEach(m),_e=T(Be),Y=b(Be,"DIV",{class:!0});var ze=F(Y);for(let q=0;q<V.length;q+=1)V[q].l(ze);ze.forEach(m),Be.forEach(m),ge=T(ue),J=b(ue,"DIV",{class:!0});var Ve=F(J);N=b(Ve,"INPUT",{type:!0,placeholder:!0,class:!0}),a=T(Ve),u=b(Ve,"DIV",{class:!0});var Se=F(u);for(let q=0;q<O.length;q+=1)O[q].l(Se);g=T(Se),I&&I.l(Se),Se.forEach(m),Ve.forEach(m),ue.forEach(m),B.forEach(m),this.h()},h(){v(i,"class","caption"),v(d,"class","reset svelte-1ahhu9d"),v(_,"class","active-filters svelte-1ahhu9d"),v(j,"class","copy-config svelte-1ahhu9d"),v(p,"class","header-buttons svelte-1ahhu9d"),v(n,"class","header-info svelte-1ahhu9d"),v(S,"class","svelte-1ahhu9d"),v(L,"class","options svelte-1ahhu9d"),v(P,"class","category svelte-1ahhu9d"),v(H,"class","svelte-1ahhu9d"),v(Y,"class","options tiny svelte-1ahhu9d"),v(R,"class","filtered-cluster-values svelte-1ahhu9d"),v(N,"type","text"),v(N,"placeholder",s="Filter "+e[4].moveBy+"..."),N.value=e[5],v(N,"class","svelte-1ahhu9d"),v(u,"class","options tiny svelte-1ahhu9d"),v(J,"class","filtered-entities svelte-1ahhu9d"),v(D,"class","categories svelte-1ahhu9d"),v(t,"class","svelte-1ahhu9d")},m(r,B){de(r,t,B),h(t,n),h(n,i),h(i,f),h(n,o),h(n,p),h(p,_);for(let l=0;l<E.length;l+=1)E[l]&&E[l].m(_,null);h(_,c),h(_,d),h(p,ee),h(p,j),h(t,le),h(t,D),h(D,P),h(P,S),h(P,se),h(P,L);for(let l=0;l<k.length;l+=1)k[l]&&k[l].m(L,null);h(D,X),h(D,R),h(R,H),h(H,ae),h(H,oe),h(H,pe),h(R,_e),h(R,Y);for(let l=0;l<V.length;l+=1)V[l]&&V[l].m(Y,null);h(D,ge),h(D,J),h(J,N),h(J,a),h(J,u);for(let l=0;l<O.length;l+=1)O[l]&&O[l].m(u,null);h(u,g),I&&I.m(u,null),M||(w=[re(d,"click",e[11]),re(_,"click",e[11]),re(j,"click",e[12]),re(N,"input",e[8])],M=!0)},p(r,B){if(B[0]&64&&ie(f,r[6]),B[0]&1){Q=x(r[0]);let l;for(l=0;l<Q.length;l+=1){const z=Me(r,Q,l);E[l]?E[l].p(z,B):(E[l]=Qe(z),E[l].c(),E[l].m(_,c))}for(;l<E.length;l+=1)E[l].d(1);E.length=Q.length}if(B[0]&656){U=x(r[7]);let l;for(l=0;l<U.length;l+=1){const z=Te(r,U,l);k[l]?k[l].p(z,B):(k[l]=Ue(z),k[l].c(),k[l].m(L,null))}for(;l<k.length;l+=1)k[l].d(1);k.length=U.length}if(B[0]&16&&$!==($=r[4].clusterBy+"")&&ie(oe,$),B[0]&17426){Z=x(r[1]);let l;for(l=0;l<Z.length;l+=1){const z=Ae(r,Z,l);V[l]?V[l].p(z,B):(V[l]=Re(z),V[l].c(),V[l].m(Y,null))}for(;l<V.length;l+=1)V[l].d(1);V.length=Z.length}if(B[0]&16&&s!==(s="Filter "+r[4].moveBy+"...")&&v(N,"placeholder",s),B[0]&32&&N.value!==r[5]&&(N.value=r[5]),B[0]&8204){ce=x(r[2].slice(0,100).sort(Ke));let l;for(l=0;l<ce.length;l+=1){const z=Ne(r,ce,l);O[l]?O[l].p(z,B):(O[l]=He(z),O[l].c(),O[l].m(u,g))}for(;l<O.length;l+=1)O[l].d(1);O.length=ce.length}r[2].length>100?I?I.p(r,B):(I=Je(r),I.c(),I.m(u,null)):I&&(I.d(1),I=null)},i:De,o:De,d(r){r&&m(t),Fe(E,r),Fe(k,r),Fe(V,r),Fe(O,r),I&&I.d(),M=!1,We(w)}}}const je=12,tt=30,qe=12,lt=30;function Pe(e,t){const n={city:"cities",sport:"sports",height:"heights",noc:"NOCs",team:"teams",weight:"weights",year:"years",age:"ages",event:"events",medal:"medals",name:"names",is:"are"};return e===1?t:n[t]||`${t}s`}function st(e){return e.clusterBy?e.clusterBy:"all clusters"}const Ke=([e],[t])=>e.localeCompare(t);function nt(e,t,n){let i,f,o,p,_,c,d,W,ee,j,te,le,D,P,S,C,se,L;ve(e,Oe,s=>n(28,P=s)),ve(e,ye,s=>n(3,S=s)),ve(e,ne,s=>n(4,C=s)),ve(e,Le,s=>n(29,se=s)),ve(e,$e,s=>n(19,L=s));let X=C.queryValue||"";ne.update(s=>({...s,filters:s.filters||{}}));function R(s){n(5,X=s.target.value),ne.update(a=>({...a,queryValue:X}))}function H(s){var M;const a=C.filters||{},u=s.dataPoints;for(const[w,Q]of Object.entries(a)){if(!Q||Q.length===0)continue;if(!u.some(U=>{var Z;const k=(Z=U[w])==null?void 0:Z.toString().toLowerCase();return Q.some(V=>k===V.toLowerCase())}))return!1}const g=((M=C.queryValue)==null?void 0:M.toLowerCase())||"";if(g.length>=3){const w=C.queryCategory||"name";if(!u.some(E=>{var U;return(U=E[w])==null?void 0:U.toString().toLowerCase().includes(g)}))return!1}return S.length>0?S.includes(s.moveBy):!0}function ae(s,a){s==="clusterBy"?ne.update(u=>({...u,clusterBy:a})):s==="moveBy"&&ne.update(u=>({...u,moveBy:a}))}function $(s){const a=C.clusterBy;ne.update(u=>{var w;const g={...u.filters};return((w=g[a])==null?void 0:w[0])===s?delete g[a]:g[a]=[s],{...u,filters:g}})}function oe(){ne.update(s=>({...s,queryValue:"",filters:{}})),n(5,X=""),ye.set([])}function pe(){const s={title:"Default Title",caption:"Add a caption here",media:!1,config:{clusterBy:C.clusterBy,moveBy:C.moveBy,filters:C.filters,queryValue:X,queryCategory:C.queryCategory||"name",speed:C.speed||6,stroke:C.stroke||10,loops:C.loopsToComplete||1,highlightedEntities:Xe(ye)}},a=JSON.stringify(s,null,2);navigator.clipboard.writeText(a).then(()=>{alert("Config copied to clipboard!")}).catch(u=>{console.error("Could not copy text: ",u)})}function _e(s){return d===W?je:je+(s-d)*(tt-je)/(W-d)}function Y(s){return te===le?qe:qe+(s-te)*(lt-qe)/(le-te)}const ge=s=>ae("clusterBy",s),J=s=>$(s),N=s=>{ye.update(a=>(a.includes(s)||a.push(s),a))};return e.$$.update=()=>{if(e.$$.dirty[0]&524304&&(()=>{const s=new Set;return Object.values(L).forEach(a=>{a.dataPoints.forEach(u=>{const g=u[C.clusterBy];g&&s.add(g)})}),Array.from(s)})(),e.$$.dirty[0]&524288&&n(17,f=Object.entries(L).filter(([s,a])=>H(a)).reduce((s,[a,u])=>(s[a]=u,s),{})),e.$$.dirty[0]&131072&&n(2,p=Object.entries(f||{}).map(([s,a])=>[s,a.dataPoints.length])),e.$$.dirty[0]&4&&n(15,_=p.map(([s,a])=>s)),e.$$.dirty[0]&557056&&Object.entries(L).length!=_.length&&me(ye,S=_,S),e.$$.dirty[0]&25){n(0,o=[]);const s=C.filters||{};for(const[a,u]of Object.entries(s))for(const g of u)o.push({label:g,type:a});S.length===1&&o.push({label:S[0],type:"name"})}e.$$.dirty[0]&4&&n(18,c=p.map(([s,a])=>a)),e.$$.dirty[0]&262144&&(d=c.length>0?Math.min(...c):0),e.$$.dirty[0]&262144&&(W=c.length>0?Math.max(...c):1),e.$$.dirty[0]&131088&&n(1,ee=(()=>{const s={};return Object.values(f).forEach(a=>{a.dataPoints.forEach(u=>{const g=u[C.clusterBy];g&&(s[g]=(s[g]||0)+1)})}),me(Le,se=Object.entries(s),se),Object.entries(s)})()),e.$$.dirty[0]&2&&n(16,j=ee.map(([s,a])=>a)),e.$$.dirty[0]&65536&&(te=j.length>0?Math.min(...j):0),e.$$.dirty[0]&65536&&(le=j.length>0?Math.max(...j):1),e.$$.dirty[0]&32793&&n(6,D=(()=>{const s=st(C),a=S.length>0?S.length:_.length;let u="";if(o.length>0){const g=o.find(M=>M.type==="name");if(g&&o.length===1)u=`${g.label} is shown moving across ${s}`,me(Oe,P=u,P);else{const M=o.map(w=>w.type==="name"?w.label:`${w.type}:${w.label}`).join(", ");u=`${a} ${Pe(a,"participant")} [${M}]  ${Pe(a,"is")} seen moving across ${s}`,me(Oe,P=u,P)}}else u=`${a}  ${Pe(a,"participant")}  ${Pe(a,"is")} grouped by ${s}`,me(Oe,P=u,P);return u})())},n(7,i=xe),n(0,o=[]),[o,ee,p,S,C,X,D,i,R,ae,$,oe,pe,_e,Y,_,j,f,c,L,ge,J,N]}class ut extends Ye{constructor(t){super(),Ze(this,t,nt,et,Ge,{},null,[-1,-1])}}export{ut as C};
