const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./p5.min.7_hCuTSf.js","./_commonjsHelpers.Cpj98o6Y.js"])))=>i.map(i=>d[i]);
import{s as gt,e as Ct,c as xt,b as vt,f as rt,m as Q,i as Et,X as St,n as nt,Y as Pt,o as bt,k as X,x as h}from"./scheduler.Xi5sktIg.js";import{S as mt,i as pt,c as kt,a as Rt,m as _t,d as Tt,t as jt,e as It}from"./index.DXItMEGr.js";import{_ as wt}from"./preload-helper.C1FmrZbK.js";import{b as Mt}from"./paths.ei0ocZ3p.js";import{f as st,c as V,r as it,p as K,g as at,w as G,h as W,b as Bt,d as ct,e as J,i as Y,j as lt,a as Ot,s as At,k as Nt,l as ut}from"./stores.DfVWKANe.js";import{c as Z}from"./constants.BfKEPlZp.js";function Ft(n){let o,s,i;return{c(){o=Ct("div"),this.h()},l(c){o=xt(c,"DIV",{style:!0,class:!0}),vt(o).forEach(rt),this.h()},h(){Q(o,"style",n[0]),Q(o,"class","m-0")},m(c,S){Et(c,o,S),s||(i=St(n[1].call(null,o)),s=!0)},p(c,[S]){S&1&&Q(o,"style",c[0])},i:nt,o:nt,d(c){c&&rt(o),s=!1,i()}}}function Lt(n,o){return o.forEach(([s,i])=>n[s]=i),n}function Ut(n,o,s){let{target:i=void 0}=o,{sketch:c=void 0}=o,{parentDivStyle:S="display: block;"}=o,{debug:M=!1}=o,U;const A=Pt(),F={ref(){A("ref",i)},instance(){A("instance",U)}};function B(r){return s(2,i=r),{destroy(){s(2,i=void 0)}}}return bt(async()=>{const r=await wt(()=>import("./p5.min.7_hCuTSf.js").then(e=>e.p),__vite__mapDeps([0,1]),import.meta.url),{default:m}=r,t=Object.entries(r).filter(([e,f])=>f instanceof Function&&e[0]!=="_"&&e!=="default");M&&console.log("available p5 native classes",t),U=new m(e=>(e=Lt(e,t),M&&console.log("p5 instance",e),window._p5Instance=e,c(e)),i),F.ref(),F.instance()}),n.$$set=r=>{"target"in r&&s(2,i=r.target),"sketch"in r&&s(3,c=r.sketch),"parentDivStyle"in r&&s(0,S=r.parentDivStyle),"debug"in r&&s(4,M=r.debug)},[S,B,i,c,M]}class Dt extends mt{constructor(o){super(),pt(this,o,Ut,Ft,gt,{target:2,sketch:3,parentDivStyle:0,debug:4})}}function zt(n){let o,s;return o=new Dt({props:{sketch:n[0]}}),{c(){kt(o.$$.fragment)},l(i){Rt(o.$$.fragment,i)},m(i,c){_t(o,i,c),s=!0},p:nt,i(i){s||(Tt(o.$$.fragment,i),s=!0)},o(i){jt(o.$$.fragment,i),s=!1},d(i){It(o,i)}}}function ft(n,o){const s=n.x-o.x,i=n.y-o.y;return s*s+i*i}function Ht(n,o,s){let i,c,S;X(n,st,t=>s(1,i=t)),X(n,V,t=>s(2,c=t)),X(n,it,t=>s(3,S=t));let M;const U=t=>{t.preload=()=>{M=t.loadFont(Mt+"/font/CircularStd-Book.otf",()=>{at.set(!0)})},t.setup=()=>{const e=t.createCanvas(h(G),h(W));Bt.set(e.canvas),t.colorMode(t.HSL),t.background(0),t.frameRate(30),h(ct).length>0&&A()},t.draw=()=>{t.background(0,.05);const e=h(J),f=h(Y),a=h(lt),u=h(st),l=h(V),C=l.highlightedEntities||h(Ot),d=l.stroke||h(At),p=h(at),y=l.speed||h(Nt),v=h(ut),T=h(it),P=Math.max(...Object.values(v));h(K)&&(A(),K.set(!1)),m(t,e,v,P,a,C,l,d,y,u);const k={highlighted:[],normal:[]};Object.values(e).forEach(g=>{if(g.isStationary)return;C.length===0||C.includes(g.moveBy)?k.highlighted.push(g):k.normal.push(g)}),k.highlighted.length>0&&k.highlighted.forEach(g=>{B(t,g,!0,a,u,y,d,l,C)}),k.normal.length>0&&k.normal.forEach(g=>{B(t,g,!1,a,u,y,d,l,C)}),p&&_(t,f,a,l,T)}};function A(){const t=new Map,e={},f=h(V);h(ct).forEach(a=>{const u=a[f.moveBy],l=a[f.clusterBy];e[u]||(e[u]={categories:[],moveBy:u,dataPoints:[],currentCategoryIndex:0,position:null,t:0,isStationary:!0,trail:[],loopsCompleted:0,loopsToComplete:f.loops||1}),e[u].dataPoints.push(a),e[u].categories.push(l),l!==e[u].categories[0]&&(e[u].isStationary=!1),t.has(l)||t.set(l,[]),t.get(l).push(a)}),J.set(e),Y.set(Array.from(t.entries()).sort(([a],[u])=>!isNaN(a)&&!isNaN(u)?+a-+u:a.localeCompare(u))),F()}function F(){const e=(h(G)-100)/2,f=(h(W)-50*2)/2,a={},u=h(Y).length,l=Math.PI;h(Y).forEach(([p],y)=>{const v=l+y/u*Math.PI*2;a[p]={x:h(G)/2+e*Math.cos(v),y:h(W)/2+f*Math.sin(v)}}),lt.set(a);const C=h(J),d={};Object.values(C).forEach(p=>{const y=p.categories[0];a[y]&&(p.position={...a[y]},p.t=0,p.currentCategoryIndex=0,p.isStationary&&(d[y]||(d[y]=0),d[y]++))}),J.set(C),m.trails={},ut.set(d)}function B(t,e,f,a,u,l,C,d,p){if(e.isStationary||!e.position)return;const y=p.length===0||f,v=Z[d.clusterBy]||{start:[0,0,100],end:[0,0,0]},T=e.categories,P=e.currentCategoryIndex,k=e.position;let g=e.t||0;const L=T[P%T.length],b=T[(P+1)%T.length],x=a[L],j=a[b];if(x&&j){const D=r(t,e,v,g,e.isGoingBack);t.stroke(y?[...D]:[0,0,40]),t.strokeWeight(y?C:.5),t.noFill(),t.strokeJoin(t.ROUND);let R={x:null,y:null};if(u){const N={x:x.x-12.5,y:x.y-12.5},ot={x:j.x+25/2,y:j.y+25/2};R.x=t.bezierPoint(x.x,N.x-25,ot.x-25,j.x,g),R.y=t.bezierPoint(x.y,N.y+25,ot.y+25,j.y,g)}else R.x=t.lerp(x.x,j.x,g),R.y=t.lerp(x.y,j.y,g);const I=e.trail||[],q=I[I.length-1],O=1;(!q||ft(q,R)>=O*O)&&(I.length>=2&&I.shift(),I.push({x:R.x,y:R.y}));const w=.004*l;g+=w,g>1&&(g=0,e.currentCategoryIndex=(P+1)%T.length,e.currentCategoryIndex===0?(e.loopsCompleted+=1,e.isGoingBack=!0):e.isGoingBack=!1),e.t=g,k.x=R.x,k.y=R.y,t.beginShape();for(let z=0;z<I.length;z++){const N=I[z];t.vertex(N.x,N.y)}t.endShape()}}function r(t,e,f,a,u){var l;return u?f.end:f.start,u?f.start:f.end,(l=Z[h(V).clusterBy])==null?void 0:l.start}function m(t,e,f,a,u,l,C,d,p,y){const v=.004*p;m.trails||(m.trails={});const T=m.trails;Object.keys(f).forEach(P=>{const k=f[P],g=u[P],L=g;if(P&&k&&g){T[P]||(T[P]={t:null,trail:[],isGoingBack:!1});const b=T[P];b.t+=v,b.t>1&&(b.t=null);const x=25,j=b.t;let D={x:0,y:0};if(y){const O={x:g.x-x/2,y:g.y-x/2},w={x:L.x+x/2,y:L.y+x/2};D.x=t.bezierPoint(g.x,O.x-x,w.x-x,L.x,j),D.y=t.bezierPoint(g.y,O.y+x,w.y+x,L.y,j)}const R=1,I=b.trail[b.trail.length-1];if((!I||ft(I,D)>=R*R)&&(b.trail.length>=10&&b.trail.shift(),b.trail.push(D)),(l.length===0||l.some(O=>{const w=e[O];return w&&w.categories.includes(P)&&w.isStationary}))&&C.clusterBy){const O=Z[C.clusterBy]||{start:[0,0,100],end:[0,0,0]},w=r(t,null,O,b.t,!1),z=t.map(k,1,a,d,d*5);t.noFill(),t.stroke(...w),t.strokeWeight(z),t.strokeJoin(t.ROUND),t.beginShape(),b.trail.forEach(N=>t.vertex(N.x,N.y)),t.endShape()}}})}function _(t,e,f,a,u){var l;t.fill(...((l=Z[a.clusterBy])==null?void 0:l.end)||[0,0,40]),t.noStroke(),t.textFont(M),e.forEach(([C])=>{const d=f[C];if(d){if(t.push(),u)t.translate(d.x,d.y);else{let p=Math.atan2(d.y-h(W)/2,d.x-h(G)/2);p>Math.PI/2||p<-Math.PI/2?(p+=Math.PI,t.textAlign(t.RIGHT,t.BOTTOM)):t.textAlign(t.LEFT,t.TOP),t.translate(d.x,d.y),t.rotate(p)}t.textSize(14),t.text(C,0,0),t.pop()}})}return n.$$.update=()=>{n.$$.dirty&14&&(c.clusterBy||c.moveBy||S||c.speed||i)&&(A(),K.set(!1))},[U,i,c,S]}class re extends mt{constructor(o){super(),pt(this,o,Ht,zt,gt,{})}}var ht={},$={},tt=34,H=10,et=13;function yt(n){return new Function("d","return {"+n.map(function(o,s){return JSON.stringify(o)+": d["+s+'] || ""'}).join(",")+"}")}function Vt(n,o){var s=yt(n);return function(i,c){return o(s(i),c,n)}}function dt(n){var o=Object.create(null),s=[];return n.forEach(function(i){for(var c in i)c in o||s.push(o[c]=c)}),s}function E(n,o){var s=n+"",i=s.length;return i<o?new Array(o-i+1).join(0)+s:s}function Gt(n){return n<0?"-"+E(-n,6):n>9999?"+"+E(n,6):E(n,4)}function Wt(n){var o=n.getUTCHours(),s=n.getUTCMinutes(),i=n.getUTCSeconds(),c=n.getUTCMilliseconds();return isNaN(n)?"Invalid Date":Gt(n.getUTCFullYear())+"-"+E(n.getUTCMonth()+1,2)+"-"+E(n.getUTCDate(),2)+(c?"T"+E(o,2)+":"+E(s,2)+":"+E(i,2)+"."+E(c,3)+"Z":i?"T"+E(o,2)+":"+E(s,2)+":"+E(i,2)+"Z":s||o?"T"+E(o,2)+":"+E(s,2)+"Z":"")}function Jt(n){var o=new RegExp('["'+n+`
\r]`),s=n.charCodeAt(0);function i(r,m){var _,t,e=c(r,function(f,a){if(_)return _(f,a-1);t=f,_=m?Vt(f,m):yt(f)});return e.columns=t||[],e}function c(r,m){var _=[],t=r.length,e=0,f=0,a,u=t<=0,l=!1;r.charCodeAt(t-1)===H&&--t,r.charCodeAt(t-1)===et&&--t;function C(){if(u)return $;if(l)return l=!1,ht;var p,y=e,v;if(r.charCodeAt(y)===tt){for(;e++<t&&r.charCodeAt(e)!==tt||r.charCodeAt(++e)===tt;);return(p=e)>=t?u=!0:(v=r.charCodeAt(e++))===H?l=!0:v===et&&(l=!0,r.charCodeAt(e)===H&&++e),r.slice(y+1,p-1).replace(/""/g,'"')}for(;e<t;){if((v=r.charCodeAt(p=e++))===H)l=!0;else if(v===et)l=!0,r.charCodeAt(e)===H&&++e;else if(v!==s)continue;return r.slice(y,p)}return u=!0,r.slice(y,t)}for(;(a=C())!==$;){for(var d=[];a!==ht&&a!==$;)d.push(a),a=C();m&&(d=m(d,f++))==null||_.push(d)}return _}function S(r,m){return r.map(function(_){return m.map(function(t){return B(_[t])}).join(n)})}function M(r,m){return m==null&&(m=dt(r)),[m.map(B).join(n)].concat(S(r,m)).join(`
`)}function U(r,m){return m==null&&(m=dt(r)),S(r,m).join(`
`)}function A(r){return r.map(F).join(`
`)}function F(r){return r.map(B).join(n)}function B(r){return r==null?"":r instanceof Date?Wt(r):o.test(r+="")?'"'+r.replace(/"/g,'""')+'"':r}return{parse:i,parseRows:c,format:M,formatBody:U,formatRows:A,formatRow:F,formatValue:B}}var Yt=Jt("	"),Zt=Yt.parse;function qt(n){if(!n.ok)throw new Error(n.status+" "+n.statusText);return n.text()}function Qt(n,o){return fetch(n,o).then(qt)}function Xt(n){return function(o,s,i){return arguments.length===2&&typeof s=="function"&&(i=s,s=void 0),Qt(o,s).then(function(c){return n(c,i)})}}var se=Xt(Zt);export{re as S,se as t};
