import{s as dt,e as vt,c as Et,b as St,f as st,m as G,i as bt,Z as wt,n as ot,_ as Tt,q as Pt,k as Q,F as c}from"./scheduler.aNKYHOcM.js";import{S as gt,i as mt,b as Mt,d as It,m as Lt,a as Rt,t as kt,e as jt}from"./index.DU0ByNF3.js";import{_ as Ot}from"./preload-helper.C1FmrZbK.js";import{b as Bt}from"./paths.DdYthPW-.js";import{w as At}from"./index.C2MJvcFY.js";import{j as it,a as V,r as K,p as $,l as at,w as F,i as N,g as ct,e as q,h as Ft,b as Y,m as Z,s as Nt,k as _t,n as ut,c as H}from"./constants.DwiyTaa0.js";function ae(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function Ut(e){let n,s,a;return{c(){n=vt("div"),this.h()},l(u){n=Et(u,"DIV",{style:!0,class:!0}),St(n).forEach(st),this.h()},h(){G(n,"style",e[0]),G(n,"class","m-0")},m(u,b){bt(u,n,b),s||(a=wt(e[1].call(null,n)),s=!0)},p(u,[b]){b&1&&G(n,"style",u[0])},i:ot,o:ot,d(u){u&&st(n),s=!1,a()}}}function Dt(e,n){return n.forEach(([s,a])=>e[s]=a),e}function zt(e,n,s){let{target:a=void 0}=n,{sketch:u=void 0}=n,{parentDivStyle:b="display: block;"}=n,{debug:O=!1}=n,_;const A=Tt(),R={ref(){A("ref",a)},instance(){A("instance",_)}};function B(o){return s(2,a=o),{destroy(){s(2,a=void 0)}}}return Pt(async()=>{const o=await Ot(()=>import("./p5.min.D8xqWc_1.js").then(r=>r.p),[],import.meta.url),{default:m}=o,i=Object.entries(o).filter(([r,l])=>l instanceof Function&&r[0]!=="_"&&r!=="default");O&&console.log("available p5 native classes",i),_=new m(r=>(r=Dt(r,i),O&&console.log("p5 instance",r),window._p5Instance=r,u(r)),a),R.ref(),R.instance()}),e.$$set=o=>{"target"in o&&s(2,a=o.target),"sketch"in o&&s(3,u=o.sketch),"parentDivStyle"in o&&s(0,b=o.parentDivStyle),"debug"in o&&s(4,O=o.debug)},[b,B,a,u,O]}class Ht extends gt{constructor(n){super(),mt(this,n,zt,Ut,dt,{target:2,sketch:3,parentDivStyle:0,debug:4})}}const pt=At({entityCompletedLoop:!1,completedEntity:null});function Wt(e){pt.set({entityCompletedLoop:!0,completedEntity:e})}function ce(){pt.set({entityCompletedLoop:!1,completedEntity:null})}function Vt(e){let n,s;return n=new Ht({props:{sketch:e[0]}}),{c(){Mt(n.$$.fragment)},l(a){It(n.$$.fragment,a)},m(a,u){Lt(n,a,u),s=!0},p:ot,i(a){s||(Rt(n.$$.fragment,a),s=!0)},o(a){kt(n.$$.fragment,a),s=!1},d(a){jt(n,a)}}}function lt(e,n){const s=e.x-n.x,a=e.y-n.y;return s*s+a*a}function qt(e,n,s){let a,u,b;Q(e,it,t=>s(1,a=t)),Q(e,V,t=>s(2,u=t)),Q(e,K,t=>s(3,b=t));let O;const _=t=>{t.preload=()=>{O=t.loadFont(Bt+"/font/CircularStd-Book.otf",()=>{at.set(!0)})},t.setup=()=>{t.createCanvas(c(F),c(N)),t.colorMode(t.HSL),t.background(0),t.frameRate(60),c(ct).length>0&&(A(),R())},t.draw=()=>{t.background(0,.1);const i=c(q),r=c(Ft),l=c(Y),f=c(Z),p=c(it),h=c(V),d=h.stroke||c(Nt),y=c(at),C=h.speed||c(_t),P=c(ut),g=c(K);c($)&&(A(),R(),$.set(!1)),o(t,i,P,f,r,h,d,C);const M={highlighted:[],normal:[]};Object.values(i).forEach(x=>{if(x.isStationary)return;r.length===0||r.includes(x.moveBy)?M.highlighted.push(x):M.normal.push(x)}),M.highlighted.length>0&&M.highlighted.forEach(x=>{B(t,x,!0,f,p,C,d,h,r)}),M.normal.length>0&&M.normal.forEach(x=>{B(t,x,!1,f,p,C,d,h,r)}),y&&m(t,l,f,h,g)},t.windowResized=()=>{F.set(window.innerWidth),N.set(window.innerHeight-200),t.resizeCanvas(c(F),c(N)),t.background(0),R()}};function A(){const t=new Map,i={};c(ct).forEach(r=>{const l=r[c(V).moveBy],f=r[c(V).clusterBy];i[l]||(i[l]={categories:[],moveBy:l,dataPoints:[],currentCategoryIndex:0,position:{x:0,y:0},t:0,isStationary:!0,trail:[]}),i[l].dataPoints.push(r),i[l].categories.push(f),f!==i[l].categories[0]&&(i[l].isStationary=!1),t.has(f)||t.set(f,[]),t.get(f).push(r)}),q.set(i),Y.set(Array.from(t.entries()).sort(([r],[l])=>!isNaN(r)&&!isNaN(l)?+r-+l:r.localeCompare(l)))}function R(){const i=(c(F)-100)/2,r=(c(N)-50*2)/2,l={};c(Y).forEach(([h],d)=>{const y=d/c(Y).length*Math.PI*2,C=c(K)?{x:50+Math.random()*(c(F)-2*50),y:50+Math.random()*(c(N)-2*50)}:{x:c(F)/2+i*Math.cos(y),y:c(N)/2+r*Math.sin(y)};l[h]={x:C.x+(Math.random()-.5),y:C.y+(Math.random()-.5)}}),Z.set(l);const f=c(q),p={};Object.values(f).forEach(h=>{const d=h.categories[0];c(Z)[d]&&(h.position={...c(Z)[d]},h.t=0,h.currentCategoryIndex=0,h.isStationary&&(p[d]||(p[d]=0),p[d]++))}),q.set(f),ut.set(p)}function B(t,i,r,l,f,p,h,d,y){var T;if(i.isStationary)return;const C=y.length===0||r,P=C&&H[d.clusterBy]?(T=H[d.clusterBy])==null?void 0:T.start:[0,0,20];t.stroke(...P),t.strokeWeight(C?h:1),t.noFill(),t.strokeJoin(t.ROUND);const g=i.categories,M=i.currentCategoryIndex,x=i.position;let w=i.t||0;const J=1,rt=4;if(i.trail||(i.trail=[]),g.length>0){const U=g[M%g.length],D=g[(M+1)%g.length],v=l[U],k=l[D];if(v&&k){let E={x:0,y:0};if(U===D){const L=t.TWO_PI*w;E.x=v.x+5*t.cos(L),E.y=v.y+5*t.sin(L)}else if(f){const I=v.x+(k.x-v.x)/2,L=v.y,Ct=k.x,xt=v.y+(k.y-v.y)/2;E.x=t.bezierPoint(v.x,I,Ct,k.x,w),E.y=t.bezierPoint(v.y,L,xt,k.y,w)}else E.x=t.lerp(v.x,k.x,w),E.y=t.lerp(v.y,k.y,w);const j=i.trail,z=j[j.length-1];(!z||lt(z,E)>=J*J)&&(j.length>=rt&&j.shift(),j.push({x:E.x,y:E.y}));const X=.004*p;w+=X,w>1&&(w=0,i.currentCategoryIndex=(M+1)%g.length,i.currentCategoryIndex===0&&r&&Wt(i.moveBy)),i.t=w,x.x=E.x,x.y=E.y,t.beginShape();for(let I=0;I<j.length;I++){const L=j[I];t.vertex(L.x,L.y)}t.endShape()}}}function o(t,i,r,l,f,p,h,d){const y=r,C=.004*d;o.trails||(o.trails={});const P=o.trails;Object.keys(y).forEach(g=>{var w;const M=y[g],x=l[g];if(x){P[g]||(P[g]={t:Math.random(),trail:[]});const T=P[g];T.t+=C,T.t>1&&(T.t=0);const U=T.t*t.TWO_PI,D=5+Math.sqrt(M),v=x.x+D*t.cos(U),k=x.y+D*t.sin(U),E={x:v,y:k},j=T.trail[T.trail.length-1];(!j||lt(j,E)>=2*2)&&(T.trail.length>=4&&T.trail.shift(),T.trail.push(E));const z=f.length===0||f.some(I=>{const L=i[I];return L&&L.categories.includes(g)&&L.isStationary}),X=z&&H[p.clusterBy]?(w=H[p.clusterBy])==null?void 0:w.start:[0,0,40];t.noFill(),t.stroke(...X),t.strokeWeight(z?h:1),t.strokeJoin(t.ROUND),t.beginShape(),T.trail.forEach(I=>t.vertex(I.x,I.y)),t.endShape()}})}function m(t,i,r,l,f){var p;t.fill(...((p=H[l.clusterBy])==null?void 0:p.start)||[0,0,40]),t.noStroke(),t.textFont(O),i.forEach(([h])=>{const d=r[h];if(d){if(t.push(),f)t.translate(d.x,d.y);else{let y=Math.atan2(d.y-c(N)/2,d.x-c(F)/2);y>Math.PI/2||y<-Math.PI/2?(y+=Math.PI,t.textAlign(t.RIGHT,t.BOTTOM)):t.textAlign(t.LEFT,t.TOP),t.translate(d.x,d.y),t.rotate(y)}t.textSize(14),t.text(h,0,0),t.pop()}})}return e.$$.update=()=>{e.$$.dirty&14&&(u.clusterBy||u.moveBy||b||u.speed||a)&&(A(),R(),$.set(!1))},[_,a,u,b]}class ue extends gt{constructor(n){super(),mt(this,n,qt,Vt,dt,{})}}var ft={},tt={},et=34,W=10,nt=13;function yt(e){return new Function("d","return {"+e.map(function(n,s){return JSON.stringify(n)+": d["+s+'] || ""'}).join(",")+"}")}function Yt(e,n){var s=yt(e);return function(a,u){return n(s(a),u,e)}}function ht(e){var n=Object.create(null),s=[];return e.forEach(function(a){for(var u in a)u in n||s.push(n[u]=u)}),s}function S(e,n){var s=e+"",a=s.length;return a<n?new Array(n-a+1).join(0)+s:s}function Zt(e){return e<0?"-"+S(-e,6):e>9999?"+"+S(e,6):S(e,4)}function Jt(e){var n=e.getUTCHours(),s=e.getUTCMinutes(),a=e.getUTCSeconds(),u=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":Zt(e.getUTCFullYear())+"-"+S(e.getUTCMonth()+1,2)+"-"+S(e.getUTCDate(),2)+(u?"T"+S(n,2)+":"+S(s,2)+":"+S(a,2)+"."+S(u,3)+"Z":a?"T"+S(n,2)+":"+S(s,2)+":"+S(a,2)+"Z":s||n?"T"+S(n,2)+":"+S(s,2)+"Z":"")}function Xt(e){var n=new RegExp('["'+e+`
\r]`),s=e.charCodeAt(0);function a(o,m){var t,i,r=u(o,function(l,f){if(t)return t(l,f-1);i=l,t=m?Yt(l,m):yt(l)});return r.columns=i||[],r}function u(o,m){var t=[],i=o.length,r=0,l=0,f,p=i<=0,h=!1;o.charCodeAt(i-1)===W&&--i,o.charCodeAt(i-1)===nt&&--i;function d(){if(p)return tt;if(h)return h=!1,ft;var C,P=r,g;if(o.charCodeAt(P)===et){for(;r++<i&&o.charCodeAt(r)!==et||o.charCodeAt(++r)===et;);return(C=r)>=i?p=!0:(g=o.charCodeAt(r++))===W?h=!0:g===nt&&(h=!0,o.charCodeAt(r)===W&&++r),o.slice(P+1,C-1).replace(/""/g,'"')}for(;r<i;){if((g=o.charCodeAt(C=r++))===W)h=!0;else if(g===nt)h=!0,o.charCodeAt(r)===W&&++r;else if(g!==s)continue;return o.slice(P,C)}return p=!0,o.slice(P,i)}for(;(f=d())!==tt;){for(var y=[];f!==ft&&f!==tt;)y.push(f),f=d();m&&(y=m(y,l++))==null||t.push(y)}return t}function b(o,m){return o.map(function(t){return m.map(function(i){return B(t[i])}).join(e)})}function O(o,m){return m==null&&(m=ht(o)),[m.map(B).join(e)].concat(b(o,m)).join(`
`)}function _(o,m){return m==null&&(m=ht(o)),b(o,m).join(`
`)}function A(o){return o.map(R).join(`
`)}function R(o){return o.map(B).join(e)}function B(o){return o==null?"":o instanceof Date?Jt(o):n.test(o+="")?'"'+o.replace(/"/g,'""')+'"':o}return{parse:a,parseRows:u,format:O,formatBody:_,formatRows:A,formatRow:R,formatValue:B}}var Gt=Xt("	"),Qt=Gt.parse;function Kt(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.text()}function $t(e,n){return fetch(e,n).then(Kt)}function te(e){return function(n,s,a){return arguments.length===2&&typeof s=="function"&&(a=s,s=void 0),$t(n,s).then(function(u){return e(u,a)})}}var le=te(Qt);export{ue as S,ae as e,pt as l,Wt as m,ce as r,le as t};
