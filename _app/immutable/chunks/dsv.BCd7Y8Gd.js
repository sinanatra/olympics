const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./p5.min.7_hCuTSf.js","./_commonjsHelpers.Cpj98o6Y.js"])))=>i.map(i=>d[i]);
import{s as pt,e as vt,c as Et,b as St,f as st,m as K,i as bt,X as Pt,n as ot,Y as Rt,p as kt,k as V,y as l,v as _t}from"./scheduler.D7Q2dnVI.js";import{S as yt,i as Ct,b as Tt,d as wt,m as Bt,t as jt,a as It,e as Mt}from"./index.BmfHaTgE.js";import{_ as At}from"./preload-helper.C1FmrZbK.js";import{b as Nt}from"./paths.BFqNsWpV.js";import{w as Ot}from"./index.CTu8yMmy.js";import{i as it,b as G,r as at,p as $,j as ct,g as Lt,e as Q,k as W,l as lt,s as ut,w as J,h as Y,d as ft,a as Ft,m as Ut,n as zt,c as Ht}from"./stores.CxXQ8zAK.js";import{c as Z}from"./constants.UMJNy51y.js";function Dt(e){let n,r,i;return{c(){n=vt("div"),this.h()},l(c){n=Et(c,"DIV",{style:!0,class:!0}),St(n).forEach(st),this.h()},h(){K(n,"style",e[0]),K(n,"class","m-0")},m(c,E){bt(c,n,E),r||(i=Pt(e[1].call(null,n)),r=!0)},p(c,[E]){E&1&&K(n,"style",c[0])},i:ot,o:ot,d(c){c&&st(n),r=!1,i()}}}function Gt(e,n){return n.forEach(([r,i])=>e[r]=i),e}function Jt(e,n,r){let{target:i=void 0}=n,{sketch:c=void 0}=n,{parentDivStyle:E="display: block;"}=n,{debug:w=!1}=n,F;const z=Rt(),M={ref(){z("ref",i)},instance(){z("instance",F)}};function O(o){return r(2,i=o),{destroy(){r(2,i=void 0)}}}return kt(async()=>{const o=await At(()=>import("./p5.min.7_hCuTSf.js").then(t=>t.p),__vite__mapDeps([0,1]),import.meta.url),{default:C}=o,x=Object.entries(o).filter(([t,s])=>s instanceof Function&&t[0]!=="_"&&t!=="default");w&&console.log("available p5 native classes",x),F=new C(t=>(t=Gt(t,x),w&&console.log("p5 instance",t),window._p5Instance=t,c(t)),i),M.ref(),M.instance()}),e.$$set=o=>{"target"in o&&r(2,i=o.target),"sketch"in o&&r(3,c=o.sketch),"parentDivStyle"in o&&r(0,E=o.parentDivStyle),"debug"in o&&r(4,w=o.debug)},[E,O,i,c,w]}class Yt extends yt{constructor(n){super(),Ct(this,n,Jt,Dt,pt,{target:2,sketch:3,parentDivStyle:0,debug:4})}}const ht=Ot(!1);function Zt(e){let n,r;return n=new Yt({props:{sketch:e[0]}}),{c(){Tt(n.$$.fragment)},l(i){wt(n.$$.fragment,i)},m(i,c){Bt(n,i,c),r=!0},p:ot,i(i){r||(jt(n.$$.fragment,i),r=!0)},o(i){It(n.$$.fragment,i),r=!1},d(i){Mt(n,i)}}}function dt(e,n){const r=e.x-n.x,i=e.y-n.y;return r*r+i*i}function qt(e,n,r){let i,c,E,w;V(e,ht,t=>r(6,i=t)),V(e,it,t=>r(1,c=t)),V(e,G,t=>r(2,E=t)),V(e,at,t=>r(3,w=t));let F;const z=t=>{t.preload=()=>{F=t.loadFont(Nt+"/font/CircularStd-Book.otf",()=>{ct.set(!0)})},t.setup=()=>{const s=t.createCanvas(l(J),l(Y));Lt.set(s.canvas),t.colorMode(t.HSL),t.background(0),t.frameRate(30),l(ft).length>0&&M()},t.draw=()=>{t.background(0,.1);const s=l(Q),h=l(W),u=l(lt),a=l(it),f=l(G),m=f.highlightedEntities||l(Ft),d=f.stroke||l(Ut),p=l(ct),y=f.speed||l(zt),A=l(ut),k=l(at),P=Math.max(...Object.values(A));l($)&&(M(),$.set(!1)),S(t,s,A,P,u,m,f,d,y,a);const _={highlighted:[],normal:[]};Object.values(s).forEach(g=>{if(g.isStationary)return;m.length===0||m.includes(g.moveBy)?_.highlighted.push(g):_.normal.push(g)}),_.highlighted.length>0&&_.highlighted.forEach(g=>{o(t,g,!0,u,a,y,d,f,m)}),_.normal.length>0&&_.normal.forEach(g=>{o(t,g,!1,u,a,y,d,f,m)}),p&&(x(t,h,u,f,k),t.textAlign(t.CENTER,t.CENTER),t.textSize(18),t.text(l(G).caption||l(Ht)||Z[f.clusterBy].text,l(J)/2,l(Y)/2))}};function M(){const t=new Map,s={},h=l(G);l(ft).forEach(u=>{const a=u[h.moveBy],f=u[h.clusterBy];s[a]||(s[a]={categories:[],moveBy:a,dataPoints:[],currentCategoryIndex:0,position:null,t:0,isStationary:!0,trail:[],loopsCompleted:0,loopsToComplete:h.loops||1}),s[a].dataPoints.push(u),s[a].categories.push(f),f!==s[a].categories[0]&&(s[a].isStationary=!1),t.has(f)||t.set(f,[]),t.get(f).push(u)}),Q.set(s),W.set(Array.from(t.entries()).sort(([u],[a])=>!isNaN(u)&&!isNaN(a)?+u-+a:u.localeCompare(a))),O()}function O(){const s=(l(J)-100)/2,h=(l(Y)-50*2)/2,u={},a=l(W).length,f=Math.PI;l(W).forEach(([p],y)=>{const A=f+y/a*Math.PI*2;u[p]={x:l(J)/2+s*Math.cos(A),y:l(Y)/2+h*Math.sin(A)}}),lt.set(u);const m=l(Q),d={};Object.values(m).forEach(p=>{const y=p.categories[0];u[y]&&(p.position={...u[y]},p.t=0,p.currentCategoryIndex=0,p.isStationary&&(d[y]||(d[y]=0),d[y]++))}),Q.set(m),S.trails={},ut.set(d)}function o(t,s,h,u,a,f,m,d,p){if(s.isStationary||!s.position)return;const y=p.length===0||h,A=Z[d.clusterBy]||{start:[0,0,100],end:[0,0,0]},k=s.categories,P=s.currentCategoryIndex,_=s.position;let g=s.t||0;const U=k[P%k.length],R=k[(P+1)%k.length],v=u[U],B=u[R];if(v&&B){const H=s.isGoingBack?[0,0,20]:C(t,s,A,g,s.isGoingBack);m=s.isGoingBack?m/3:m,t.stroke(y?[...H]:[0,0,20]),t.strokeWeight(y?m:.5),t.noFill(),t.strokeJoin(t.ROUND);let T={x:null,y:null};if(a){const L={x:v.x-12.5,y:v.y-12.5},rt={x:B.x+25/2,y:B.y+25/2};T.x=t.bezierPoint(v.x,L.x-25,rt.x-25,B.x,g),T.y=t.bezierPoint(v.y,L.y+25,rt.y+25,B.y,g)}else T.x=t.lerp(v.x,B.x,g),T.y=t.lerp(v.y,B.y,g);const j=s.trail||[],X=j[j.length-1],N=1;(!X||dt(X,T)>=N*N)&&(j.length>=2&&j.shift(),j.push({x:T.x,y:T.y}));const I=.004*f;g+=I,g>1&&(g=0,s.currentCategoryIndex=(P+1)%k.length,s.currentCategoryIndex==k.length-1?(s.isGoingBack=!0,i!==!0&&!s.isStationary&&_t(ht,i=!0,i)):s.isGoingBack=!1),s.t=g,_.x=T.x,_.y=T.y,t.beginShape();for(let D=0;D<j.length;D++){const L=j[D];t.vertex(L.x,L.y)}t.endShape()}}function C(t,s,h,u,a){var f;return a?h.end:h.start,a?h.start:h.end,(f=Z[l(G).clusterBy])==null?void 0:f.start}function S(t,s,h,u,a,f,m,d,p,y){const A=.004*p;S.trails||(S.trails={});const k=S.trails;Object.keys(h).forEach(P=>{const _=h[P],g=a[P],U=g;if(P&&_&&g){k[P]||(k[P]={t:null,trail:[],isGoingBack:!1});const R=k[P];R.t+=A,R.t>1&&(R.t=null);const v=25,B=R.t;let H={x:0,y:0};if(y){const N={x:g.x-v/2,y:g.y-v/2},I={x:U.x+v/2,y:U.y+v/2};H.x=t.bezierPoint(g.x,N.x-v,I.x-v,U.x,B),H.y=t.bezierPoint(g.y,N.y+v,I.y+v,U.y,B)}const T=1,j=R.trail[R.trail.length-1];if((!j||dt(j,H)>=T*T)&&(R.trail.length>=10&&R.trail.shift(),R.trail.push(H)),(f.length===0||f.some(N=>{const I=s[N];return I&&I.categories.includes(P)&&I.isStationary}))&&m.clusterBy){const N=Z[m.clusterBy]||{start:[0,0,100],end:[0,0,0]},I=C(t,null,N,R.t,!1),D=t.map(_,1,u,d,d*5);t.noFill(),t.stroke(...I),t.strokeWeight(D),t.strokeJoin(t.ROUND),t.beginShape(),R.trail.forEach(L=>t.vertex(L.x,L.y)),t.endShape()}}})}function x(t,s,h,u,a){var f;t.fill(...((f=Z[u.clusterBy])==null?void 0:f.end)||[0,0,20]),t.noStroke(),t.textFont(F),s.forEach(([m])=>{const d=h[m];if(d){if(t.push(),a)t.translate(d.x,d.y);else{let p=Math.atan2(d.y-l(Y)/2,d.x-l(J)/2);p>Math.PI/2||p<-Math.PI/2?(p+=Math.PI,t.textAlign(t.RIGHT,t.BOTTOM)):t.textAlign(t.LEFT,t.TOP),t.translate(d.x,d.y),t.rotate(p)}t.textSize(14),t.text(m,0,0),t.pop()}})}return e.$$.update=()=>{e.$$.dirty&14&&(E.clusterBy||E.moveBy||w||E.speed||c)&&(M(),$.set(!1))},[z,c,E,w]}class ue extends yt{constructor(n){super(),Ct(this,n,qt,Zt,pt,{})}}var gt={},tt={},et=34,q=10,nt=13;function xt(e){return new Function("d","return {"+e.map(function(n,r){return JSON.stringify(n)+": d["+r+'] || ""'}).join(",")+"}")}function Vt(e,n){var r=xt(e);return function(i,c){return n(r(i),c,e)}}function mt(e){var n=Object.create(null),r=[];return e.forEach(function(i){for(var c in i)c in n||r.push(n[c]=c)}),r}function b(e,n){var r=e+"",i=r.length;return i<n?new Array(n-i+1).join(0)+r:r}function Qt(e){return e<0?"-"+b(-e,6):e>9999?"+"+b(e,6):b(e,4)}function Wt(e){var n=e.getUTCHours(),r=e.getUTCMinutes(),i=e.getUTCSeconds(),c=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":Qt(e.getUTCFullYear())+"-"+b(e.getUTCMonth()+1,2)+"-"+b(e.getUTCDate(),2)+(c?"T"+b(n,2)+":"+b(r,2)+":"+b(i,2)+"."+b(c,3)+"Z":i?"T"+b(n,2)+":"+b(r,2)+":"+b(i,2)+"Z":r||n?"T"+b(n,2)+":"+b(r,2)+"Z":"")}function Xt(e){var n=new RegExp('["'+e+`
\r]`),r=e.charCodeAt(0);function i(o,C){var S,x,t=c(o,function(s,h){if(S)return S(s,h-1);x=s,S=C?Vt(s,C):xt(s)});return t.columns=x||[],t}function c(o,C){var S=[],x=o.length,t=0,s=0,h,u=x<=0,a=!1;o.charCodeAt(x-1)===q&&--x,o.charCodeAt(x-1)===nt&&--x;function f(){if(u)return tt;if(a)return a=!1,gt;var d,p=t,y;if(o.charCodeAt(p)===et){for(;t++<x&&o.charCodeAt(t)!==et||o.charCodeAt(++t)===et;);return(d=t)>=x?u=!0:(y=o.charCodeAt(t++))===q?a=!0:y===nt&&(a=!0,o.charCodeAt(t)===q&&++t),o.slice(p+1,d-1).replace(/""/g,'"')}for(;t<x;){if((y=o.charCodeAt(d=t++))===q)a=!0;else if(y===nt)a=!0,o.charCodeAt(t)===q&&++t;else if(y!==r)continue;return o.slice(p,d)}return u=!0,o.slice(p,x)}for(;(h=f())!==tt;){for(var m=[];h!==gt&&h!==tt;)m.push(h),h=f();C&&(m=C(m,s++))==null||S.push(m)}return S}function E(o,C){return o.map(function(S){return C.map(function(x){return O(S[x])}).join(e)})}function w(o,C){return C==null&&(C=mt(o)),[C.map(O).join(e)].concat(E(o,C)).join(`
`)}function F(o,C){return C==null&&(C=mt(o)),E(o,C).join(`
`)}function z(o){return o.map(M).join(`
`)}function M(o){return o.map(O).join(e)}function O(o){return o==null?"":o instanceof Date?Wt(o):n.test(o+="")?'"'+o.replace(/"/g,'""')+'"':o}return{parse:i,parseRows:c,format:w,formatBody:F,formatRows:z,formatRow:M,formatValue:O}}var Kt=Xt("	"),$t=Kt.parse;function te(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.text()}function ee(e,n){return fetch(e,n).then(te)}function ne(e){return function(n,r,i){return arguments.length===2&&typeof r=="function"&&(i=r,r=void 0),ee(n,r).then(function(c){return e(c,i)})}}var fe=ne($t);export{ue as S,ht as m,fe as t};
