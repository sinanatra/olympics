import{s as ut,e as gt,c as pt,b as yt,f as $,m as V,i as Ct,Z as vt,n as X,_ as xt,q as Et,k as Z,F as s}from"./scheduler.aNKYHOcM.js";import{S as lt,i as ft,b as St,d as bt,m as wt,a as Mt,t as Pt,e as Tt}from"./index.DU0ByNF3.js";import{b as kt}from"./paths.pdMlI7kY.js";import{_ as It}from"./preload-helper.C1FmrZbK.js";import{a as w,j as tt,r as J,p as Y,l as et,w as T,i as k,g as nt,e as A,h as B,s as ot,b as z,m as I,n as rt,k as st,c as W}from"./constants.DULgNhVI.js";import{w as Lt}from"./index.C2MJvcFY.js";function $t(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function jt(e){let n,c,a;return{c(){n=gt("div"),this.h()},l(f){n=pt(f,"DIV",{style:!0,class:!0}),yt(n).forEach($),this.h()},h(){V(n,"style",e[0]),V(n,"class","m-0")},m(f,C){Ct(f,n,C),c||(a=vt(e[1].call(null,n)),c=!0)},p(f,[C]){C&1&&V(n,"style",f[0])},i:X,o:X,d(f){f&&$(n),c=!1,a()}}}function Rt(e,n){return n.forEach(([c,a])=>e[c]=a),e}function Ot(e,n,c){let{target:a=void 0}=n,{sketch:f=void 0}=n,{parentDivStyle:C="display: block;"}=n,{debug:b=!1}=n,L;const M=xt(),E={ref(){M("ref",a)},instance(){M("instance",L)}};function P(o){return c(2,a=o),{destroy(){c(2,a=void 0)}}}return Et(async()=>{const o=await It(()=>import("./p5.min.D8xqWc_1.js").then(i=>i.p),[],import.meta.url),{default:g}=o,r=Object.entries(o).filter(([i,u])=>u instanceof Function&&i[0]!=="_"&&i!=="default");b&&console.log("available p5 native classes",r),L=new g(i=>(i=Rt(i,r),b&&console.log("p5 instance",i),window._p5Instance=i,f(i)),a),E.ref(),E.instance()}),e.$$set=o=>{"target"in o&&c(2,a=o.target),"sketch"in o&&c(3,f=o.sketch),"parentDivStyle"in o&&c(0,C=o.parentDivStyle),"debug"in o&&c(4,b=o.debug)},[C,P,a,f,b]}class At extends lt{constructor(n){super(),ft(this,n,Ot,jt,ut,{target:2,sketch:3,parentDivStyle:0,debug:4})}}const ht=Lt({entityCompletedLoop:!1,completedEntity:null});function Bt(e){ht.set({entityCompletedLoop:!0,completedEntity:e})}function te(){ht.set({entityCompletedLoop:!1,completedEntity:null})}function Ft(e){let n,c;return n=new At({props:{sketch:e[0]}}),{c(){St(n.$$.fragment)},l(a){bt(n.$$.fragment,a)},m(a,f){wt(n,a,f),c=!0},p:X,i(a){c||(Mt(n.$$.fragment,a),c=!0)},o(a){Pt(n.$$.fragment,a),c=!1},d(a){Tt(n,a)}}}function it(e,n){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function Nt(e,n,c){let a,f,C;Z(e,w,t=>c(1,a=t)),Z(e,tt,t=>c(2,f=t)),Z(e,J,t=>c(3,C=t));let b;const L=t=>{t.preload=()=>{b=t.loadFont(kt+"/font/CircularStd-Book.otf",()=>{et.set(!0)})},t.setup=()=>{t.createCanvas(s(T),s(k)),t.colorMode(t.HSL),t.background(0),s(nt).length>0&&(M(),E())},t.draw=()=>{t.background(0,.1),s(Y)&&(M(),E(),Y.set(!1)),o(t),Object.values(s(A)).forEach(r=>{const i=s(B).includes(r.moveBy);P(t,r,i,a.stroke||s(ot))}),s(et)&&g(t)},t.windowResized=()=>{T.set(window.innerWidth),k.set(window.innerHeight-200),t.resizeCanvas(s(T),s(k)),t.background(s(T),s(k)),E()}};function M(){const t=new Map,r={};s(nt).forEach(i=>{const u=i[s(w).moveBy],l=i[s(w).clusterBy];r[u]||(r[u]={categories:[],moveBy:u,dataPoints:[],currentCategoryIndex:0,position:{x:0,y:0},t:0,isStationary:!0,trail:[]}),r[u].dataPoints.push(i),r[u].categories.push(l),l!==r[u].categories[0]&&(r[u].isStationary=!1),t.has(l)||t.set(l,[]),t.get(l).push(i)}),A.set(r),z.set(Array.from(t.entries()).sort(([i],[u])=>!isNaN(i)&&!isNaN(u)?+i-+u:i.localeCompare(u)))}function E(){const r=(s(T)-100)/2,i=(s(k)-50*2)/2,u={};s(z).forEach(([m],d)=>{const x=d/s(z).length*Math.PI*2,S=s(J)?{x:50+Math.random()*(s(T)-2*50),y:50+Math.random()*(s(k)-2*50)}:{x:s(T)/2+r*Math.cos(x),y:s(k)/2+i*Math.sin(x)};u[m]={x:S.x+(Math.random()-.5),y:S.y+(Math.random()-.5)}}),I.set(u);const l=s(A),p={};Object.values(l).forEach(m=>{const d=m.categories[0];s(I)[d]&&(m.position={...s(I)[d]},m.t=0,m.currentCategoryIndex=0,m.isStationary&&(p[d]||(p[d]=0),p[d]++))}),A.set(l),rt.set(p)}function P(t,r,i,u){if(r.isStationary)return;const{categories:l,currentCategoryIndex:p,position:m}=r;let d=r.t||0;const x=1,S=4;if(r.trail||(r.trail=[]),l.length>0){const v=s(I)[l[p%l.length]],h=s(I)[l[(p+1)%l.length]];if(v&&h){const j={x:v.x-25,y:v.y-25},R={x:h.x+25,y:h.y+25};s(tt)?(m.x=t.bezierPoint(v.x,j.x-50,R.x-50,h.x,d),m.y=t.bezierPoint(v.y,j.y+50,R.y+50,h.y,d)):(m.x=t.lerp(v.x,h.x,d),m.y=t.lerp(v.y,h.y,d));const N=r.trail[r.trail.length-1];(!N||it(N,m)>=x)&&(r.trail.push({...m}),r.trail.length>S&&r.trail.shift());const q=.003*s(w).speed||.003*s(st);d+=q,d>1&&(d=0,r.currentCategoryIndex++,r.currentCategoryIndex>=l.length&&(r.currentCategoryIndex=0,i&&Bt(r.moveBy))),r.t=d;const _=s(B).length===0||i?W[s(w).clusterBy].start:[0,0,40];t.noFill(),t.stroke(..._),t.strokeWeight(s(B).length===0||i?u:1),t.strokeJoin(t.ROUND),t.beginShape(),r.trail.forEach(O=>t.vertex(O.x,O.y)),t.endShape()}}}function o(t){const r=s(rt),i=s(I),u=.003*s(w).speed||.003*s(st);o.trails||(o.trails={});const l=o.trails;Object.keys(r).forEach(p=>{var x;const m=r[p],d=i[p];if(d){l[p]||(l[p]={t:Math.random(),trail:[]});const h=l[p];h.t+=u,h.t>1&&(h.t=0);const j=h.t*t.TWO_PI,R=5+Math.sqrt(m),N=d.x+R*t.cos(j),q=d.y+R*t.sin(j),_={x:N,y:q},O=h.trail[h.trail.length-1];(!O||it(O,_)>=2)&&(h.trail.push(_),h.trail.length>4&&h.trail.shift());const K=s(B).length===0||s(B).some(U=>{const H=s(A)[U];return H&&H.categories.includes(p)&&H.isStationary}),dt=K&&W[s(w).clusterBy]?(x=W[s(w).clusterBy])==null?void 0:x.start:[0,0,40];t.noFill(),t.stroke(...dt),t.strokeWeight(K?a.stroke||s(ot):1),t.strokeJoin(t.ROUND),t.beginShape(),h.trail.forEach(U=>t.vertex(U.x,U.y)),t.endShape()}})}function g(t){var r;t.fill(...((r=W[s(w).clusterBy])==null?void 0:r.start)||[0,0,40]),t.noStroke(),t.textFont(b),s(z).forEach(([i])=>{const u=s(I)[i];if(u){if(t.push(),s(J))t.translate(u.x,u.y);else{let l=Math.atan2(u.y-s(k)/2,u.x-s(T)/2);l>Math.PI/2||l<-Math.PI/2?(l+=Math.PI,t.textAlign(t.RIGHT,t.BOTTOM)):t.textAlign(t.LEFT,t.TOP),t.translate(u.x,u.y),t.rotate(l)}t.textSize(14),t.text(i,0,0),t.pop()}})}return e.$$.update=()=>{e.$$.dirty&14&&(a.clusterBy||a.moveBy||C||a.speed||f)&&(M(),E(),Y.set(!1))},[L,a,f,C]}class ee extends lt{constructor(n){super(),ft(this,n,Nt,Ft,ut,{})}}var at={},G={},Q=34,F=10,D=13;function mt(e){return new Function("d","return {"+e.map(function(n,c){return JSON.stringify(n)+": d["+c+'] || ""'}).join(",")+"}")}function _t(e,n){var c=mt(e);return function(a,f){return n(c(a),f,e)}}function ct(e){var n=Object.create(null),c=[];return e.forEach(function(a){for(var f in a)f in n||c.push(n[f]=f)}),c}function y(e,n){var c=e+"",a=c.length;return a<n?new Array(n-a+1).join(0)+c:c}function Ut(e){return e<0?"-"+y(-e,6):e>9999?"+"+y(e,6):y(e,4)}function zt(e){var n=e.getUTCHours(),c=e.getUTCMinutes(),a=e.getUTCSeconds(),f=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":Ut(e.getUTCFullYear())+"-"+y(e.getUTCMonth()+1,2)+"-"+y(e.getUTCDate(),2)+(f?"T"+y(n,2)+":"+y(c,2)+":"+y(a,2)+"."+y(f,3)+"Z":a?"T"+y(n,2)+":"+y(c,2)+":"+y(a,2)+"Z":c||n?"T"+y(n,2)+":"+y(c,2)+"Z":"")}function Wt(e){var n=new RegExp('["'+e+`
\r]`),c=e.charCodeAt(0);function a(o,g){var t,r,i=f(o,function(u,l){if(t)return t(u,l-1);r=u,t=g?_t(u,g):mt(u)});return i.columns=r||[],i}function f(o,g){var t=[],r=o.length,i=0,u=0,l,p=r<=0,m=!1;o.charCodeAt(r-1)===F&&--r,o.charCodeAt(r-1)===D&&--r;function d(){if(p)return G;if(m)return m=!1,at;var S,v=i,h;if(o.charCodeAt(v)===Q){for(;i++<r&&o.charCodeAt(i)!==Q||o.charCodeAt(++i)===Q;);return(S=i)>=r?p=!0:(h=o.charCodeAt(i++))===F?m=!0:h===D&&(m=!0,o.charCodeAt(i)===F&&++i),o.slice(v+1,S-1).replace(/""/g,'"')}for(;i<r;){if((h=o.charCodeAt(S=i++))===F)m=!0;else if(h===D)m=!0,o.charCodeAt(i)===F&&++i;else if(h!==c)continue;return o.slice(v,S)}return p=!0,o.slice(v,r)}for(;(l=d())!==G;){for(var x=[];l!==at&&l!==G;)x.push(l),l=d();g&&(x=g(x,u++))==null||t.push(x)}return t}function C(o,g){return o.map(function(t){return g.map(function(r){return P(t[r])}).join(e)})}function b(o,g){return g==null&&(g=ct(o)),[g.map(P).join(e)].concat(C(o,g)).join(`
`)}function L(o,g){return g==null&&(g=ct(o)),C(o,g).join(`
`)}function M(o){return o.map(E).join(`
`)}function E(o){return o.map(P).join(e)}function P(o){return o==null?"":o instanceof Date?zt(o):n.test(o+="")?'"'+o.replace(/"/g,'""')+'"':o}return{parse:a,parseRows:f,format:b,formatBody:L,formatRows:M,formatRow:E,formatValue:P}}var qt=Wt("	"),Ht=qt.parse;function Vt(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.text()}function Zt(e,n){return fetch(e,n).then(Vt)}function Jt(e){return function(n,c,a){return arguments.length===2&&typeof c=="function"&&(a=c,c=void 0),Zt(n,c).then(function(f){return e(f,a)})}}var ne=Jt(Ht);export{ee as S,$t as e,ht as l,Bt as m,te as r,ne as t};
