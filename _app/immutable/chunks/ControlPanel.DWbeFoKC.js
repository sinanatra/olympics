import{s as Ke,e as C,t as U,a as N,c as E,b as S,d as R,f as y,g as A,l as Oe,m,i as fe,h as c,q as se,j as re,n as we,r as Ve,u as Ge,k as Se,v as ze,w as ce,x as he,y as We}from"./scheduler.D7Q2dnVI.js";import{e as Y}from"./each.D6YF6ztN.js";import{S as Xe,i as Ye}from"./index.BmfHaTgE.js";import{a as ve,c as le,f as De,e as Ze}from"./stores.KMo0qmFd.js";import{f as $e}from"./constants.BfKEPlZp.js";function Le(e,t,r){const i=e.slice();return i[32]=t[r][0],i[33]=t[r][1],i}function Ne(e,t,r){const i=e.slice();return i[33]=t[r][0],i[36]=t[r][1],i}function Ae(e,t,r){const i=e.slice();return i[39]=t[r],i}function Te(e,t,r){const i=e.slice();return i[42]=t[r],i}function Me(e){let t,r=e[42].label+"",i;return{c(){t=C("span"),i=U(r),this.h()},l(h){t=E(h,"SPAN",{class:!0});var o=S(t);i=R(o,r),o.forEach(y),this.h()},h(){m(t,"class","filter svelte-1ahhu9d")},m(h,o){fe(h,t,o),c(t,i)},p(h,o){o[0]&1&&r!==(r=h[42].label+"")&&re(i,r)},d(h){h&&y(t)}}}function Qe(e){let t,r=e[39]+"",i,h,o,p;function _(){return e[20](e[39])}return{c(){t=C("span"),i=U(r),h=N(),this.h()},l(u){t=E(u,"SPAN",{class:!0});var f=S(t);i=R(f,r),h=A(f),f.forEach(y),this.h()},h(){m(t,"class","svelte-1ahhu9d"),ce(t,"selected",e[39]===e[4].clusterBy)},m(u,f){fe(u,t,f),c(t,i),c(t,h),o||(p=se(t,"click",_),o=!0)},p(u,f){e=u,f[0]&128&&r!==(r=e[39]+"")&&re(i,r),f[0]&144&&ce(t,"selected",e[39]===e[4].clusterBy)},d(u){u&&y(t),o=!1,p()}}}function Ue(e){let t,r=e[33]+"",i,h,o,p;function _(){return e[21](e[33])}return{c(){t=C("span"),i=U(r),h=N(),this.h()},l(u){t=E(u,"SPAN",{style:!0,class:!0});var f=S(t);i=R(f,r),h=A(f),f.forEach(y),this.h()},h(){var u;he(t,"font-size",e[14](e[36])+"px"),m(t,"class","svelte-1ahhu9d"),ce(t,"selected",((u=e[4].filters[e[4].clusterBy])==null?void 0:u[0])===e[33])},m(u,f){fe(u,t,f),c(t,i),c(t,h),o||(p=se(t,"click",_),o=!0)},p(u,f){var H;e=u,f[0]&2&&r!==(r=e[33]+"")&&re(i,r),f[0]&2&&he(t,"font-size",e[14](e[36])+"px"),f[0]&18&&ce(t,"selected",((H=e[4].filters[e[4].clusterBy])==null?void 0:H[0])===e[33])},d(u){u&&y(t),o=!1,p()}}}function Re(e){let t,r=e[32]+"",i,h,o;function p(){return e[22](e[32])}return{c(){t=C("span"),i=U(r),this.h()},l(_){t=E(_,"SPAN",{style:!0,class:!0});var u=S(t);i=R(u,r),u.forEach(y),this.h()},h(){he(t,"font-size",e[13](e[33])+"px"),m(t,"class","svelte-1ahhu9d"),ce(t,"highlighted",e[3].includes(e[32]))},m(_,u){fe(_,t,u),c(t,i),h||(o=se(t,"click",p),h=!0)},p(_,u){e=_,u[0]&4&&r!==(r=e[32]+"")&&re(i,r),u[0]&4&&he(t,"font-size",e[13](e[33])+"px"),u[0]&12&&ce(t,"highlighted",e[3].includes(e[32]))},d(_){_&&y(t),h=!1,o()}}}function He(e){let t,r,i=e[2].length+"",h;return{c(){t=C("p"),r=U("50 out of "),h=U(i),this.h()},l(o){t=E(o,"P",{style:!0});var p=S(t);r=R(p,"50 out of "),h=R(p,i),p.forEach(y),this.h()},h(){he(t,"border-top","1px solid"),he(t,"padding-top","10px")},m(o,p){fe(o,t,p),c(t,r),c(t,h)},p(o,p){p[0]&4&&i!==(i=o[2].length+"")&&re(h,i)},d(o){o&&y(t)}}}function xe(e){let t,r,i,h,o,p,_,u,f,H="Reset",Z,I,$="Copy Config",x,z,V,v,ne="Cluster By:",J,D,de,M,T,ie,ee=e[4].clusterBy+"",ae,pe,_e,K,ge,Q,s,a,g,d,L,j,te,G=Y(e[0]),b=[];for(let n=0;n<G.length;n+=1)b[n]=Me(Te(e,G,n));let W=Y(e[7]),B=[];for(let n=0;n<W.length;n+=1)B[n]=Qe(Ae(e,W,n));let X=Y(e[1]),F=[];for(let n=0;n<X.length;n+=1)F[n]=Ue(Ne(e,X,n));let oe=Y(e[2].slice(0,50).sort(Je)),O=[];for(let n=0;n<oe.length;n+=1)O[n]=Re(Le(e,oe,n));let P=e[2].length>50&&He(e);return{c(){t=C("header"),r=C("div"),i=C("div"),h=U(e[6]),o=N(),p=C("div"),_=C("div");for(let n=0;n<b.length;n+=1)b[n].c();u=N(),f=C("button"),f.textContent=H,Z=N(),I=C("button"),I.textContent=$,x=N(),z=C("div"),V=C("div"),v=C("label"),v.textContent=ne,J=N(),D=C("div");for(let n=0;n<B.length;n+=1)B[n].c();de=N(),M=C("div"),T=C("label"),ie=U("Filter "),ae=U(ee),pe=U(":"),_e=N(),K=C("div");for(let n=0;n<F.length;n+=1)F[n].c();ge=N(),Q=C("div"),s=C("input"),g=N(),d=C("div");for(let n=0;n<O.length;n+=1)O[n].c();L=N(),P&&P.c(),this.h()},l(n){t=E(n,"HEADER",{class:!0});var k=S(t);r=E(k,"DIV",{class:!0});var l=S(r);i=E(l,"DIV",{class:!0});var w=S(i);h=R(w,e[6]),w.forEach(y),o=A(l),p=E(l,"DIV",{class:!0});var me=S(p);_=E(me,"DIV",{class:!0});var ye=S(_);for(let q=0;q<b.length;q+=1)b[q].l(ye);u=A(ye),f=E(ye,"BUTTON",{class:!0,"data-svelte-h":!0}),Oe(f)!=="svelte-qy1k7w"&&(f.textContent=H),ye.forEach(y),Z=A(me),I=E(me,"BUTTON",{class:!0,"data-svelte-h":!0}),Oe(I)!=="svelte-i2notl"&&(I.textContent=$),me.forEach(y),l.forEach(y),x=A(k),z=E(k,"DIV",{class:!0});var ue=S(z);V=E(ue,"DIV",{class:!0});var be=S(V);v=E(be,"LABEL",{class:!0,"data-svelte-h":!0}),Oe(v)!=="svelte-1ekr4iz"&&(v.textContent=ne),J=A(be),D=E(be,"DIV",{class:!0});var je=S(D);for(let q=0;q<B.length;q+=1)B[q].l(je);je.forEach(y),be.forEach(y),de=A(ue),M=E(ue,"DIV",{class:!0});var Ce=S(M);T=E(Ce,"LABEL",{class:!0});var Ee=S(T);ie=R(Ee,"Filter "),ae=R(Ee,ee),pe=R(Ee,":"),Ee.forEach(y),_e=A(Ce),K=E(Ce,"DIV",{class:!0});var qe=S(K);for(let q=0;q<F.length;q+=1)F[q].l(qe);qe.forEach(y),Ce.forEach(y),ge=A(ue),Q=E(ue,"DIV",{class:!0});var Be=S(Q);s=E(Be,"INPUT",{type:!0,placeholder:!0,class:!0}),g=A(Be),d=E(Be,"DIV",{class:!0});var ke=S(d);for(let q=0;q<O.length;q+=1)O[q].l(ke);L=A(ke),P&&P.l(ke),ke.forEach(y),Be.forEach(y),ue.forEach(y),k.forEach(y),this.h()},h(){m(i,"class","methodology svelte-1ahhu9d"),m(f,"class","reset svelte-1ahhu9d"),m(_,"class","active-filters svelte-1ahhu9d"),m(I,"class","copy-config svelte-1ahhu9d"),m(p,"class","header-buttons svelte-1ahhu9d"),m(r,"class","header-info svelte-1ahhu9d"),m(v,"class","svelte-1ahhu9d"),m(D,"class","options svelte-1ahhu9d"),m(V,"class","category svelte-1ahhu9d"),m(T,"class","svelte-1ahhu9d"),m(K,"class","options tiny svelte-1ahhu9d"),m(M,"class","filtered-cluster-values svelte-1ahhu9d"),m(s,"type","text"),m(s,"placeholder",a="Filter "+e[4].moveBy+"..."),s.value=e[5],m(s,"class","svelte-1ahhu9d"),m(d,"class","options tiny svelte-1ahhu9d"),m(Q,"class","filtered-entities svelte-1ahhu9d"),m(z,"class","categories svelte-1ahhu9d"),m(t,"class","svelte-1ahhu9d")},m(n,k){fe(n,t,k),c(t,r),c(r,i),c(i,h),c(r,o),c(r,p),c(p,_);for(let l=0;l<b.length;l+=1)b[l]&&b[l].m(_,null);c(_,u),c(_,f),c(p,Z),c(p,I),c(t,x),c(t,z),c(z,V),c(V,v),c(V,J),c(V,D);for(let l=0;l<B.length;l+=1)B[l]&&B[l].m(D,null);c(z,de),c(z,M),c(M,T),c(T,ie),c(T,ae),c(T,pe),c(M,_e),c(M,K);for(let l=0;l<F.length;l+=1)F[l]&&F[l].m(K,null);c(z,ge),c(z,Q),c(Q,s),c(Q,g),c(Q,d);for(let l=0;l<O.length;l+=1)O[l]&&O[l].m(d,null);c(d,L),P&&P.m(d,null),j||(te=[se(f,"click",e[11]),se(_,"click",e[11]),se(I,"click",e[12]),se(s,"input",e[8])],j=!0)},p(n,k){if(k[0]&64&&re(h,n[6]),k[0]&1){G=Y(n[0]);let l;for(l=0;l<G.length;l+=1){const w=Te(n,G,l);b[l]?b[l].p(w,k):(b[l]=Me(w),b[l].c(),b[l].m(_,u))}for(;l<b.length;l+=1)b[l].d(1);b.length=G.length}if(k[0]&656){W=Y(n[7]);let l;for(l=0;l<W.length;l+=1){const w=Ae(n,W,l);B[l]?B[l].p(w,k):(B[l]=Qe(w),B[l].c(),B[l].m(D,null))}for(;l<B.length;l+=1)B[l].d(1);B.length=W.length}if(k[0]&16&&ee!==(ee=n[4].clusterBy+"")&&re(ae,ee),k[0]&17426){X=Y(n[1]);let l;for(l=0;l<X.length;l+=1){const w=Ne(n,X,l);F[l]?F[l].p(w,k):(F[l]=Ue(w),F[l].c(),F[l].m(K,null))}for(;l<F.length;l+=1)F[l].d(1);F.length=X.length}if(k[0]&16&&a!==(a="Filter "+n[4].moveBy+"...")&&m(s,"placeholder",a),k[0]&32&&s.value!==n[5]&&(s.value=n[5]),k[0]&8204){oe=Y(n[2].slice(0,50).sort(Je));let l;for(l=0;l<oe.length;l+=1){const w=Le(n,oe,l);O[l]?O[l].p(w,k):(O[l]=Re(w),O[l].c(),O[l].m(d,L))}for(;l<O.length;l+=1)O[l].d(1);O.length=oe.length}n[2].length>50?P?P.p(n,k):(P=He(n),P.c(),P.m(d,null)):P&&(P.d(1),P=null)},i:we,o:we,d(n){n&&y(t),Ve(b,n),Ve(B,n),Ve(F,n),Ve(O,n),P&&P.d(),j=!1,Ge(te)}}}const Pe=12,et=30,Ie=12,tt=30;function Fe(e,t){const r={city:"cities",sport:"sports",height:"heights",noc:"NOCs",team:"teams",weight:"weights",year:"years",age:"ages",event:"events",medal:"medals",name:"names",is:"are"};return e===1?t:r[t]||`${t}s`}function lt(e){return e.clusterBy?e.clusterBy:"all clusters"}const Je=([e],[t])=>e.localeCompare(t);function st(e,t,r){let i,h,o,p,_,u,f,H,Z,I,$,x,z,V,v,ne,J;Se(e,ve,s=>r(3,V=s)),Se(e,le,s=>r(4,v=s)),Se(e,De,s=>r(28,ne=s)),Se(e,Ze,s=>r(19,J=s));let D=v.queryValue||"";le.update(s=>({...s,filters:s.filters||{}}));function de(s){r(5,D=s.target.value),le.update(a=>({...a,queryValue:D}))}function M(s){var L;const a=v.filters||{},g=s.dataPoints;for(const[j,te]of Object.entries(a)){if(!te||te.length===0)continue;if(!g.some(b=>{var B;const W=(B=b[j])==null?void 0:B.toString().toLowerCase();return te.some(X=>W===X.toLowerCase())}))return!1}const d=((L=v.queryValue)==null?void 0:L.toLowerCase())||"";if(d.length>=3){const j=v.queryCategory||"name";if(!g.some(G=>{var b;return(b=G[j])==null?void 0:b.toString().toLowerCase().includes(d)}))return!1}return V.length>0?V.includes(s.moveBy):!0}function T(s,a){s==="clusterBy"?le.update(g=>({...g,clusterBy:a})):s==="moveBy"&&le.update(g=>({...g,moveBy:a}))}function ie(s){const a=v.clusterBy;le.update(g=>{var j;const d={...g.filters};return((j=d[a])==null?void 0:j[0])===s?delete d[a]:d[a]=[s],{...g,filters:d}})}function ee(){le.update(s=>({...s,queryValue:"",filters:{}})),r(5,D=""),ve.set([])}function ae(){const s={title:"",description:"",methodology:"",media:!0,config:{clusterBy:v.clusterBy,moveBy:v.moveBy,filters:v.filters,queryValue:D,queryCategory:v.queryCategory||"name",speed:v.speed||3,stroke:v.stroke||1,loops:v.loopsToComplete||1,highlightedEntities:We(ve)}},a=JSON.stringify(s,null,2);navigator.clipboard.writeText(a).then(()=>{alert("Config copied to clipboard!")}).catch(g=>{console.error("Could not copy text: ",g)})}function pe(s){return f===H?Pe:Pe+(s-f)*(et-Pe)/(H-f)}function _e(s){return $===x?Ie:Ie+(s-$)*(tt-Ie)/(x-$)}const K=s=>T("clusterBy",s),ge=s=>ie(s),Q=s=>{ve.update(a=>(a.includes(s)||a.push(s),a))};return e.$$.update=()=>{if(e.$$.dirty[0]&524304&&(()=>{const s=new Set;return Object.values(J).forEach(a=>{a.dataPoints.forEach(g=>{const d=g[v.clusterBy];d&&s.add(d)})}),Array.from(s)})(),e.$$.dirty[0]&524288&&r(17,h=Object.entries(J).filter(([s,a])=>M(a)).reduce((s,[a,g])=>(s[a]=g,s),{})),e.$$.dirty[0]&131072&&r(2,p=Object.entries(h||{}).map(([s,a])=>[s,a.dataPoints.length])),e.$$.dirty[0]&4&&r(15,_=p.map(([s,a])=>s)),e.$$.dirty[0]&557056&&Object.entries(J).length!=_.length&&ze(ve,V=_,V),e.$$.dirty[0]&25){r(0,o=[]);const s=v.filters||{};for(const[a,g]of Object.entries(s))for(const d of g)o.push({label:d,type:a});V.length===1&&o.push({label:V[0],type:"name"})}e.$$.dirty[0]&4&&r(18,u=p.map(([s,a])=>a)),e.$$.dirty[0]&262144&&(f=u.length>0?Math.min(...u):0),e.$$.dirty[0]&262144&&(H=u.length>0?Math.max(...u):1),e.$$.dirty[0]&131088&&r(1,Z=(()=>{const s={};return Object.values(h).forEach(a=>{a.dataPoints.forEach(g=>{const d=g[v.clusterBy];d&&(s[d]=(s[d]||0)+1)})}),ze(De,ne=Object.entries(s),ne),Object.entries(s)})()),e.$$.dirty[0]&2&&r(16,I=Z.map(([s,a])=>a)),e.$$.dirty[0]&65536&&($=I.length>0?Math.min(...I):0),e.$$.dirty[0]&65536&&(x=I.length>0?Math.max(...I):1),e.$$.dirty[0]&32793&&r(6,z=(()=>{const s=lt(v),a=V.length>0?V.length:_.length;let g="";if(o.length>0){const d=o.find(L=>L.type==="name");if(d&&o.length===1)g=`${d.label} is shown moving across ${s}`;else{const L=o.map(j=>j.type==="name"?j.label:`${j.type}:${j.label}`).join(", ");g=`${a} ${Fe(a,"participant")} [${L}]  ${Fe(a,"is")} seen moving across ${s}`}}else g=`${a}  ${Fe(a,"participant")}  ${Fe(a,"is")} grouped by ${s}`;return g})())},r(7,i=$e),r(0,o=[]),[o,Z,p,V,v,D,z,i,de,T,ie,ee,ae,pe,_e,_,I,h,u,J,K,ge,Q]}class ut extends Xe{constructor(t){super(),Ye(this,t,st,xe,Ke,{},null,[-1,-1])}}export{ut as C};
