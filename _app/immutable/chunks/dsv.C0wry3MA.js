import{s as dt,e as Ct,c as xt,b as vt,f as st,m as Y,i as Et,W as St,n as nt,X as bt,q as _t,k as G,I as f}from"./scheduler.evRM0l9T.js";import{S as mt,i as pt,b as Pt,d as Rt,m as Tt,a as kt,t as It,e as Mt}from"./index.aiZKxZDj.js";import{_ as wt}from"./preload-helper.C1FmrZbK.js";import{b as Lt}from"./paths.Bx2zXzeS.js";import{w as jt}from"./index.Czq-ZNKO.js";import{f as it,c as Q,r as X,p as K,g as at,w as F,a as U,d as ct,e as W,b as q,i as lt,h as Bt,s as Ot,j as At,k as ut}from"./stores.0UUoU4mb.js";import{c as D}from"./constants.B7V-oudb.js";function Nt(e){let n,s,i;return{c(){n=Ct("div"),this.h()},l(l){n=xt(l,"DIV",{style:!0,class:!0}),vt(n).forEach(st),this.h()},h(){Y(n,"style",e[0]),Y(n,"class","m-0")},m(l,S){Et(l,n,S),s||(i=St(e[1].call(null,n)),s=!0)},p(l,[S]){S&1&&Y(n,"style",l[0])},i:nt,o:nt,d(l){l&&st(n),s=!1,i()}}}function Ft(e,n){return n.forEach(([s,i])=>e[s]=i),e}function Ut(e,n,s){let{target:i=void 0}=n,{sketch:l=void 0}=n,{parentDivStyle:S="display: block;"}=n,{debug:k=!1}=n,A;const O=bt(),I={ref(){O("ref",i)},instance(){O("instance",A)}};function M(o){return s(2,i=o),{destroy(){s(2,i=void 0)}}}return _t(async()=>{const o=await wt(()=>import("./p5.min.D8xqWc_1.js").then(a=>a.p),[],import.meta.url),{default:C}=o,r=Object.entries(o).filter(([a,c])=>c instanceof Function&&a[0]!=="_"&&a!=="default");k&&console.log("available p5 native classes",r),A=new C(a=>(a=Ft(a,r),k&&console.log("p5 instance",a),window._p5Instance=a,l(a)),i),I.ref(),I.instance()}),e.$$set=o=>{"target"in o&&s(2,i=o.target),"sketch"in o&&s(3,l=o.sketch),"parentDivStyle"in o&&s(0,S=o.parentDivStyle),"debug"in o&&s(4,k=o.debug)},[S,M,i,l,k]}class Dt extends mt{constructor(n){super(),pt(this,n,Ut,Nt,dt,{target:2,sketch:3,parentDivStyle:0,debug:4})}}const zt=jt({entityCompletedLoop:!1,completedEntity:null});function Ht(e){zt.set({entityCompletedLoop:!0,completedEntity:e})}function Vt(e){let n,s;return n=new Dt({props:{sketch:e[0]}}),{c(){Pt(n.$$.fragment)},l(i){Rt(n.$$.fragment,i)},m(i,l){Tt(n,i,l),s=!0},p:nt,i(i){s||(kt(n.$$.fragment,i),s=!0)},o(i){It(n.$$.fragment,i),s=!1},d(i){Mt(n,i)}}}function ft(e,n){const s=e.x-n.x,i=e.y-n.y;return s*s+i*i}function Wt(e,n,s){let i,l,S;G(e,it,t=>s(1,i=t)),G(e,Q,t=>s(2,l=t)),G(e,X,t=>s(3,S=t));let k;const A=t=>{t.preload=()=>{k=t.loadFont(Lt+"/font/CircularStd-Book.otf",()=>{at.set(!0)})},t.setup=()=>{t.createCanvas(f(F),f(U)),t.colorMode(t.HSL),t.background(0),t.frameRate(60),f(ct).length>0&&(O(),I())},t.draw=()=>{t.background(0,.1);const r=f(W),a=f(q),c=f(lt),u=f(it),h=f(Q),p=h.highlightedEntities||f(Bt),g=h.stroke||f(Ot),d=f(at),y=h.speed||f(At),x=f(ut),m=f(X);f(K)&&(O(),I(),K.set(!1)),o(t,r,x,c,p,h,g,y);const _={highlighted:[],normal:[]};Object.values(r).forEach(v=>{if(v.isStationary)return;p.length===0||p.includes(v.moveBy)?_.highlighted.push(v):_.normal.push(v)}),_.highlighted.length>0&&_.highlighted.forEach(v=>{M(t,v,!0,c,u,y,g,h,p)}),_.normal.length>0&&_.normal.forEach(v=>{M(t,v,!1,c,u,y,g,h,p)}),d&&C(t,a,c,h,m)}};function O(){const t=new Map,r={},a=f(Q);f(ct).forEach(c=>{const u=c[a.moveBy],h=c[a.clusterBy];r[u]||(r[u]={categories:[],moveBy:u,dataPoints:[],currentCategoryIndex:0,position:{x:0,y:0},t:0,isStationary:!0,trail:[],loopsCompleted:0,loopsToComplete:a.loops||1}),r[u].dataPoints.push(c),r[u].categories.push(h),h!==r[u].categories[0]&&(r[u].isStationary=!1),t.has(h)||t.set(h,[]),t.get(h).push(c)}),W.set(r),q.set(Array.from(t.entries()).sort(([c],[u])=>!isNaN(c)&&!isNaN(u)?+c-+u:c.localeCompare(u)))}function I(){const r=(f(F)-100)/2,a=(f(U)-50*2)/2,c={},u=f(q).length,h=Math.PI;f(q).forEach(([d],y)=>{const x=h+y/u*Math.PI*2,m=f(X)?{x:50+Math.random()*(f(F)-2*50),y:50+Math.random()*(f(U)-2*50)}:{x:f(F)/2+r*Math.cos(x),y:f(U)/2+a*Math.sin(x)};c[d]={x:m.x,y:m.y}}),lt.set(c);const p=f(W),g={};Object.values(p).forEach(d=>{const y=d.categories[0];c[y]&&(d.position={...c[y]},d.t=0,d.currentCategoryIndex=0,d.isStationary&&(g[y]||(g[y]=0),g[y]++))}),W.set(p),ut.set(g)}function M(t,r,a,c,u,h,p,g,d){var b;if(r.isStationary)return;const y=d.length===0||a,x=y&&D[g.clusterBy]?(b=D[g.clusterBy])==null?void 0:b.start:[0,0,20];t.stroke(...x),t.strokeWeight(y?p:1),t.noFill(),t.strokeJoin(t.ROUND);const m=r.categories,_=r.currentCategoryIndex,v=r.position;let P=r.t||0;const J=1,ot=4;if(r.trail||(r.trail=[]),m.length>0){const H=m[_%m.length],V=m[(_+1)%m.length],w=c[H],L=c[V];if(w&&L){let R={x:0,y:0};if(u){const B={x:w.x-25,y:w.y-25},rt={x:L.x+50/2,y:L.y+50/2};R.x=t.bezierPoint(w.x,B.x-50,rt.x-50,L.x,P),R.y=t.bezierPoint(w.y,B.y+50,rt.y+50,L.y,P)}else R.x=t.lerp(w.x,L.x,P),R.y=t.lerp(w.y,L.y,P);const T=r.trail,N=T[T.length-1];(!N||ft(N,R)>=J*J)&&(T.length>=ot&&T.shift(),T.push({x:R.x,y:R.y}));const Z=.004*h;P+=Z,P>1&&(P=0,r.currentCategoryIndex=(_+1)%m.length,r.currentCategoryIndex===0&&(r.loopsCompleted+=1,r.loopsCompleted>=r.loopsToComplete&&a&&Ht(r.moveBy))),r.t=P,v.x=R.x,v.y=R.y,t.beginShape();for(let j=0;j<T.length;j++){const B=T[j];t.vertex(B.x,B.y)}t.endShape()}}}function o(t,r,a,c,u,h,p,g){const d=a,y=.004*g;o.trails||(o.trails={});const x=o.trails;Object.keys(d).forEach(m=>{var P;const _=d[m],v=c[m];if(v){x[m]||(x[m]={t:Math.random(),trail:[]});const b=x[m];b.t+=y,b.t>1&&(b.t=0);const H=b.t*t.TWO_PI,V=2+Math.sqrt(_),w=v.x+V*t.cos(H),L=v.y+V*t.sin(H),R={x:w,y:L},T=b.trail[b.trail.length-1];(!T||ft(T,R)>=2*2)&&(b.trail.length>=4&&b.trail.shift(),b.trail.push(R));const N=u.length===0||u.some(j=>{const B=r[j];return B&&B.categories.includes(m)&&B.isStationary}),Z=N&&D[h.clusterBy]?(P=D[h.clusterBy])==null?void 0:P.start:[0,0,40];t.noFill(),t.stroke(...Z),t.strokeWeight(N?p:1),t.strokeJoin(t.ROUND),t.beginShape(),b.trail.forEach(j=>t.vertex(j.x,j.y)),t.endShape()}})}function C(t,r,a,c,u){var h;t.fill(...((h=D[c.clusterBy])==null?void 0:h.start)||[0,0,40]),t.noStroke(),t.textFont(k),r.forEach(([p])=>{const g=a[p];if(g){if(t.push(),u)t.translate(g.x,g.y);else{let d=Math.atan2(g.y-f(U)/2,g.x-f(F)/2);d>Math.PI/2||d<-Math.PI/2?(d+=Math.PI,t.textAlign(t.RIGHT,t.BOTTOM)):t.textAlign(t.LEFT,t.TOP),t.translate(g.x,g.y),t.rotate(d)}t.textSize(14),t.text(p,0,0),t.pop()}})}return e.$$.update=()=>{e.$$.dirty&14&&(l.clusterBy||l.moveBy||S||l.speed||i)&&(O(),I(),K.set(!1))},[A,i,l,S]}class ae extends mt{constructor(n){super(),pt(this,n,Wt,Vt,dt,{})}}var ht={},$={},tt=34,z=10,et=13;function yt(e){return new Function("d","return {"+e.map(function(n,s){return JSON.stringify(n)+": d["+s+'] || ""'}).join(",")+"}")}function qt(e,n){var s=yt(e);return function(i,l){return n(s(i),l,e)}}function gt(e){var n=Object.create(null),s=[];return e.forEach(function(i){for(var l in i)l in n||s.push(n[l]=l)}),s}function E(e,n){var s=e+"",i=s.length;return i<n?new Array(n-i+1).join(0)+s:s}function Jt(e){return e<0?"-"+E(-e,6):e>9999?"+"+E(e,6):E(e,4)}function Zt(e){var n=e.getUTCHours(),s=e.getUTCMinutes(),i=e.getUTCSeconds(),l=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":Jt(e.getUTCFullYear())+"-"+E(e.getUTCMonth()+1,2)+"-"+E(e.getUTCDate(),2)+(l?"T"+E(n,2)+":"+E(s,2)+":"+E(i,2)+"."+E(l,3)+"Z":i?"T"+E(n,2)+":"+E(s,2)+":"+E(i,2)+"Z":s||n?"T"+E(n,2)+":"+E(s,2)+"Z":"")}function Yt(e){var n=new RegExp('["'+e+`
\r]`),s=e.charCodeAt(0);function i(o,C){var t,r,a=l(o,function(c,u){if(t)return t(c,u-1);r=c,t=C?qt(c,C):yt(c)});return a.columns=r||[],a}function l(o,C){var t=[],r=o.length,a=0,c=0,u,h=r<=0,p=!1;o.charCodeAt(r-1)===z&&--r,o.charCodeAt(r-1)===et&&--r;function g(){if(h)return $;if(p)return p=!1,ht;var y,x=a,m;if(o.charCodeAt(x)===tt){for(;a++<r&&o.charCodeAt(a)!==tt||o.charCodeAt(++a)===tt;);return(y=a)>=r?h=!0:(m=o.charCodeAt(a++))===z?p=!0:m===et&&(p=!0,o.charCodeAt(a)===z&&++a),o.slice(x+1,y-1).replace(/""/g,'"')}for(;a<r;){if((m=o.charCodeAt(y=a++))===z)p=!0;else if(m===et)p=!0,o.charCodeAt(a)===z&&++a;else if(m!==s)continue;return o.slice(x,y)}return h=!0,o.slice(x,r)}for(;(u=g())!==$;){for(var d=[];u!==ht&&u!==$;)d.push(u),u=g();C&&(d=C(d,c++))==null||t.push(d)}return t}function S(o,C){return o.map(function(t){return C.map(function(r){return M(t[r])}).join(e)})}function k(o,C){return C==null&&(C=gt(o)),[C.map(M).join(e)].concat(S(o,C)).join(`
`)}function A(o,C){return C==null&&(C=gt(o)),S(o,C).join(`
`)}function O(o){return o.map(I).join(`
`)}function I(o){return o.map(M).join(e)}function M(o){return o==null?"":o instanceof Date?Zt(o):n.test(o+="")?'"'+o.replace(/"/g,'""')+'"':o}return{parse:i,parseRows:l,format:k,formatBody:A,formatRows:O,formatRow:I,formatValue:M}}var Gt=Yt("	"),Qt=Gt.parse;function Xt(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.text()}function Kt(e,n){return fetch(e,n).then(Xt)}function $t(e){return function(n,s,i){return arguments.length===2&&typeof s=="function"&&(i=s,s=void 0),Kt(n,s).then(function(l){return e(l,i)})}}var ce=$t(Qt);export{ae as S,ce as t};
