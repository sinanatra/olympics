import{s as dt,e as Et,c as St,b as bt,f as st,m as X,i as wt,Z as Tt,n as ot,_ as Pt,q as Mt,k as G,F as u}from"./scheduler.aNKYHOcM.js";import{S as gt,i as mt,b as It,d as Lt,m as kt,a as jt,t as Rt,e as Ot}from"./index.DU0ByNF3.js";import{_ as Bt}from"./preload-helper.C1FmrZbK.js";import{b as At}from"./paths.7T04WfbS.js";import{w as Ft}from"./index.C2MJvcFY.js";import{j as it,a as Q,r as K,p as $,l as at,w as F,i as N,g as ct,e as V,h as Nt,b as q,m as Y,s as _t,k as Ut,n as lt,c as z}from"./constants.DwiyTaa0.js";function ce(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function zt(e){let n,s,a;return{c(){n=Et("div"),this.h()},l(l){n=St(l,"DIV",{style:!0,class:!0}),bt(n).forEach(st),this.h()},h(){X(n,"style",e[0]),X(n,"class","m-0")},m(l,E){wt(l,n,E),s||(a=Tt(e[1].call(null,n)),s=!0)},p(l,[E]){E&1&&X(n,"style",l[0])},i:ot,o:ot,d(l){l&&st(n),s=!1,a()}}}function Dt(e,n){return n.forEach(([s,a])=>e[s]=a),e}function Ht(e,n,s){let{target:a=void 0}=n,{sketch:l=void 0}=n,{parentDivStyle:E="display: block;"}=n,{debug:j=!1}=n,_;const B=Pt(),I={ref(){B("ref",a)},instance(){B("instance",_)}};function R(o){return s(2,a=o),{destroy(){s(2,a=void 0)}}}return Mt(async()=>{const o=await Bt(()=>import("./p5.min.D8xqWc_1.js").then(i=>i.p),[],import.meta.url),{default:p}=o,r=Object.entries(o).filter(([i,f])=>f instanceof Function&&i[0]!=="_"&&i!=="default");j&&console.log("available p5 native classes",r),_=new p(i=>(i=Dt(i,r),j&&console.log("p5 instance",i),window._p5Instance=i,l(i)),a),I.ref(),I.instance()}),e.$$set=o=>{"target"in o&&s(2,a=o.target),"sketch"in o&&s(3,l=o.sketch),"parentDivStyle"in o&&s(0,E=o.parentDivStyle),"debug"in o&&s(4,j=o.debug)},[E,R,a,l,j]}class Wt extends gt{constructor(n){super(),mt(this,n,Ht,zt,dt,{target:2,sketch:3,parentDivStyle:0,debug:4})}}const pt=Ft({entityCompletedLoop:!1,completedEntity:null});function Vt(e){pt.set({entityCompletedLoop:!0,completedEntity:e})}function le(){pt.set({entityCompletedLoop:!1,completedEntity:null})}function qt(e){let n,s;return n=new Wt({props:{sketch:e[0]}}),{c(){It(n.$$.fragment)},l(a){Lt(n.$$.fragment,a)},m(a,l){kt(n,a,l),s=!0},p:ot,i(a){s||(jt(n.$$.fragment,a),s=!0)},o(a){Rt(n.$$.fragment,a),s=!1},d(a){Ot(n,a)}}}function ut(e,n){const s=e.x-n.x,a=e.y-n.y;return s*s+a*a}function Yt(e,n,s){let a,l,E;G(e,it,t=>s(1,a=t)),G(e,Q,t=>s(2,l=t)),G(e,K,t=>s(3,E=t));let j;const _=t=>{t.preload=()=>{j=t.loadFont(At+"/font/CircularStd-Book.otf",()=>{at.set(!0)})},t.setup=()=>{t.createCanvas(u(F),u(N)),t.colorMode(t.HSL),t.background(0),t.frameRate(60),u(ct).length>0&&(B(),I())},t.draw=()=>{t.background(0,.1);const r=u(V),i=u(Nt),f=u(q),c=u(Y),g=u(it),h=u(Q),d=h.stroke||u(_t),y=u(at),C=h.speed||u(Ut),w=u(lt),m=u(K);u($)&&(B(),I(),$.set(!1)),o(t,r,w,c,i,h,d,C);const T={highlighted:[],normal:[]};Object.values(r).forEach(v=>{if(v.isStationary)return;i.length===0||i.includes(v.moveBy)?T.highlighted.push(v):T.normal.push(v)}),T.highlighted.length>0&&T.highlighted.forEach(v=>{R(t,v,!0,c,g,C,d,h,i)}),T.normal.length>0&&T.normal.forEach(v=>{R(t,v,!1,c,g,C,d,h,i)}),y&&p(t,f,c,h,m)},t.windowResized=()=>{F.set(window.innerWidth),N.set(window.innerHeight-200),t.resizeCanvas(u(F),u(N)),t.background(0),I()}};function B(){const t=new Map,r={},i=u(Q);u(ct).forEach(f=>{const c=f[i.moveBy],g=f[i.clusterBy];r[c]||(r[c]={categories:[],moveBy:c,dataPoints:[],currentCategoryIndex:0,position:{x:0,y:0},t:0,isStationary:!0,trail:[],loopsCompleted:0,loopsToComplete:i.loops||1}),r[c].dataPoints.push(f),r[c].categories.push(g),g!==r[c].categories[0]&&(r[c].isStationary=!1),t.has(g)||t.set(g,[]),t.get(g).push(f)}),V.set(r),q.set(Array.from(t.entries()).sort(([f],[c])=>!isNaN(f)&&!isNaN(c)?+f-+c:f.localeCompare(c)))}function I(){const r=(u(F)-100)/2,i=(u(N)-50*2)/2,f={};u(q).forEach(([h],d)=>{const y=d/u(q).length*Math.PI*2,C=u(K)?{x:50+Math.random()*(u(F)-2*50),y:50+Math.random()*(u(N)-2*50)}:{x:u(F)/2+r*Math.cos(y),y:u(N)/2+i*Math.sin(y)};f[h]={x:C.x+(Math.random()-.5),y:C.y+(Math.random()-.5)}}),Y.set(f);const c=u(V),g={};Object.values(c).forEach(h=>{const d=h.categories[0];u(Y)[d]&&(h.position={...u(Y)[d]},h.t=0,h.currentCategoryIndex=0,h.isStationary&&(g[d]||(g[d]=0),g[d]++))}),V.set(c),lt.set(g)}function R(t,r,i,f,c,g,h,d,y){var b;if(r.isStationary)return;const C=y.length===0||i,w=C&&z[d.clusterBy]?(b=z[d.clusterBy])==null?void 0:b.start:[0,0,20];t.stroke(...w),t.strokeWeight(C?h:1),t.noFill(),t.strokeJoin(t.ROUND);const m=r.categories,T=r.currentCategoryIndex,v=r.position;let S=r.t||0;const Z=1,rt=4;if(r.trail||(r.trail=[]),m.length>0){const H=m[T%m.length],W=m[(T+1)%m.length],P=f[H],L=f[W];if(P&&L){let M={x:0,y:0};if(t.TWO_PI*S,c){const A=P.x+(L.x-P.x)/2-50,Ct=P.y+50,vt=L.x+50,xt=P.y+(L.y-P.y)/2-50;M.x=t.bezierPoint(P.x,A,vt,L.x,S),M.y=t.bezierPoint(P.y,Ct,xt,L.y,S)}else M.x=t.lerp(P.x,L.x,S),M.y=t.lerp(P.y,L.y,S);const k=r.trail,U=k[k.length-1];(!U||ut(U,M)>=Z*Z)&&(k.length>=rt&&k.shift(),k.push({x:M.x,y:M.y}));const J=.004*g;S+=J,S>1&&(S=0,r.currentCategoryIndex=(T+1)%m.length,r.currentCategoryIndex===0&&(r.loopsCompleted+=1,r.loopsCompleted>=r.loopsToComplete&&i&&Vt(r.moveBy))),r.t=S,v.x=M.x,v.y=M.y,t.beginShape();for(let O=0;O<k.length;O++){const A=k[O];t.vertex(A.x,A.y)}t.endShape()}}}function o(t,r,i,f,c,g,h,d){const y=i,C=.004*d;o.trails||(o.trails={});const w=o.trails;Object.keys(y).forEach(m=>{var S;const T=y[m],v=f[m];if(v){w[m]||(w[m]={t:Math.random(),trail:[]});const b=w[m];b.t+=C,b.t>1&&(b.t=0);const H=b.t*t.TWO_PI,W=2+Math.sqrt(T),P=v.x+W*t.cos(H),L=v.y+W*t.sin(H),M={x:P,y:L},k=b.trail[b.trail.length-1];(!k||ut(k,M)>=2*2)&&(b.trail.length>=4&&b.trail.shift(),b.trail.push(M));const U=c.length===0||c.some(O=>{const A=r[O];return A&&A.categories.includes(m)&&A.isStationary}),J=U&&z[g.clusterBy]?(S=z[g.clusterBy])==null?void 0:S.start:[0,0,40];t.noFill(),t.stroke(...J),t.strokeWeight(U?h:1),t.strokeJoin(t.ROUND),t.beginShape(),b.trail.forEach(O=>t.vertex(O.x,O.y)),t.endShape()}})}function p(t,r,i,f,c){var g;t.fill(...((g=z[f.clusterBy])==null?void 0:g.start)||[0,0,40]),t.noStroke(),t.textFont(j),r.forEach(([h])=>{const d=i[h];if(d){if(t.push(),c)t.translate(d.x,d.y);else{let y=Math.atan2(d.y-u(N)/2,d.x-u(F)/2);y>Math.PI/2||y<-Math.PI/2?(y+=Math.PI,t.textAlign(t.RIGHT,t.BOTTOM)):t.textAlign(t.LEFT,t.TOP),t.translate(d.x,d.y),t.rotate(y)}t.textSize(14),t.text(h,0,0),t.pop()}})}return e.$$.update=()=>{e.$$.dirty&14&&(l.clusterBy||l.moveBy||E||l.speed||a)&&(B(),I(),$.set(!1))},[_,a,l,E]}class ue extends gt{constructor(n){super(),mt(this,n,Yt,qt,dt,{})}}var ft={},tt={},et=34,D=10,nt=13;function yt(e){return new Function("d","return {"+e.map(function(n,s){return JSON.stringify(n)+": d["+s+'] || ""'}).join(",")+"}")}function Zt(e,n){var s=yt(e);return function(a,l){return n(s(a),l,e)}}function ht(e){var n=Object.create(null),s=[];return e.forEach(function(a){for(var l in a)l in n||s.push(n[l]=l)}),s}function x(e,n){var s=e+"",a=s.length;return a<n?new Array(n-a+1).join(0)+s:s}function Jt(e){return e<0?"-"+x(-e,6):e>9999?"+"+x(e,6):x(e,4)}function Xt(e){var n=e.getUTCHours(),s=e.getUTCMinutes(),a=e.getUTCSeconds(),l=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":Jt(e.getUTCFullYear())+"-"+x(e.getUTCMonth()+1,2)+"-"+x(e.getUTCDate(),2)+(l?"T"+x(n,2)+":"+x(s,2)+":"+x(a,2)+"."+x(l,3)+"Z":a?"T"+x(n,2)+":"+x(s,2)+":"+x(a,2)+"Z":s||n?"T"+x(n,2)+":"+x(s,2)+"Z":"")}function Gt(e){var n=new RegExp('["'+e+`
\r]`),s=e.charCodeAt(0);function a(o,p){var t,r,i=l(o,function(f,c){if(t)return t(f,c-1);r=f,t=p?Zt(f,p):yt(f)});return i.columns=r||[],i}function l(o,p){var t=[],r=o.length,i=0,f=0,c,g=r<=0,h=!1;o.charCodeAt(r-1)===D&&--r,o.charCodeAt(r-1)===nt&&--r;function d(){if(g)return tt;if(h)return h=!1,ft;var C,w=i,m;if(o.charCodeAt(w)===et){for(;i++<r&&o.charCodeAt(i)!==et||o.charCodeAt(++i)===et;);return(C=i)>=r?g=!0:(m=o.charCodeAt(i++))===D?h=!0:m===nt&&(h=!0,o.charCodeAt(i)===D&&++i),o.slice(w+1,C-1).replace(/""/g,'"')}for(;i<r;){if((m=o.charCodeAt(C=i++))===D)h=!0;else if(m===nt)h=!0,o.charCodeAt(i)===D&&++i;else if(m!==s)continue;return o.slice(w,C)}return g=!0,o.slice(w,r)}for(;(c=d())!==tt;){for(var y=[];c!==ft&&c!==tt;)y.push(c),c=d();p&&(y=p(y,f++))==null||t.push(y)}return t}function E(o,p){return o.map(function(t){return p.map(function(r){return R(t[r])}).join(e)})}function j(o,p){return p==null&&(p=ht(o)),[p.map(R).join(e)].concat(E(o,p)).join(`
`)}function _(o,p){return p==null&&(p=ht(o)),E(o,p).join(`
`)}function B(o){return o.map(I).join(`
`)}function I(o){return o.map(R).join(e)}function R(o){return o==null?"":o instanceof Date?Xt(o):n.test(o+="")?'"'+o.replace(/"/g,'""')+'"':o}return{parse:a,parseRows:l,format:j,formatBody:_,formatRows:B,formatRow:I,formatValue:R}}var Qt=Gt("	"),Kt=Qt.parse;function $t(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.text()}function te(e,n){return fetch(e,n).then($t)}function ee(e){return function(n,s,a){return arguments.length===2&&typeof s=="function"&&(a=s,s=void 0),te(n,s).then(function(l){return e(l,a)})}}var fe=ee(Kt);export{ue as S,ce as e,pt as l,Vt as m,le as r,fe as t};
