import{s as dt,e as Ct,c as xt,b as vt,f as st,m as Y,i as Et,Z as St,n as ot,_ as bt,q as wt,k as Q,G as u}from"./scheduler.BRYLh5pv.js";import{S as gt,i as mt,b as Tt,d as Pt,m as Mt,a as Lt,t as kt,e as It}from"./index.jG7-5-V5.js";import{_ as jt}from"./preload-helper.C1FmrZbK.js";import{b as Rt}from"./paths.CiUK02xC.js";import{w as Bt}from"./index.r_6kuJAQ.js";import{j as it,a as X,r as K,p as $,l as at,w as N,i as F,g as ct,e as W,h as Ot,b as q,m as Z,s as At,k as Nt,n as lt,c as z}from"./constants.2G2OMR97.js";function se(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function Ft(e){let n,s,a;return{c(){n=Ct("div"),this.h()},l(l){n=xt(l,"DIV",{style:!0,class:!0}),vt(n).forEach(st),this.h()},h(){Y(n,"style",e[0]),Y(n,"class","m-0")},m(l,E){Et(l,n,E),s||(a=St(e[1].call(null,n)),s=!0)},p(l,[E]){E&1&&Y(n,"style",l[0])},i:ot,o:ot,d(l){l&&st(n),s=!1,a()}}}function _t(e,n){return n.forEach(([s,a])=>e[s]=a),e}function Ut(e,n,s){let{target:a=void 0}=n,{sketch:l=void 0}=n,{parentDivStyle:E="display: block;"}=n,{debug:I=!1}=n,_;const A=bt(),L={ref(){A("ref",a)},instance(){A("instance",_)}};function j(o){return s(2,a=o),{destroy(){s(2,a=void 0)}}}return wt(async()=>{const o=await jt(()=>import("./p5.min.D8xqWc_1.js").then(i=>i.p),[],import.meta.url),{default:p}=o,r=Object.entries(o).filter(([i,f])=>f instanceof Function&&i[0]!=="_"&&i!=="default");I&&console.log("available p5 native classes",r),_=new p(i=>(i=_t(i,r),I&&console.log("p5 instance",i),window._p5Instance=i,l(i)),a),L.ref(),L.instance()}),e.$$set=o=>{"target"in o&&s(2,a=o.target),"sketch"in o&&s(3,l=o.sketch),"parentDivStyle"in o&&s(0,E=o.parentDivStyle),"debug"in o&&s(4,I=o.debug)},[E,j,a,l,I]}class zt extends gt{constructor(n){super(),mt(this,n,Ut,Ft,dt,{target:2,sketch:3,parentDivStyle:0,debug:4})}}const pt=Bt({entityCompletedLoop:!1,completedEntity:null});function Dt(e){pt.set({entityCompletedLoop:!0,completedEntity:e})}function ie(){pt.set({entityCompletedLoop:!1,completedEntity:null})}function Ht(e){let n,s;return n=new zt({props:{sketch:e[0]}}),{c(){Tt(n.$$.fragment)},l(a){Pt(n.$$.fragment,a)},m(a,l){Mt(n,a,l),s=!0},p:ot,i(a){s||(Lt(n.$$.fragment,a),s=!0)},o(a){kt(n.$$.fragment,a),s=!1},d(a){It(n,a)}}}function ut(e,n){const s=e.x-n.x,a=e.y-n.y;return s*s+a*a}function Vt(e,n,s){let a,l,E;Q(e,it,t=>s(1,a=t)),Q(e,X,t=>s(2,l=t)),Q(e,K,t=>s(3,E=t));let I;const _=t=>{t.preload=()=>{I=t.loadFont(Rt+"/font/CircularStd-Book.otf",()=>{at.set(!0)})},t.setup=()=>{t.createCanvas(u(N),u(F)),t.colorMode(t.HSL),t.background(0),t.frameRate(60),u(ct).length>0&&(A(),L())},t.draw=()=>{t.background(0,.1);const r=u(W),i=u(Ot),f=u(q),c=u(Z),g=u(it),h=u(X),d=h.stroke||u(At),y=u(at),C=h.speed||u(Nt),b=u(lt),m=u(K);u($)&&(A(),L(),$.set(!1)),o(t,r,b,c,i,h,d,C);const w={highlighted:[],normal:[]};Object.values(r).forEach(x=>{if(x.isStationary)return;i.length===0||i.includes(x.moveBy)?w.highlighted.push(x):w.normal.push(x)}),w.highlighted.length>0&&w.highlighted.forEach(x=>{j(t,x,!0,c,g,C,d,h,i)}),w.normal.length>0&&w.normal.forEach(x=>{j(t,x,!1,c,g,C,d,h,i)}),y&&p(t,f,c,h,m)},t.windowResized=()=>{N.set(window.innerWidth),F.set(window.innerHeight-200),t.resizeCanvas(u(N),u(F)),t.background(0),L()}};function A(){const t=new Map,r={},i=u(X);u(ct).forEach(f=>{const c=f[i.moveBy],g=f[i.clusterBy];r[c]||(r[c]={categories:[],moveBy:c,dataPoints:[],currentCategoryIndex:0,position:{x:0,y:0},t:0,isStationary:!0,trail:[],loopsCompleted:0,loopsToComplete:i.loops||1}),r[c].dataPoints.push(f),r[c].categories.push(g),g!==r[c].categories[0]&&(r[c].isStationary=!1),t.has(g)||t.set(g,[]),t.get(g).push(f)}),W.set(r),q.set(Array.from(t.entries()).sort(([f],[c])=>!isNaN(f)&&!isNaN(c)?+f-+c:f.localeCompare(c)))}function L(){const r=(u(N)-100)/2,i=(u(F)-50*2)/2,f={};u(q).forEach(([h],d)=>{const y=d/u(q).length*Math.PI*2,C=u(K)?{x:50+Math.random()*(u(N)-2*50),y:50+Math.random()*(u(F)-2*50)}:{x:u(N)/2+r*Math.cos(y),y:u(F)/2+i*Math.sin(y)};f[h]={x:C.x+(Math.random()-.5),y:C.y+(Math.random()-.5)}}),Z.set(f);const c=u(W),g={};Object.values(c).forEach(h=>{const d=h.categories[0];u(Z)[d]&&(h.position={...u(Z)[d]},h.t=0,h.currentCategoryIndex=0,h.isStationary&&(g[d]||(g[d]=0),g[d]++))}),W.set(c),lt.set(g)}function j(t,r,i,f,c,g,h,d,y){var S;if(r.isStationary)return;const C=y.length===0||i,b=C&&z[d.clusterBy]?(S=z[d.clusterBy])==null?void 0:S.start:[0,0,20];t.stroke(...b),t.strokeWeight(C?h:1),t.noFill(),t.strokeJoin(t.ROUND);const m=r.categories,w=r.currentCategoryIndex,x=r.position;let T=r.t||0;const J=1,rt=4;if(r.trail||(r.trail=[]),m.length>0){const H=m[w%m.length],V=m[(w+1)%m.length],R=f[H],B=f[V];if(R&&B){let P={x:0,y:0};if(c){const M={x:R.x-25,y:R.y-25},O={x:B.x+25,y:B.y+25};P.x=t.bezierPoint(R.x,M.x-50,O.x-50,B.x,T),P.y=t.bezierPoint(R.y,M.y+50,O.y+50,B.y,T)}else P.x=t.lerp(R.x,B.x,T),P.y=t.lerp(R.y,B.y,T);const k=r.trail,U=k[k.length-1];(!U||ut(U,P)>=J*J)&&(k.length>=rt&&k.shift(),k.push({x:P.x,y:P.y}));const G=.004*g;T+=G,T>1&&(T=0,r.currentCategoryIndex=(w+1)%m.length,r.currentCategoryIndex===0&&(r.loopsCompleted+=1,r.loopsCompleted>=r.loopsToComplete&&i&&Dt(r.moveBy))),r.t=T,x.x=P.x,x.y=P.y,t.beginShape();for(let M=0;M<k.length;M++){const O=k[M];t.vertex(O.x,O.y)}t.endShape()}}}function o(t,r,i,f,c,g,h,d){const y=i,C=.004*d;o.trails||(o.trails={});const b=o.trails;Object.keys(y).forEach(m=>{var T;const w=y[m],x=f[m];if(x){b[m]||(b[m]={t:Math.random(),trail:[]});const S=b[m];S.t+=C,S.t>1&&(S.t=0);const H=S.t*t.TWO_PI,V=2+Math.sqrt(w),R=x.x+V*t.cos(H),B=x.y+V*t.sin(H),P={x:R,y:B},k=S.trail[S.trail.length-1];(!k||ut(k,P)>=2*2)&&(S.trail.length>=4&&S.trail.shift(),S.trail.push(P));const U=c.length===0||c.some(M=>{const O=r[M];return O&&O.categories.includes(m)&&O.isStationary}),G=U&&z[g.clusterBy]?(T=z[g.clusterBy])==null?void 0:T.start:[0,0,40];t.noFill(),t.stroke(...G),t.strokeWeight(U?h:1),t.strokeJoin(t.ROUND),t.beginShape(),S.trail.forEach(M=>t.vertex(M.x,M.y)),t.endShape()}})}function p(t,r,i,f,c){var g;t.fill(...((g=z[f.clusterBy])==null?void 0:g.start)||[0,0,40]),t.noStroke(),t.textFont(I),r.forEach(([h])=>{const d=i[h];if(d){if(t.push(),c)t.translate(d.x,d.y);else{let y=Math.atan2(d.y-u(F)/2,d.x-u(N)/2);y>Math.PI/2||y<-Math.PI/2?(y+=Math.PI,t.textAlign(t.RIGHT,t.BOTTOM)):t.textAlign(t.LEFT,t.TOP),t.translate(d.x,d.y),t.rotate(y)}t.textSize(14),t.text(h,0,0),t.pop()}})}return e.$$.update=()=>{e.$$.dirty&14&&(l.clusterBy||l.moveBy||E||l.speed||a)&&(A(),L(),$.set(!1))},[_,a,l,E]}class ae extends gt{constructor(n){super(),mt(this,n,Vt,Ht,dt,{})}}var ft={},tt={},et=34,D=10,nt=13;function yt(e){return new Function("d","return {"+e.map(function(n,s){return JSON.stringify(n)+": d["+s+'] || ""'}).join(",")+"}")}function Wt(e,n){var s=yt(e);return function(a,l){return n(s(a),l,e)}}function ht(e){var n=Object.create(null),s=[];return e.forEach(function(a){for(var l in a)l in n||s.push(n[l]=l)}),s}function v(e,n){var s=e+"",a=s.length;return a<n?new Array(n-a+1).join(0)+s:s}function qt(e){return e<0?"-"+v(-e,6):e>9999?"+"+v(e,6):v(e,4)}function Zt(e){var n=e.getUTCHours(),s=e.getUTCMinutes(),a=e.getUTCSeconds(),l=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":qt(e.getUTCFullYear())+"-"+v(e.getUTCMonth()+1,2)+"-"+v(e.getUTCDate(),2)+(l?"T"+v(n,2)+":"+v(s,2)+":"+v(a,2)+"."+v(l,3)+"Z":a?"T"+v(n,2)+":"+v(s,2)+":"+v(a,2)+"Z":s||n?"T"+v(n,2)+":"+v(s,2)+"Z":"")}function Jt(e){var n=new RegExp('["'+e+`
\r]`),s=e.charCodeAt(0);function a(o,p){var t,r,i=l(o,function(f,c){if(t)return t(f,c-1);r=f,t=p?Wt(f,p):yt(f)});return i.columns=r||[],i}function l(o,p){var t=[],r=o.length,i=0,f=0,c,g=r<=0,h=!1;o.charCodeAt(r-1)===D&&--r,o.charCodeAt(r-1)===nt&&--r;function d(){if(g)return tt;if(h)return h=!1,ft;var C,b=i,m;if(o.charCodeAt(b)===et){for(;i++<r&&o.charCodeAt(i)!==et||o.charCodeAt(++i)===et;);return(C=i)>=r?g=!0:(m=o.charCodeAt(i++))===D?h=!0:m===nt&&(h=!0,o.charCodeAt(i)===D&&++i),o.slice(b+1,C-1).replace(/""/g,'"')}for(;i<r;){if((m=o.charCodeAt(C=i++))===D)h=!0;else if(m===nt)h=!0,o.charCodeAt(i)===D&&++i;else if(m!==s)continue;return o.slice(b,C)}return g=!0,o.slice(b,r)}for(;(c=d())!==tt;){for(var y=[];c!==ft&&c!==tt;)y.push(c),c=d();p&&(y=p(y,f++))==null||t.push(y)}return t}function E(o,p){return o.map(function(t){return p.map(function(r){return j(t[r])}).join(e)})}function I(o,p){return p==null&&(p=ht(o)),[p.map(j).join(e)].concat(E(o,p)).join(`
`)}function _(o,p){return p==null&&(p=ht(o)),E(o,p).join(`
`)}function A(o){return o.map(L).join(`
`)}function L(o){return o.map(j).join(e)}function j(o){return o==null?"":o instanceof Date?Zt(o):n.test(o+="")?'"'+o.replace(/"/g,'""')+'"':o}return{parse:a,parseRows:l,format:I,formatBody:_,formatRows:A,formatRow:L,formatValue:j}}var Gt=Jt("	"),Yt=Gt.parse;function Qt(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.text()}function Xt(e,n){return fetch(e,n).then(Qt)}function Kt(e){return function(n,s,a){return arguments.length===2&&typeof s=="function"&&(a=s,s=void 0),Xt(n,s).then(function(l){return e(l,a)})}}var ce=Kt(Yt);export{ae as S,se as e,pt as l,Dt as m,ie as r,ce as t};
