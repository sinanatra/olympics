const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./p5.min.7_hCuTSf.js","./_commonjsHelpers.Cpj98o6Y.js"])))=>i.map(i=>d[i]);
import{s as gt,e as xt,c as Ct,b as vt,f as st,m as Q,i as Et,X as St,n as ot,Y as Pt,o as bt,k as X,x as f}from"./scheduler.Xi5sktIg.js";import{S as mt,i as pt,c as kt,a as Rt,m as _t,d as Tt,t as Mt,e as jt}from"./index.DXItMEGr.js";import{_ as It}from"./preload-helper.C1FmrZbK.js";import{b as wt}from"./paths.DrF5AcZQ.js";import{f as it,c as W,r as K,p as $,g as at,w as H,h as V,b as Bt,d as ct,e as J,i as Y,j as ut,a as Ot,s as At,k as Nt,l as lt}from"./stores.DfVWKANe.js";import{c as Z}from"./constants.BfKEPlZp.js";function Ft(n){let o,s,i;return{c(){o=xt("div"),this.h()},l(c){o=Ct(c,"DIV",{style:!0,class:!0}),vt(o).forEach(st),this.h()},h(){Q(o,"style",n[0]),Q(o,"class","m-0")},m(c,b){Et(c,o,b),s||(i=St(n[1].call(null,o)),s=!0)},p(c,[b]){b&1&&Q(o,"style",c[0])},i:ot,o:ot,d(c){c&&st(o),s=!1,i()}}}function Lt(n,o){return o.forEach(([s,i])=>n[s]=i),n}function Ut(n,o,s){let{target:i=void 0}=o,{sketch:c=void 0}=o,{parentDivStyle:b="display: block;"}=o,{debug:B=!1}=o,D;const F=Pt(),O={ref(){F("ref",i)},instance(){F("instance",D)}};function A(r){return s(2,i=r),{destroy(){s(2,i=void 0)}}}return bt(async()=>{const r=await It(()=>import("./p5.min.7_hCuTSf.js").then(e=>e.p),__vite__mapDeps([0,1]),import.meta.url),{default:m}=r,t=Object.entries(r).filter(([e,d])=>d instanceof Function&&e[0]!=="_"&&e!=="default");B&&console.log("available p5 native classes",t),D=new m(e=>(e=Lt(e,t),B&&console.log("p5 instance",e),window._p5Instance=e,c(e)),i),O.ref(),O.instance()}),n.$$set=r=>{"target"in r&&s(2,i=r.target),"sketch"in r&&s(3,c=r.sketch),"parentDivStyle"in r&&s(0,b=r.parentDivStyle),"debug"in r&&s(4,B=r.debug)},[b,A,i,c,B]}class Dt extends mt{constructor(o){super(),pt(this,o,Ut,Ft,gt,{target:2,sketch:3,parentDivStyle:0,debug:4})}}function zt(n){let o,s;return o=new Dt({props:{sketch:n[0]}}),{c(){kt(o.$$.fragment)},l(i){Rt(o.$$.fragment,i)},m(i,c){_t(o,i,c),s=!0},p:ot,i(i){s||(Tt(o.$$.fragment,i),s=!0)},o(i){Mt(o.$$.fragment,i),s=!1},d(i){jt(o,i)}}}function ft(n,o){const s=n.x-o.x,i=n.y-o.y;return s*s+i*i}function Ht(n,o,s){let i,c,b;X(n,it,t=>s(1,i=t)),X(n,W,t=>s(2,c=t)),X(n,K,t=>s(3,b=t));let B;const D=t=>{t.preload=()=>{B=t.loadFont(wt+"/font/CircularStd-Book.otf",()=>{at.set(!0)})},t.setup=()=>{const e=t.createCanvas(f(H),f(V));Bt.set(e.canvas),t.colorMode(t.HSL),t.background(0),t.frameRate(30),f(ct).length>0&&(F(),O())},t.draw=()=>{t.background(0,.1);const e=f(J),d=f(Y),a=f(ut),l=f(it),u=f(W),x=u.highlightedEntities||f(Ot),g=u.stroke||f(At),p=f(at),y=u.speed||f(Nt),C=f(lt),v=f(K),k=Math.max(...Object.values(C));f($)&&(F(),O(),$.set(!1)),m(t,e,C,k,a,x,u,g,y,l);const j={highlighted:[],normal:[]};Object.values(e).forEach(h=>{if(h.isStationary)return;x.length===0||x.includes(h.moveBy)?j.highlighted.push(h):j.normal.push(h)}),j.highlighted.length>0&&j.highlighted.forEach(h=>{A(t,h,!0,a,l,y,g,u,x)}),j.normal.length>0&&j.normal.forEach(h=>{A(t,h,!1,a,l,y,g,u,x)}),p&&M(t,d,a,u,v)}};function F(){const t=new Map,e={},d=f(W);f(ct).forEach(a=>{const l=a[d.moveBy],u=a[d.clusterBy];e[l]||(e[l]={categories:[],moveBy:l,dataPoints:[],currentCategoryIndex:0,position:{x:0,y:0},t:0,isStationary:!0,trail:[],loopsCompleted:0,loopsToComplete:d.loops||1}),e[l].dataPoints.push(a),e[l].categories.push(u),u!==e[l].categories[0]&&(e[l].isStationary=!1),t.has(u)||t.set(u,[]),t.get(u).push(a)}),J.set(e),Y.set(Array.from(t.entries()).sort(([a],[l])=>!isNaN(a)&&!isNaN(l)?+a-+l:a.localeCompare(l)))}function O(){const e=(f(H)-100)/2,d=(f(V)-50*2)/2,a={},l=f(Y).length,u=Math.PI;f(Y).forEach(([p],y)=>{const C=u+y/l*Math.PI*2,v=f(K)?{x:50+Math.random()*(f(H)-2*50),y:50+Math.random()*(f(V)-2*50)}:{x:f(H)/2+e*Math.cos(C),y:f(V)/2+d*Math.sin(C)};a[p]={x:v.x,y:v.y}}),ut.set(a);const x=f(J),g={};Object.values(x).forEach(p=>{const y=p.categories[0];a[y]&&(p.position={...a[y]},p.t=0,p.currentCategoryIndex=0,p.isStationary&&(g[y]||(g[y]=0),g[y]++))}),J.set(x),lt.set(g)}function A(t,e,d,a,l,u,x,g,p){if(e.isStationary)return;const y=p.length===0||d,C=Z[g.clusterBy]||{start:[0,0,100],end:[0,0,0]},v=e.categories,k=e.currentCategoryIndex,j=e.position;let h=e.t||0;const E=v[k%v.length],R=v[(k+1)%v.length],S=a[E],_=a[R];if(S&&_){const L=r(t,e,C,h,e.isGoingBack);t.stroke(y?[...L]:[0,0,40]),t.strokeWeight(y?x:.5),t.noFill(),t.strokeJoin(t.ROUND);let T={x:0,y:0};if(l){const U={x:S.x-12.5,y:S.y-12.5},rt={x:_.x+25/2,y:_.y+25/2};T.x=t.bezierPoint(S.x,U.x-25,rt.x-25,_.x,h),T.y=t.bezierPoint(S.y,U.y+25,rt.y+25,_.y,h)}else T.x=t.lerp(S.x,_.x,h),T.y=t.lerp(S.y,_.y,h);const I=e.trail||[],q=I[I.length-1],N=1;(!q||ft(q,T)>=N*N)&&(I.length>=2&&I.shift(),I.push({x:T.x,y:T.y}));const w=.004*u;h+=w,h>1&&(h=0,e.currentCategoryIndex=(k+1)%v.length,e.currentCategoryIndex===0?(e.loopsCompleted+=1,e.isGoingBack=!0):e.isGoingBack=!1),e.t=h,j.x=T.x,j.y=T.y,t.beginShape();for(let z=0;z<I.length;z++){const U=I[z];t.vertex(U.x,U.y)}t.endShape()}}function r(t,e,d,a,l){var u;return l?d.end:d.start,l?d.start:d.end,(u=Z[f(W).clusterBy])==null?void 0:u.start}function m(t,e,d,a,l,u,x,g,p,y){const C=.004*p;m.trails||(m.trails={});const v=m.trails;Object.keys(d).forEach(k=>{const j=d[k],h=l[k];if(h){v[k]||(v[k]={t:0,trail:[],isGoingBack:!1});const E=v[k];E.t+=C,E.t>1&&(E.t=0);const R=25;h.x-R,h.y-R;const S=h,_=E.t;let L={x:0,y:0};if(y){const N={x:h.x-R/2,y:h.y-R/2},w={x:S.x+R/2,y:S.y+R/2};L.x=t.bezierPoint(h.x,N.x-R,w.x-R,S.x,_),L.y=t.bezierPoint(h.y,N.y+R,w.y+R,S.y,_)}else L.x=t.lerp(h.x,S.x,_),L.y=t.lerp(h.y,S.y,_);const T=1,I=E.trail[E.trail.length-1];if((!I||ft(I,L)>=T*T)&&(E.trail.length>=10&&E.trail.shift(),E.trail.push(L)),(u.length===0||u.some(N=>{const w=e[N];return w&&w.categories.includes(k)&&w.isStationary}))&&x.clusterBy){const N=Z[x.clusterBy]||{start:[0,0,100],end:[0,0,0]},w=r(t,null,N,E.t,!1),z=t.map(j,1,a,g,g*5);t.noFill(),t.stroke(...w),t.strokeWeight(z),t.strokeJoin(t.ROUND),t.beginShape(),E.trail.forEach(U=>t.vertex(U.x,U.y)),t.endShape()}}})}function M(t,e,d,a,l){var u;t.fill(...((u=Z[a.clusterBy])==null?void 0:u.end)||[0,0,40]),t.noStroke(),t.textFont(B),e.forEach(([x])=>{const g=d[x];if(g){if(t.push(),l)t.translate(g.x,g.y);else{let p=Math.atan2(g.y-f(V)/2,g.x-f(H)/2);p>Math.PI/2||p<-Math.PI/2?(p+=Math.PI,t.textAlign(t.RIGHT,t.BOTTOM)):t.textAlign(t.LEFT,t.TOP),t.translate(g.x,g.y),t.rotate(p)}t.textSize(14),t.text(x,0,0),t.pop()}})}return n.$$.update=()=>{n.$$.dirty&14&&(c.clusterBy||c.moveBy||b||c.speed||i)&&(F(),O(),$.set(!1))},[D,i,c,b]}class re extends mt{constructor(o){super(),pt(this,o,Ht,zt,gt,{})}}var ht={},tt={},et=34,G=10,nt=13;function yt(n){return new Function("d","return {"+n.map(function(o,s){return JSON.stringify(o)+": d["+s+'] || ""'}).join(",")+"}")}function Vt(n,o){var s=yt(n);return function(i,c){return o(s(i),c,n)}}function dt(n){var o=Object.create(null),s=[];return n.forEach(function(i){for(var c in i)c in o||s.push(o[c]=c)}),s}function P(n,o){var s=n+"",i=s.length;return i<o?new Array(o-i+1).join(0)+s:s}function Gt(n){return n<0?"-"+P(-n,6):n>9999?"+"+P(n,6):P(n,4)}function Wt(n){var o=n.getUTCHours(),s=n.getUTCMinutes(),i=n.getUTCSeconds(),c=n.getUTCMilliseconds();return isNaN(n)?"Invalid Date":Gt(n.getUTCFullYear())+"-"+P(n.getUTCMonth()+1,2)+"-"+P(n.getUTCDate(),2)+(c?"T"+P(o,2)+":"+P(s,2)+":"+P(i,2)+"."+P(c,3)+"Z":i?"T"+P(o,2)+":"+P(s,2)+":"+P(i,2)+"Z":s||o?"T"+P(o,2)+":"+P(s,2)+"Z":"")}function Jt(n){var o=new RegExp('["'+n+`
\r]`),s=n.charCodeAt(0);function i(r,m){var M,t,e=c(r,function(d,a){if(M)return M(d,a-1);t=d,M=m?Vt(d,m):yt(d)});return e.columns=t||[],e}function c(r,m){var M=[],t=r.length,e=0,d=0,a,l=t<=0,u=!1;r.charCodeAt(t-1)===G&&--t,r.charCodeAt(t-1)===nt&&--t;function x(){if(l)return tt;if(u)return u=!1,ht;var p,y=e,C;if(r.charCodeAt(y)===et){for(;e++<t&&r.charCodeAt(e)!==et||r.charCodeAt(++e)===et;);return(p=e)>=t?l=!0:(C=r.charCodeAt(e++))===G?u=!0:C===nt&&(u=!0,r.charCodeAt(e)===G&&++e),r.slice(y+1,p-1).replace(/""/g,'"')}for(;e<t;){if((C=r.charCodeAt(p=e++))===G)u=!0;else if(C===nt)u=!0,r.charCodeAt(e)===G&&++e;else if(C!==s)continue;return r.slice(y,p)}return l=!0,r.slice(y,t)}for(;(a=x())!==tt;){for(var g=[];a!==ht&&a!==tt;)g.push(a),a=x();m&&(g=m(g,d++))==null||M.push(g)}return M}function b(r,m){return r.map(function(M){return m.map(function(t){return A(M[t])}).join(n)})}function B(r,m){return m==null&&(m=dt(r)),[m.map(A).join(n)].concat(b(r,m)).join(`
`)}function D(r,m){return m==null&&(m=dt(r)),b(r,m).join(`
`)}function F(r){return r.map(O).join(`
`)}function O(r){return r.map(A).join(n)}function A(r){return r==null?"":r instanceof Date?Wt(r):o.test(r+="")?'"'+r.replace(/"/g,'""')+'"':r}return{parse:i,parseRows:c,format:B,formatBody:D,formatRows:F,formatRow:O,formatValue:A}}var Yt=Jt("	"),Zt=Yt.parse;function qt(n){if(!n.ok)throw new Error(n.status+" "+n.statusText);return n.text()}function Qt(n,o){return fetch(n,o).then(qt)}function Xt(n){return function(o,s,i){return arguments.length===2&&typeof s=="function"&&(i=s,s=void 0),Qt(o,s).then(function(c){return n(c,i)})}}var se=Xt(Zt);export{re as S,se as t};
