import{s as gt,e as xt,c as vt,b as Et,f as it,m as Y,i as St,Z as bt,n as ot,_ as wt,q as Rt,k as Q,G as l}from"./scheduler.BRYLh5pv.js";import{S as mt,i as pt,b as Tt,d as Pt,m as Mt,a as Lt,t as kt,e as It}from"./index.jG7-5-V5.js";import{_ as jt}from"./preload-helper.C1FmrZbK.js";import{b as Bt}from"./paths.BynYUYde.js";import{w as Ot}from"./index.r_6kuJAQ.js";import{j as at,a as X,r as K,p as $,l as ct,w as N,i as F,g as ut,e as W,h as At,b as q,m as Z,s as Nt,k as Ft,n as lt,c as z}from"./constants.2G2OMR97.js";function ie(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function _t(e){let n,s,a;return{c(){n=xt("div"),this.h()},l(u){n=vt(u,"DIV",{style:!0,class:!0}),Et(n).forEach(it),this.h()},h(){Y(n,"style",e[0]),Y(n,"class","m-0")},m(u,E){St(u,n,E),s||(a=bt(e[1].call(null,n)),s=!0)},p(u,[E]){E&1&&Y(n,"style",u[0])},i:ot,o:ot,d(u){u&&it(n),s=!1,a()}}}function Ut(e,n){return n.forEach(([s,a])=>e[s]=a),e}function zt(e,n,s){let{target:a=void 0}=n,{sketch:u=void 0}=n,{parentDivStyle:E="display: block;"}=n,{debug:L=!1}=n,_;const A=wt(),P={ref(){A("ref",a)},instance(){A("instance",_)}};function k(o){return s(2,a=o),{destroy(){s(2,a=void 0)}}}return Rt(async()=>{const o=await jt(()=>import("./p5.min.D8xqWc_1.js").then(i=>i.p),[],import.meta.url),{default:p}=o,r=Object.entries(o).filter(([i,f])=>f instanceof Function&&i[0]!=="_"&&i!=="default");L&&console.log("available p5 native classes",r),_=new p(i=>(i=Ut(i,r),L&&console.log("p5 instance",i),window._p5Instance=i,u(i)),a),P.ref(),P.instance()}),e.$$set=o=>{"target"in o&&s(2,a=o.target),"sketch"in o&&s(3,u=o.sketch),"parentDivStyle"in o&&s(0,E=o.parentDivStyle),"debug"in o&&s(4,L=o.debug)},[E,k,a,u,L]}class Dt extends mt{constructor(n){super(),pt(this,n,zt,_t,gt,{target:2,sketch:3,parentDivStyle:0,debug:4})}}const yt=Ot({entityCompletedLoop:!1,completedEntity:null});function Ht(e){yt.set({entityCompletedLoop:!0,completedEntity:e})}function ae(){yt.set({entityCompletedLoop:!1,completedEntity:null})}function Vt(e){let n,s;return n=new Dt({props:{sketch:e[0]}}),{c(){Tt(n.$$.fragment)},l(a){Pt(n.$$.fragment,a)},m(a,u){Mt(n,a,u),s=!0},p:ot,i(a){s||(Lt(n.$$.fragment,a),s=!0)},o(a){kt(n.$$.fragment,a),s=!1},d(a){It(n,a)}}}function ft(e,n){const s=e.x-n.x,a=e.y-n.y;return s*s+a*a}function Wt(e,n,s){let a,u,E;Q(e,at,t=>s(1,a=t)),Q(e,X,t=>s(2,u=t)),Q(e,K,t=>s(3,E=t));let L;const _=t=>{t.preload=()=>{L=t.loadFont(Bt+"/font/CircularStd-Book.otf",()=>{ct.set(!0)})},t.setup=()=>{t.createCanvas(l(N),l(F)),t.colorMode(t.HSL),t.background(0),t.frameRate(60),l(ut).length>0&&(A(),P())},t.draw=()=>{t.background(0,.1);const r=l(W),i=l(At),f=l(q),c=l(Z),g=l(at),h=l(X),d=h.stroke||l(Nt),y=l(ct),C=h.speed||l(Ft),b=l(lt),m=l(K);l($)&&(A(),P(),$.set(!1)),o(t,r,b,c,i,h,d,C);const w={highlighted:[],normal:[]};Object.values(r).forEach(x=>{if(x.isStationary)return;i.length===0||i.includes(x.moveBy)?w.highlighted.push(x):w.normal.push(x)}),w.highlighted.length>0&&w.highlighted.forEach(x=>{k(t,x,!0,c,g,C,d,h,i)}),w.normal.length>0&&w.normal.forEach(x=>{k(t,x,!1,c,g,C,d,h,i)}),y&&p(t,f,c,h,m)},t.windowResized=()=>{N.set(window.innerWidth),F.set(window.innerHeight-200),t.resizeCanvas(l(N),l(F)),t.background(0),P()}};function A(){const t=new Map,r={},i=l(X);l(ut).forEach(f=>{const c=f[i.moveBy],g=f[i.clusterBy];r[c]||(r[c]={categories:[],moveBy:c,dataPoints:[],currentCategoryIndex:0,position:{x:0,y:0},t:0,isStationary:!0,trail:[],loopsCompleted:0,loopsToComplete:i.loops||1}),r[c].dataPoints.push(f),r[c].categories.push(g),g!==r[c].categories[0]&&(r[c].isStationary=!1),t.has(g)||t.set(g,[]),t.get(g).push(f)}),W.set(r),q.set(Array.from(t.entries()).sort(([f],[c])=>!isNaN(f)&&!isNaN(c)?+f-+c:f.localeCompare(c)))}function P(){const r=(l(N)-100)/2,i=(l(F)-50*2)/2,f={};l(q).forEach(([h],d)=>{const y=d/l(q).length*Math.PI*2,C=l(K)?{x:50+Math.random()*(l(N)-2*50),y:50+Math.random()*(l(F)-2*50)}:{x:l(N)/2+r*Math.cos(y),y:l(F)/2+i*Math.sin(y)};f[h]={x:C.x+(Math.random()-.5),y:C.y+(Math.random()-.5)}}),Z.set(f);const c=l(W),g={};Object.values(c).forEach(h=>{const d=h.categories[0];l(Z)[d]&&(h.position={...l(Z)[d]},h.t=0,h.currentCategoryIndex=0,h.isStationary&&(g[d]||(g[d]=0),g[d]++))}),W.set(c),lt.set(g)}function k(t,r,i,f,c,g,h,d,y){var S;if(r.isStationary)return;const C=y.length===0||i,b=C&&z[d.clusterBy]?(S=z[d.clusterBy])==null?void 0:S.start:[0,0,20];t.stroke(...b),t.strokeWeight(C?h:1),t.noFill(),t.strokeJoin(t.ROUND);const m=r.categories,w=r.currentCategoryIndex,x=r.position;let R=r.t||0;const J=1,rt=4;if(r.trail||(r.trail=[]),m.length>0){const H=m[w%m.length],V=m[(w+1)%m.length],I=f[H],j=f[V];if(I&&j){let T={x:0,y:0};if(c){const O={x:I.x-12.5,y:I.y-12.5},st={x:j.x+25/2,y:j.y+25/2};T.x=t.bezierPoint(I.x,O.x-25,st.x-25,j.x,R),T.y=t.bezierPoint(I.y,O.y+25,st.y+25,j.y,R)}else T.x=t.lerp(I.x,j.x,R),T.y=t.lerp(I.y,j.y,R);const M=r.trail,U=M[M.length-1];(!U||ft(U,T)>=J*J)&&(M.length>=rt&&M.shift(),M.push({x:T.x,y:T.y}));const G=.004*g;R+=G,R>1&&(R=0,r.currentCategoryIndex=(w+1)%m.length,r.currentCategoryIndex===0&&(r.loopsCompleted+=1,r.loopsCompleted>=r.loopsToComplete&&i&&Ht(r.moveBy))),r.t=R,x.x=T.x,x.y=T.y,t.beginShape();for(let B=0;B<M.length;B++){const O=M[B];t.vertex(O.x,O.y)}t.endShape()}}}function o(t,r,i,f,c,g,h,d){const y=i,C=.004*d;o.trails||(o.trails={});const b=o.trails;Object.keys(y).forEach(m=>{var R;const w=y[m],x=f[m];if(x){b[m]||(b[m]={t:Math.random(),trail:[]});const S=b[m];S.t+=C,S.t>1&&(S.t=0);const H=S.t*t.TWO_PI,V=2+Math.sqrt(w),I=x.x+V*t.cos(H),j=x.y+V*t.sin(H),T={x:I,y:j},M=S.trail[S.trail.length-1];(!M||ft(M,T)>=2*2)&&(S.trail.length>=4&&S.trail.shift(),S.trail.push(T));const U=c.length===0||c.some(B=>{const O=r[B];return O&&O.categories.includes(m)&&O.isStationary}),G=U&&z[g.clusterBy]?(R=z[g.clusterBy])==null?void 0:R.start:[0,0,40];t.noFill(),t.stroke(...G),t.strokeWeight(U?h:1),t.strokeJoin(t.ROUND),t.beginShape(),S.trail.forEach(B=>t.vertex(B.x,B.y)),t.endShape()}})}function p(t,r,i,f,c){var g;t.fill(...((g=z[f.clusterBy])==null?void 0:g.start)||[0,0,40]),t.noStroke(),t.textFont(L),r.forEach(([h])=>{const d=i[h];if(d){if(t.push(),c)t.translate(d.x,d.y);else{let y=Math.atan2(d.y-l(F)/2,d.x-l(N)/2);y>Math.PI/2||y<-Math.PI/2?(y+=Math.PI,t.textAlign(t.RIGHT,t.BOTTOM)):t.textAlign(t.LEFT,t.TOP),t.translate(d.x,d.y),t.rotate(y)}t.textSize(14),t.text(h,0,0),t.pop()}})}return e.$$.update=()=>{e.$$.dirty&14&&(u.clusterBy||u.moveBy||E||u.speed||a)&&(A(),P(),$.set(!1))},[_,a,u,E]}class ce extends mt{constructor(n){super(),pt(this,n,Wt,Vt,gt,{})}}var ht={},tt={},et=34,D=10,nt=13;function Ct(e){return new Function("d","return {"+e.map(function(n,s){return JSON.stringify(n)+": d["+s+'] || ""'}).join(",")+"}")}function qt(e,n){var s=Ct(e);return function(a,u){return n(s(a),u,e)}}function dt(e){var n=Object.create(null),s=[];return e.forEach(function(a){for(var u in a)u in n||s.push(n[u]=u)}),s}function v(e,n){var s=e+"",a=s.length;return a<n?new Array(n-a+1).join(0)+s:s}function Zt(e){return e<0?"-"+v(-e,6):e>9999?"+"+v(e,6):v(e,4)}function Jt(e){var n=e.getUTCHours(),s=e.getUTCMinutes(),a=e.getUTCSeconds(),u=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":Zt(e.getUTCFullYear())+"-"+v(e.getUTCMonth()+1,2)+"-"+v(e.getUTCDate(),2)+(u?"T"+v(n,2)+":"+v(s,2)+":"+v(a,2)+"."+v(u,3)+"Z":a?"T"+v(n,2)+":"+v(s,2)+":"+v(a,2)+"Z":s||n?"T"+v(n,2)+":"+v(s,2)+"Z":"")}function Gt(e){var n=new RegExp('["'+e+`
\r]`),s=e.charCodeAt(0);function a(o,p){var t,r,i=u(o,function(f,c){if(t)return t(f,c-1);r=f,t=p?qt(f,p):Ct(f)});return i.columns=r||[],i}function u(o,p){var t=[],r=o.length,i=0,f=0,c,g=r<=0,h=!1;o.charCodeAt(r-1)===D&&--r,o.charCodeAt(r-1)===nt&&--r;function d(){if(g)return tt;if(h)return h=!1,ht;var C,b=i,m;if(o.charCodeAt(b)===et){for(;i++<r&&o.charCodeAt(i)!==et||o.charCodeAt(++i)===et;);return(C=i)>=r?g=!0:(m=o.charCodeAt(i++))===D?h=!0:m===nt&&(h=!0,o.charCodeAt(i)===D&&++i),o.slice(b+1,C-1).replace(/""/g,'"')}for(;i<r;){if((m=o.charCodeAt(C=i++))===D)h=!0;else if(m===nt)h=!0,o.charCodeAt(i)===D&&++i;else if(m!==s)continue;return o.slice(b,C)}return g=!0,o.slice(b,r)}for(;(c=d())!==tt;){for(var y=[];c!==ht&&c!==tt;)y.push(c),c=d();p&&(y=p(y,f++))==null||t.push(y)}return t}function E(o,p){return o.map(function(t){return p.map(function(r){return k(t[r])}).join(e)})}function L(o,p){return p==null&&(p=dt(o)),[p.map(k).join(e)].concat(E(o,p)).join(`
`)}function _(o,p){return p==null&&(p=dt(o)),E(o,p).join(`
`)}function A(o){return o.map(P).join(`
`)}function P(o){return o.map(k).join(e)}function k(o){return o==null?"":o instanceof Date?Jt(o):n.test(o+="")?'"'+o.replace(/"/g,'""')+'"':o}return{parse:a,parseRows:u,format:L,formatBody:_,formatRows:A,formatRow:P,formatValue:k}}var Yt=Gt("	"),Qt=Yt.parse;function Xt(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.text()}function Kt(e,n){return fetch(e,n).then(Xt)}function $t(e){return function(n,s,a){return arguments.length===2&&typeof s=="function"&&(a=s,s=void 0),Kt(n,s).then(function(u){return e(u,a)})}}var ue=$t(Qt);export{ce as S,ie as e,yt as l,Ht as m,ae as r,ue as t};
