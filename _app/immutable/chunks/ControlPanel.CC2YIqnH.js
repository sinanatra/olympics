import{s as Ge,e as C,a as N,t as K,c as b,b as F,l as Ee,g as T,f as y,d as G,m,i as fe,h as u,q as se,j as he,n as ze,r as Ve,u as We,k as ge,v as me,w as De,x as ce,y as ue}from"./scheduler.3V_Ra38V.js";import{e as Y}from"./each.D6YF6ztN.js";import{S as Xe,i as Ye}from"./index.CryiHHAf.js";import{c as Se,a as ye,b as Z,f as Le,e as Ze}from"./stores.IZb_Ax2o.js";import{c as $e,f as xe}from"./constants.DQ_K6H8T.js";function Ne(e,t,n){const i=e.slice();return i[33]=t[n][0],i[34]=t[n][1],i}function Te(e,t,n){const i=e.slice();return i[34]=t[n][0],i[37]=t[n][1],i}function Ae(e,t,n){const i=e.slice();return i[40]=t[n],i}function Me(e,t,n){const i=e.slice();return i[43]=t[n],i}function Qe(e){let t,n=e[43].label+"",i;return{c(){t=C("span"),i=K(n),this.h()},l(f){t=b(f,"SPAN",{class:!0});var o=F(t);i=G(o,n),o.forEach(y),this.h()},h(){m(t,"class","filter svelte-6j7tjw")},m(f,o){fe(f,t,o),u(t,i)},p(f,o){o[0]&1&&n!==(n=f[43].label+"")&&he(i,n)},d(f){f&&y(t)}}}function He(e){let t,n=e[40]+"",i,f,o,_;function v(){return e[19](e[40])}return{c(){t=C("span"),i=K(n),f=N(),this.h()},l(c){t=b(c,"SPAN",{class:!0});var h=F(t);i=G(h,n),f=T(h),h.forEach(y),this.h()},h(){m(t,"class","svelte-6j7tjw"),ce(t,"selected",e[40]===e[4].clusterBy)},m(c,h){fe(c,t,h),u(t,i),u(t,f),o||(_=se(t,"click",v),o=!0)},p(c,h){e=c,h[0]&64&&n!==(n=e[40]+"")&&he(i,n),h[0]&80&&ce(t,"selected",e[40]===e[4].clusterBy)},d(c){c&&y(t),o=!1,_()}}}function Ue(e){let t,n=e[34]+"",i,f,o,_;function v(){return e[20](e[34])}return{c(){t=C("span"),i=K(n),f=N(),this.h()},l(c){t=b(c,"SPAN",{style:!0,class:!0});var h=F(t);i=G(h,n),f=T(h),h.forEach(y),this.h()},h(){var c;ue(t,"font-size",e[13](e[37])+"px"),m(t,"class","svelte-6j7tjw"),ce(t,"selected",((c=e[4].filters[e[4].clusterBy])==null?void 0:c[0])===e[34])},m(c,h){fe(c,t,h),u(t,i),u(t,f),o||(_=se(t,"click",v),o=!0)},p(c,h){var H;e=c,h[0]&2&&n!==(n=e[34]+"")&&he(i,n),h[0]&2&&ue(t,"font-size",e[13](e[37])+"px"),h[0]&18&&ce(t,"selected",((H=e[4].filters[e[4].clusterBy])==null?void 0:H[0])===e[34])},d(c){c&&y(t),o=!1,_()}}}function Re(e){let t,n=e[33]+"",i,f,o;function _(){return e[21](e[33])}return{c(){t=C("span"),i=K(n),this.h()},l(v){t=b(v,"SPAN",{style:!0,class:!0});var c=F(t);i=G(c,n),c.forEach(y),this.h()},h(){ue(t,"font-size",e[12](e[34])+"px"),m(t,"class","svelte-6j7tjw"),ce(t,"highlighted",e[3].includes(e[33]))},m(v,c){fe(v,t,c),u(t,i),f||(o=se(t,"click",_),f=!0)},p(v,c){e=v,c[0]&4&&n!==(n=e[33]+"")&&he(i,n),c[0]&4&&ue(t,"font-size",e[12](e[34])+"px"),c[0]&12&&ce(t,"highlighted",e[3].includes(e[33]))},d(v){v&&y(t),f=!1,o()}}}function Je(e){let t,n,i=e[2].length+"",f;return{c(){t=C("p"),n=K("100 out of "),f=K(i),this.h()},l(o){t=b(o,"P",{style:!0});var _=F(t);n=G(_,"100 out of "),f=G(_,i),_.forEach(y),this.h()},h(){ue(t,"border-top","1px solid"),ue(t,"padding-top","10px")},m(o,_){fe(o,t,_),u(t,n),u(t,f)},p(o,_){_[0]&4&&i!==(i=o[2].length+"")&&he(f,i)},d(o){o&&y(t)}}}function et(e){let t,n,i,f="",o,_,v,c,h,H="Reset",$,I,x="Copy Config",ee,E,B,g,ne="Cluster By:",U,D,de,M,A,re,te=e[4].clusterBy+"",ie,pe,_e,R,ve,Q,s,a,d,p,L,q,le,J=Y(e[0]),j=[];for(let r=0;r<J.length;r+=1)j[r]=Qe(Me(e,J,r));let W=Y(e[6]),w=[];for(let r=0;r<W.length;r+=1)w[r]=He(Ae(e,W,r));let X=Y(e[1].sort()),V=[];for(let r=0;r<X.length;r+=1)V[r]=Ue(Te(e,X,r));let ae=Y(e[2].slice(0,100).sort(Ke)),S=[];for(let r=0;r<ae.length;r+=1)S[r]=Re(Ne(e,ae,r));let O=e[2].length>100&&Je(e);return{c(){t=C("header"),n=C("div"),i=C("div"),i.innerHTML=f,o=N(),_=C("div"),v=C("div");for(let r=0;r<j.length;r+=1)j[r].c();c=N(),h=C("button"),h.textContent=H,$=N(),I=C("button"),I.textContent=x,ee=N(),E=C("div"),B=C("div"),g=C("label"),g.textContent=ne,U=N(),D=C("div");for(let r=0;r<w.length;r+=1)w[r].c();de=N(),M=C("div"),A=C("label"),re=K("Filter "),ie=K(te),pe=K(":"),_e=N(),R=C("div");for(let r=0;r<V.length;r+=1)V[r].c();ve=N(),Q=C("div"),s=C("input"),d=N(),p=C("div");for(let r=0;r<S.length;r+=1)S[r].c();L=N(),O&&O.c(),this.h()},l(r){t=b(r,"HEADER",{class:!0});var k=F(t);n=b(k,"DIV",{class:!0});var l=F(n);i=b(l,"DIV",{class:!0,"data-svelte-h":!0}),Ee(i)!=="svelte-13k81q4"&&(i.innerHTML=f),o=T(l),_=b(l,"DIV",{class:!0});var P=F(_);v=b(P,"DIV",{class:!0});var je=F(v);for(let z=0;z<j.length;z+=1)j[z].l(je);c=T(je),h=b(je,"BUTTON",{class:!0,"data-svelte-h":!0}),Ee(h)!=="svelte-qy1k7w"&&(h.textContent=H),je.forEach(y),$=T(P),I=b(P,"BUTTON",{class:!0,"data-svelte-h":!0}),Ee(I)!=="svelte-i2notl"&&(I.textContent=x),P.forEach(y),l.forEach(y),ee=T(k),E=b(k,"DIV",{class:!0});var oe=F(E);B=b(oe,"DIV",{class:!0});var Ce=F(B);g=b(Ce,"LABEL",{class:!0,"data-svelte-h":!0}),Ee(g)!=="svelte-1ekr4iz"&&(g.textContent=ne),U=T(Ce),D=b(Ce,"DIV",{class:!0});var Ie=F(D);for(let z=0;z<w.length;z+=1)w[z].l(Ie);Ie.forEach(y),Ce.forEach(y),de=T(oe),M=b(oe,"DIV",{class:!0});var be=F(M);A=b(be,"LABEL",{class:!0});var we=F(A);re=G(we,"Filter "),ie=G(we,te),pe=G(we,":"),we.forEach(y),_e=T(be),R=b(be,"DIV",{class:!0});var qe=F(R);for(let z=0;z<V.length;z+=1)V[z].l(qe);qe.forEach(y),be.forEach(y),ve=T(oe),Q=b(oe,"DIV",{class:!0});var Be=F(Q);s=b(Be,"INPUT",{type:!0,placeholder:!0,class:!0}),d=T(Be),p=b(Be,"DIV",{class:!0});var ke=F(p);for(let z=0;z<S.length;z+=1)S[z].l(ke);L=T(ke),O&&O.l(ke),ke.forEach(y),Be.forEach(y),oe.forEach(y),k.forEach(y),this.h()},h(){m(i,"class","caption"),m(h,"class","reset svelte-6j7tjw"),m(v,"class","active-filters svelte-6j7tjw"),m(I,"class","copy-config svelte-6j7tjw"),m(_,"class","header-buttons svelte-6j7tjw"),m(n,"class","header-info svelte-6j7tjw"),m(g,"class","svelte-6j7tjw"),m(D,"class","options svelte-6j7tjw"),m(B,"class","category svelte-6j7tjw"),m(A,"class","svelte-6j7tjw"),m(R,"class","options tiny svelte-6j7tjw"),m(M,"class","filtered-cluster-values svelte-6j7tjw"),m(s,"type","text"),m(s,"placeholder",a="Filter "+e[4].moveBy+"..."),s.value=e[5],m(s,"class","svelte-6j7tjw"),m(p,"class","options tiny svelte-6j7tjw"),m(Q,"class","filtered-entities svelte-6j7tjw"),m(E,"class","categories svelte-6j7tjw"),m(t,"class","svelte-6j7tjw")},m(r,k){fe(r,t,k),u(t,n),u(n,i),u(n,o),u(n,_),u(_,v);for(let l=0;l<j.length;l+=1)j[l]&&j[l].m(v,null);u(v,c),u(v,h),u(_,$),u(_,I),u(t,ee),u(t,E),u(E,B),u(B,g),u(B,U),u(B,D);for(let l=0;l<w.length;l+=1)w[l]&&w[l].m(D,null);u(E,de),u(E,M),u(M,A),u(A,re),u(A,ie),u(A,pe),u(M,_e),u(M,R);for(let l=0;l<V.length;l+=1)V[l]&&V[l].m(R,null);u(E,ve),u(E,Q),u(Q,s),u(Q,d),u(Q,p);for(let l=0;l<S.length;l+=1)S[l]&&S[l].m(p,null);u(p,L),O&&O.m(p,null),q||(le=[se(h,"click",e[10]),se(v,"click",e[10]),se(I,"click",e[11]),se(s,"input",e[7])],q=!0)},p(r,k){if(k[0]&1){J=Y(r[0]);let l;for(l=0;l<J.length;l+=1){const P=Me(r,J,l);j[l]?j[l].p(P,k):(j[l]=Qe(P),j[l].c(),j[l].m(v,c))}for(;l<j.length;l+=1)j[l].d(1);j.length=J.length}if(k[0]&336){W=Y(r[6]);let l;for(l=0;l<W.length;l+=1){const P=Ae(r,W,l);w[l]?w[l].p(P,k):(w[l]=He(P),w[l].c(),w[l].m(D,null))}for(;l<w.length;l+=1)w[l].d(1);w.length=W.length}if(k[0]&16&&te!==(te=r[4].clusterBy+"")&&he(ie,te),k[0]&8722){X=Y(r[1].sort());let l;for(l=0;l<X.length;l+=1){const P=Te(r,X,l);V[l]?V[l].p(P,k):(V[l]=Ue(P),V[l].c(),V[l].m(R,null))}for(;l<V.length;l+=1)V[l].d(1);V.length=X.length}if(k[0]&16&&a!==(a="Filter "+r[4].moveBy+"...")&&m(s,"placeholder",a),k[0]&32&&s.value!==r[5]&&(s.value=r[5]),k[0]&4108){ae=Y(r[2].slice(0,100).sort(Ke));let l;for(l=0;l<ae.length;l+=1){const P=Ne(r,ae,l);S[l]?S[l].p(P,k):(S[l]=Re(P),S[l].c(),S[l].m(p,L))}for(;l<S.length;l+=1)S[l].d(1);S.length=ae.length}r[2].length>100?O?O.p(r,k):(O=Je(r),O.c(),O.m(p,null)):O&&(O.d(1),O=null)},i:ze,o:ze,d(r){r&&y(t),Ve(j,r),Ve(w,r),Ve(V,r),Ve(S,r),O&&O.d(),q=!1,We(le)}}}const Oe=12,tt=30,Pe=12,lt=30;function Fe(e,t){const n={city:"cities",sport:"sports",height:"heights",noc:"NOCs",team:"teams",weight:"weights",year:"years",age:"ages",event:"events",medal:"medals",name:"names",is:"are"};return e===1?t:n[t]||`${t}s`}function st(e){return e.clusterBy?e.clusterBy:"all clusters"}const Ke=([e],[t])=>e.localeCompare(t);function nt(e,t,n){let i,f,o,_,v,c,h,H,$,I,x,ee,E,B,g,ne,U;ge(e,Se,s=>n(28,E=s)),ge(e,ye,s=>n(3,B=s)),ge(e,Z,s=>n(4,g=s)),ge(e,Le,s=>n(29,ne=s)),ge(e,Ze,s=>n(18,U=s));let D=g.queryValue||"";Z.update(s=>({...s,filters:s.filters||{}}));function de(s){n(5,D=s.target.value),Z.update(a=>({...a,queryValue:D}))}function M(s){var L;const a=g.filters||{},d=s.dataPoints;for(const[q,le]of Object.entries(a)){if(!le||le.length===0)continue;if(!d.some(j=>{var w;const W=(w=j[q])==null?void 0:w.toString().toLowerCase();return le.some(X=>W===X.toLowerCase())}))return!1}const p=((L=g.queryValue)==null?void 0:L.toLowerCase())||"";if(p.length>=3){const q=g.queryCategory||"name";if(!d.some(J=>{var j;return(j=J[q])==null?void 0:j.toString().toLowerCase().includes(p)}))return!1}return B.length>0?B.includes(s.moveBy):!0}function A(s,a){s==="clusterBy"?Z.update(d=>({...d,clusterBy:a})):s==="moveBy"&&Z.update(d=>({...d,moveBy:a}))}function re(s){const a=g.clusterBy;Z.update(d=>{var q;const p={...d.filters};return((q=p[a])==null?void 0:q[0])===s?delete p[a]:p[a]=[s],{...d,filters:p}})}function te(){Z.update(s=>({...s,queryValue:"",filters:{}})),n(5,D=""),ye.set([])}function ie(){const s={title:"Default Title",caption:"Add a caption here",media:!1,config:{clusterBy:g.clusterBy,moveBy:g.moveBy,filters:g.filters,queryValue:D,queryCategory:g.queryCategory||"name",speed:g.speed||6,stroke:g.stroke||10,loops:g.loopsToComplete||1,highlightedEntities:De(ye)}},a=JSON.stringify(s,null,2);navigator.clipboard.writeText(a).then(()=>{alert("Config copied to clipboard!")}).catch(d=>{console.error("Could not copy text: ",d)})}function pe(s){return h===H?Oe:Oe+(s-h)*(tt-Oe)/(H-h)}function _e(s){return x===ee?Pe:Pe+(s-x)*(lt-Pe)/(ee-x)}const R=s=>A("clusterBy",s),ve=s=>re(s),Q=s=>{ye.update(a=>(a.includes(s)||a.push(s),a))};return e.$$.update=()=>{if(e.$$.dirty[0]&262160&&(()=>{const s=new Set;return Object.values(U).forEach(a=>{a.dataPoints.forEach(d=>{const p=d[g.clusterBy];p&&s.add(p)})}),Array.from(s)})(),e.$$.dirty[0]&262144&&n(16,f=Object.entries(U).filter(([s,a])=>M(a)).reduce((s,[a,d])=>(s[a]=d,s),{})),e.$$.dirty[0]&65536&&n(2,_=Object.entries(f||{}).map(([s,a])=>[s,a.dataPoints.length])),e.$$.dirty[0]&4&&n(14,v=_.map(([s,a])=>s)),e.$$.dirty[0]&278528&&Object.entries(U).length!=v.length&&me(ye,B=v,B),e.$$.dirty[0]&25){n(0,o=[]);const s=g.filters||{};for(const[a,d]of Object.entries(s))for(const p of d)o.push({label:p,type:a});B.length===1&&o.push({label:B[0],type:"name"})}e.$$.dirty[0]&4&&n(17,c=_.map(([s,a])=>a)),e.$$.dirty[0]&131072&&(h=c.length>0?Math.min(...c):0),e.$$.dirty[0]&131072&&(H=c.length>0?Math.max(...c):1),e.$$.dirty[0]&65552&&n(1,$=(()=>{const s={};return Object.values(f).forEach(a=>{a.dataPoints.forEach(d=>{const p=d[g.clusterBy];p&&(s[p]=(s[p]||0)+1)})}),me(Le,ne=Object.entries(s),ne),Object.entries(s)})()),e.$$.dirty[0]&2&&n(15,I=$.map(([s,a])=>a)),e.$$.dirty[0]&32768&&(x=I.length>0?Math.min(...I):0),e.$$.dirty[0]&32768&&(ee=I.length>0?Math.max(...I):1),e.$$.dirty[0]&16409&&(()=>{const s=st(g),a=B.length>0?B.length:v.length;let d="";if(o.length>0){const p=o.find(L=>L.type==="name");if(p&&o.length===1)d=`${p.label} is shown moving across ${s}`,me(Se,E=d,E);else{const L=o.map(q=>q.type==="name"?q.label:`${q.type}:${q.label}`).join(", ");d=`${a} ${Fe(a,"participant")} [${L}] ${Fe(a,"is")} seen moving across ${s}`,me(Se,E=d,E)}}else d=`${a} ${Fe(a,"participant")} ${Fe(a,"is")}`,me(Se,E=`${d} ${$e[De(Z).clusterBy].text}`,E);return d})()},n(6,i=xe),n(0,o=[]),[o,$,_,B,g,D,i,de,A,re,te,ie,pe,_e,v,I,f,c,U,R,ve,Q]}class ut extends Xe{constructor(t){super(),Ye(this,t,nt,et,Ge,{},null,[-1,-1])}}export{ut as C};
