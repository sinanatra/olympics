import{s as gt,e as xt,c as vt,b as Et,f as it,m as G,i as St,T as bt,n as ot,U as wt,q as Rt,k as Q,S as l}from"./scheduler.B5e5MwHY.js";import{S as mt,i as pt,b as Tt,d as _t,m as kt,a as Pt,t as Mt,e as Lt}from"./index.yVqgE-ux.js";import{_ as It}from"./preload-helper.C1FmrZbK.js";import{b as jt}from"./paths.Cz71CWT6.js";import{w as Bt}from"./index.Bat8PTjN.js";import{j as at,a as X,r as K,p as $,k as ct,w as A,i as N,g as lt,e as W,b as q,l as J,h as Ot,s as At,m as Nt,n as ut,c as z}from"./constants.Bz7_xxji.js";function Ft(e){let n,s,i;return{c(){n=xt("div"),this.h()},l(c){n=vt(c,"DIV",{style:!0,class:!0}),Et(n).forEach(it),this.h()},h(){G(n,"style",e[0]),G(n,"class","m-0")},m(c,E){St(c,n,E),s||(i=bt(e[1].call(null,n)),s=!0)},p(c,[E]){E&1&&G(n,"style",c[0])},i:ot,o:ot,d(c){c&&it(n),s=!1,i()}}}function Ut(e,n){return n.forEach(([s,i])=>e[s]=i),e}function zt(e,n,s){let{target:i=void 0}=n,{sketch:c=void 0}=n,{parentDivStyle:E="display: block;"}=n,{debug:P=!1}=n,F;const O=wt(),_={ref(){O("ref",i)},instance(){O("instance",F)}};function M(o){return s(2,i=o),{destroy(){s(2,i=void 0)}}}return Rt(async()=>{const o=await It(()=>import("./p5.min.D8xqWc_1.js").then(a=>a.p),[],import.meta.url),{default:p}=o,r=Object.entries(o).filter(([a,u])=>u instanceof Function&&a[0]!=="_"&&a!=="default");P&&console.log("available p5 native classes",r),F=new p(a=>(a=Ut(a,r),P&&console.log("p5 instance",a),window._p5Instance=a,c(a)),i),_.ref(),_.instance()}),e.$$set=o=>{"target"in o&&s(2,i=o.target),"sketch"in o&&s(3,c=o.sketch),"parentDivStyle"in o&&s(0,E=o.parentDivStyle),"debug"in o&&s(4,P=o.debug)},[E,M,i,c,P]}class Dt extends mt{constructor(n){super(),pt(this,n,zt,Ft,gt,{target:2,sketch:3,parentDivStyle:0,debug:4})}}const yt=Bt({entityCompletedLoop:!1,completedEntity:null});function Ht(e){yt.set({entityCompletedLoop:!0,completedEntity:e})}function ie(){yt.set({entityCompletedLoop:!1,completedEntity:null})}function Vt(e){let n,s;return n=new Dt({props:{sketch:e[0]}}),{c(){Tt(n.$$.fragment)},l(i){_t(n.$$.fragment,i)},m(i,c){kt(n,i,c),s=!0},p:ot,i(i){s||(Pt(n.$$.fragment,i),s=!0)},o(i){Mt(n.$$.fragment,i),s=!1},d(i){Lt(n,i)}}}function ft(e,n){const s=e.x-n.x,i=e.y-n.y;return s*s+i*i}function Wt(e,n,s){let i,c,E;Q(e,at,t=>s(1,i=t)),Q(e,X,t=>s(2,c=t)),Q(e,K,t=>s(3,E=t));let P;const F=t=>{t.preload=()=>{P=t.loadFont(jt+"/font/CircularStd-Book.otf",()=>{ct.set(!0)})},t.setup=()=>{t.createCanvas(l(A),l(N)),t.colorMode(t.HSL),t.background(0),t.frameRate(60),l(lt).length>0&&(O(),_())},t.draw=()=>{t.background(0,.1);const r=l(W),a=l(q),u=l(J),f=l(at),h=l(X),d=h.highlightedEntities||l(Ot),g=h.stroke||l(At),y=l(ct),C=h.speed||l(Nt),b=l(ut),m=l(K);l($)&&(O(),_(),$.set(!1)),o(t,r,b,u,d,h,g,C);const w={highlighted:[],normal:[]};Object.values(r).forEach(x=>{if(x.isStationary)return;d.length===0||d.includes(x.moveBy)?w.highlighted.push(x):w.normal.push(x)}),w.highlighted.length>0&&w.highlighted.forEach(x=>{M(t,x,!0,u,f,C,g,h,d)}),w.normal.length>0&&w.normal.forEach(x=>{M(t,x,!1,u,f,C,g,h,d)}),y&&p(t,a,u,h,m)},t.windowResized=()=>{A.set(window.innerWidth),N.set(window.innerHeight-200),t.resizeCanvas(l(A),l(N)),t.background(0),_()}};function O(){const t=new Map,r={},a=l(X);l(lt).forEach(u=>{const f=u[a.moveBy],h=u[a.clusterBy];r[f]||(r[f]={categories:[],moveBy:f,dataPoints:[],currentCategoryIndex:0,position:{x:0,y:0},t:0,isStationary:!0,trail:[],loopsCompleted:0,loopsToComplete:a.loops||1}),r[f].dataPoints.push(u),r[f].categories.push(h),h!==r[f].categories[0]&&(r[f].isStationary=!1),t.has(h)||t.set(h,[]),t.get(h).push(u)}),W.set(r),q.set(Array.from(t.entries()).sort(([u],[f])=>!isNaN(u)&&!isNaN(f)?+u-+f:u.localeCompare(f)))}function _(){const r=(l(A)-100)/2,a=(l(N)-50*2)/2,u={};l(q).forEach(([d],g)=>{const y=g/l(q).length*Math.PI*2,C=l(K)?{x:50+Math.random()*(l(A)-2*50),y:50+Math.random()*(l(N)-2*50)}:{x:l(A)/2+r*Math.cos(y),y:l(N)/2+a*Math.sin(y)};u[d]={x:C.x+(Math.random()-.5),y:C.y+(Math.random()-.5)}}),J.set(u);const f=l(W),h={};Object.values(f).forEach(d=>{const g=d.categories[0];l(J)[g]&&(d.position={...l(J)[g]},d.t=0,d.currentCategoryIndex=0,d.isStationary&&(h[g]||(h[g]=0),h[g]++))}),W.set(f),ut.set(h)}function M(t,r,a,u,f,h,d,g,y){var S;if(r.isStationary)return;const C=y.length===0||a,b=C&&z[g.clusterBy]?(S=z[g.clusterBy])==null?void 0:S.start:[0,0,20];t.stroke(...b),t.strokeWeight(C?d:1),t.noFill(),t.strokeJoin(t.ROUND);const m=r.categories,w=r.currentCategoryIndex,x=r.position;let R=r.t||0;const Z=1,rt=4;if(r.trail||(r.trail=[]),m.length>0){const H=m[w%m.length],V=m[(w+1)%m.length],L=u[H],I=u[V];if(L&&I){let T={x:0,y:0};if(f){const B={x:L.x-25,y:L.y-25},st={x:I.x+50/2,y:I.y+50/2};T.x=t.bezierPoint(L.x,B.x-50,st.x-50,I.x,R),T.y=t.bezierPoint(L.y,B.y+50,st.y+50,I.y,R)}else T.x=t.lerp(L.x,I.x,R),T.y=t.lerp(L.y,I.y,R);const k=r.trail,U=k[k.length-1];(!U||ft(U,T)>=Z*Z)&&(k.length>=rt&&k.shift(),k.push({x:T.x,y:T.y}));const Y=.004*h;R+=Y,R>1&&(R=0,r.currentCategoryIndex=(w+1)%m.length,r.currentCategoryIndex===0&&(r.loopsCompleted+=1,r.loopsCompleted>=r.loopsToComplete&&a&&Ht(r.moveBy))),r.t=R,x.x=T.x,x.y=T.y,t.beginShape();for(let j=0;j<k.length;j++){const B=k[j];t.vertex(B.x,B.y)}t.endShape()}}}function o(t,r,a,u,f,h,d,g){const y=a,C=.004*g;o.trails||(o.trails={});const b=o.trails;Object.keys(y).forEach(m=>{var R;const w=y[m],x=u[m];if(x){b[m]||(b[m]={t:Math.random(),trail:[]});const S=b[m];S.t+=C,S.t>1&&(S.t=0);const H=S.t*t.TWO_PI,V=2+Math.sqrt(w),L=x.x+V*t.cos(H),I=x.y+V*t.sin(H),T={x:L,y:I},k=S.trail[S.trail.length-1];(!k||ft(k,T)>=2*2)&&(S.trail.length>=4&&S.trail.shift(),S.trail.push(T));const U=f.length===0||f.some(j=>{const B=r[j];return B&&B.categories.includes(m)&&B.isStationary}),Y=U&&z[h.clusterBy]?(R=z[h.clusterBy])==null?void 0:R.start:[0,0,40];t.noFill(),t.stroke(...Y),t.strokeWeight(U?d:1),t.strokeJoin(t.ROUND),t.beginShape(),S.trail.forEach(j=>t.vertex(j.x,j.y)),t.endShape()}})}function p(t,r,a,u,f){var h;t.fill(...((h=z[u.clusterBy])==null?void 0:h.start)||[0,0,40]),t.noStroke(),t.textFont(P),r.forEach(([d])=>{const g=a[d];if(g){if(t.push(),f)t.translate(g.x,g.y);else{let y=Math.atan2(g.y-l(N)/2,g.x-l(A)/2);y>Math.PI/2||y<-Math.PI/2?(y+=Math.PI,t.textAlign(t.RIGHT,t.BOTTOM)):t.textAlign(t.LEFT,t.TOP),t.translate(g.x,g.y),t.rotate(y)}t.textSize(14),t.text(d,0,0),t.pop()}})}return e.$$.update=()=>{e.$$.dirty&14&&(c.clusterBy||c.moveBy||E||c.speed||i)&&(O(),_(),$.set(!1))},[F,i,c,E]}class ae extends mt{constructor(n){super(),pt(this,n,Wt,Vt,gt,{})}}var ht={},tt={},et=34,D=10,nt=13;function Ct(e){return new Function("d","return {"+e.map(function(n,s){return JSON.stringify(n)+": d["+s+'] || ""'}).join(",")+"}")}function qt(e,n){var s=Ct(e);return function(i,c){return n(s(i),c,e)}}function dt(e){var n=Object.create(null),s=[];return e.forEach(function(i){for(var c in i)c in n||s.push(n[c]=c)}),s}function v(e,n){var s=e+"",i=s.length;return i<n?new Array(n-i+1).join(0)+s:s}function Jt(e){return e<0?"-"+v(-e,6):e>9999?"+"+v(e,6):v(e,4)}function Zt(e){var n=e.getUTCHours(),s=e.getUTCMinutes(),i=e.getUTCSeconds(),c=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":Jt(e.getUTCFullYear())+"-"+v(e.getUTCMonth()+1,2)+"-"+v(e.getUTCDate(),2)+(c?"T"+v(n,2)+":"+v(s,2)+":"+v(i,2)+"."+v(c,3)+"Z":i?"T"+v(n,2)+":"+v(s,2)+":"+v(i,2)+"Z":s||n?"T"+v(n,2)+":"+v(s,2)+"Z":"")}function Yt(e){var n=new RegExp('["'+e+`
\r]`),s=e.charCodeAt(0);function i(o,p){var t,r,a=c(o,function(u,f){if(t)return t(u,f-1);r=u,t=p?qt(u,p):Ct(u)});return a.columns=r||[],a}function c(o,p){var t=[],r=o.length,a=0,u=0,f,h=r<=0,d=!1;o.charCodeAt(r-1)===D&&--r,o.charCodeAt(r-1)===nt&&--r;function g(){if(h)return tt;if(d)return d=!1,ht;var C,b=a,m;if(o.charCodeAt(b)===et){for(;a++<r&&o.charCodeAt(a)!==et||o.charCodeAt(++a)===et;);return(C=a)>=r?h=!0:(m=o.charCodeAt(a++))===D?d=!0:m===nt&&(d=!0,o.charCodeAt(a)===D&&++a),o.slice(b+1,C-1).replace(/""/g,'"')}for(;a<r;){if((m=o.charCodeAt(C=a++))===D)d=!0;else if(m===nt)d=!0,o.charCodeAt(a)===D&&++a;else if(m!==s)continue;return o.slice(b,C)}return h=!0,o.slice(b,r)}for(;(f=g())!==tt;){for(var y=[];f!==ht&&f!==tt;)y.push(f),f=g();p&&(y=p(y,u++))==null||t.push(y)}return t}function E(o,p){return o.map(function(t){return p.map(function(r){return M(t[r])}).join(e)})}function P(o,p){return p==null&&(p=dt(o)),[p.map(M).join(e)].concat(E(o,p)).join(`
`)}function F(o,p){return p==null&&(p=dt(o)),E(o,p).join(`
`)}function O(o){return o.map(_).join(`
`)}function _(o){return o.map(M).join(e)}function M(o){return o==null?"":o instanceof Date?Zt(o):n.test(o+="")?'"'+o.replace(/"/g,'""')+'"':o}return{parse:i,parseRows:c,format:P,formatBody:F,formatRows:O,formatRow:_,formatValue:M}}var Gt=Yt("	"),Qt=Gt.parse;function Xt(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.text()}function Kt(e,n){return fetch(e,n).then(Xt)}function $t(e){return function(n,s,i){return arguments.length===2&&typeof s=="function"&&(i=s,s=void 0),Kt(n,s).then(function(c){return e(c,i)})}}var ce=$t(Qt);export{ae as S,yt as l,Ht as m,ie as r,ce as t};
