import{s as Ge,e as b,a as A,t as K,c as w,b as F,m as Ee,g as N,f as j,d as G,o as m,i as de,h as u,u as re,j as pe,n as qe,v as Ve,w as We,k as ye,x as se,y as De,z as fe,A as he}from"./scheduler.C4GZKIzL.js";import{e as Y}from"./each.D6YF6ztN.js";import{S as Xe,i as Ye}from"./index.DmHFZWEd.js";import{c as Se,a as ne,b as Z,f as Le,e as Ze}from"./stores.DNmsBm8e.js";import{c as $e,f as xe}from"./constants.CgZt1VnM.js";function Ae(e,t,n){const i=e.slice();return i[33]=t[n][0],i[34]=t[n][1],i}function Ne(e,t,n){const i=e.slice();return i[34]=t[n][0],i[37]=t[n][1],i}function Te(e,t,n){const i=e.slice();return i[40]=t[n],i}function Me(e,t,n){const i=e.slice();return i[43]=t[n],i}function Qe(e){let t,n=e[43].label+"",i;return{c(){t=b("span"),i=K(n),this.h()},l(f){t=w(f,"SPAN",{class:!0});var a=F(t);i=G(a,n),a.forEach(j),this.h()},h(){m(t,"class","filter svelte-6j7tjw")},m(f,a){de(f,t,a),u(t,i)},p(f,a){a[0]&1&&n!==(n=f[43].label+"")&&pe(i,n)},d(f){f&&j(t)}}}function He(e){let t,n=e[40]+"",i,f,a,_;function v(){return e[19](e[40])}return{c(){t=b("span"),i=K(n),f=A(),this.h()},l(c){t=w(c,"SPAN",{class:!0});var h=F(t);i=G(h,n),f=N(h),h.forEach(j),this.h()},h(){m(t,"class","svelte-6j7tjw"),fe(t,"selected",e[40]===e[4].clusterBy)},m(c,h){de(c,t,h),u(t,i),u(t,f),a||(_=re(t,"click",v),a=!0)},p(c,h){e=c,h[0]&64&&n!==(n=e[40]+"")&&pe(i,n),h[0]&80&&fe(t,"selected",e[40]===e[4].clusterBy)},d(c){c&&j(t),a=!1,_()}}}function Ue(e){let t,n=e[34]+"",i,f,a,_;function v(){return e[20](e[34])}return{c(){t=b("span"),i=K(n),f=A(),this.h()},l(c){t=w(c,"SPAN",{style:!0,class:!0});var h=F(t);i=G(h,n),f=N(h),h.forEach(j),this.h()},h(){var c;he(t,"font-size",e[13](e[37])+"px"),m(t,"class","svelte-6j7tjw"),fe(t,"selected",((c=e[4].filters[e[4].clusterBy])==null?void 0:c[0])===e[34])},m(c,h){de(c,t,h),u(t,i),u(t,f),a||(_=re(t,"click",v),a=!0)},p(c,h){var H;e=c,h[0]&2&&n!==(n=e[34]+"")&&pe(i,n),h[0]&2&&he(t,"font-size",e[13](e[37])+"px"),h[0]&18&&fe(t,"selected",((H=e[4].filters[e[4].clusterBy])==null?void 0:H[0])===e[34])},d(c){c&&j(t),a=!1,_()}}}function Re(e){let t,n=e[33]+"",i,f,a;function _(){return e[21](e[33])}return{c(){t=b("span"),i=K(n),this.h()},l(v){t=w(v,"SPAN",{style:!0,class:!0});var c=F(t);i=G(c,n),c.forEach(j),this.h()},h(){he(t,"font-size",e[12](e[34])+"px"),m(t,"class","svelte-6j7tjw"),fe(t,"highlighted",e[3].includes(e[33]))},m(v,c){de(v,t,c),u(t,i),f||(a=re(t,"click",_),f=!0)},p(v,c){e=v,c[0]&4&&n!==(n=e[33]+"")&&pe(i,n),c[0]&4&&he(t,"font-size",e[12](e[34])+"px"),c[0]&12&&fe(t,"highlighted",e[3].includes(e[33]))},d(v){v&&j(t),f=!1,a()}}}function Je(e){let t,n,i=e[2].length+"",f;return{c(){t=b("p"),n=K("100 out of "),f=K(i),this.h()},l(a){t=w(a,"P",{style:!0});var _=F(t);n=G(_,"100 out of "),f=G(_,i),_.forEach(j),this.h()},h(){he(t,"border-top","1px solid"),he(t,"padding-top","10px")},m(a,_){de(a,t,_),u(t,n),u(t,f)},p(a,_){_[0]&4&&i!==(i=a[2].length+"")&&pe(f,i)},d(a){a&&j(t)}}}function et(e){let t,n,i,f="",a,_,v,c,h,H="Reset",$,I,x="Copy Config",ee,E,y,g,ie="Cluster By:",U,D,_e,M,T,oe,te=e[4].clusterBy+"",ae,ve,ge,R,me,Q,s,o,d,p,L,z,le,J=Y(e[0]),C=[];for(let r=0;r<J.length;r+=1)C[r]=Qe(Me(e,J,r));let W=Y(e[6]),B=[];for(let r=0;r<W.length;r+=1)B[r]=He(Te(e,W,r));let X=Y(e[1].sort()),V=[];for(let r=0;r<X.length;r+=1)V[r]=Ue(Ne(e,X,r));let ce=Y(e[2].slice(0,100).sort(Ke)),S=[];for(let r=0;r<ce.length;r+=1)S[r]=Re(Ae(e,ce,r));let O=e[2].length>100&&Je(e);return{c(){t=b("header"),n=b("div"),i=b("div"),i.innerHTML=f,a=A(),_=b("div"),v=b("div");for(let r=0;r<C.length;r+=1)C[r].c();c=A(),h=b("button"),h.textContent=H,$=A(),I=b("button"),I.textContent=x,ee=A(),E=b("div"),y=b("div"),g=b("label"),g.textContent=ie,U=A(),D=b("div");for(let r=0;r<B.length;r+=1)B[r].c();_e=A(),M=b("div"),T=b("label"),oe=K("Filter "),ae=K(te),ve=K(":"),ge=A(),R=b("div");for(let r=0;r<V.length;r+=1)V[r].c();me=A(),Q=b("div"),s=b("input"),d=A(),p=b("div");for(let r=0;r<S.length;r+=1)S[r].c();L=A(),O&&O.c(),this.h()},l(r){t=w(r,"HEADER",{class:!0});var k=F(t);n=w(k,"DIV",{class:!0});var l=F(n);i=w(l,"DIV",{class:!0,"data-svelte-h":!0}),Ee(i)!=="svelte-13k81q4"&&(i.innerHTML=f),a=N(l),_=w(l,"DIV",{class:!0});var P=F(_);v=w(P,"DIV",{class:!0});var je=F(v);for(let q=0;q<C.length;q+=1)C[q].l(je);c=N(je),h=w(je,"BUTTON",{class:!0,"data-svelte-h":!0}),Ee(h)!=="svelte-qy1k7w"&&(h.textContent=H),je.forEach(j),$=N(P),I=w(P,"BUTTON",{class:!0,"data-svelte-h":!0}),Ee(I)!=="svelte-i2notl"&&(I.textContent=x),P.forEach(j),l.forEach(j),ee=N(k),E=w(k,"DIV",{class:!0});var ue=F(E);y=w(ue,"DIV",{class:!0});var Ce=F(y);g=w(Ce,"LABEL",{class:!0,"data-svelte-h":!0}),Ee(g)!=="svelte-1ekr4iz"&&(g.textContent=ie),U=N(Ce),D=w(Ce,"DIV",{class:!0});var Ie=F(D);for(let q=0;q<B.length;q+=1)B[q].l(Ie);Ie.forEach(j),Ce.forEach(j),_e=N(ue),M=w(ue,"DIV",{class:!0});var be=F(M);T=w(be,"LABEL",{class:!0});var we=F(T);oe=G(we,"Filter "),ae=G(we,te),ve=G(we,":"),we.forEach(j),ge=N(be),R=w(be,"DIV",{class:!0});var ze=F(R);for(let q=0;q<V.length;q+=1)V[q].l(ze);ze.forEach(j),be.forEach(j),me=N(ue),Q=w(ue,"DIV",{class:!0});var Be=F(Q);s=w(Be,"INPUT",{type:!0,placeholder:!0,class:!0}),d=N(Be),p=w(Be,"DIV",{class:!0});var ke=F(p);for(let q=0;q<S.length;q+=1)S[q].l(ke);L=N(ke),O&&O.l(ke),ke.forEach(j),Be.forEach(j),ue.forEach(j),k.forEach(j),this.h()},h(){m(i,"class","caption"),m(h,"class","reset svelte-6j7tjw"),m(v,"class","active-filters svelte-6j7tjw"),m(I,"class","copy-config svelte-6j7tjw"),m(_,"class","header-buttons svelte-6j7tjw"),m(n,"class","header-info svelte-6j7tjw"),m(g,"class","svelte-6j7tjw"),m(D,"class","options svelte-6j7tjw"),m(y,"class","category svelte-6j7tjw"),m(T,"class","svelte-6j7tjw"),m(R,"class","options tiny svelte-6j7tjw"),m(M,"class","filtered-cluster-values svelte-6j7tjw"),m(s,"type","text"),m(s,"placeholder",o="Filter "+e[4].moveBy+"..."),s.value=e[5],m(s,"class","svelte-6j7tjw"),m(p,"class","options tiny svelte-6j7tjw"),m(Q,"class","filtered-entities svelte-6j7tjw"),m(E,"class","categories svelte-6j7tjw"),m(t,"class","svelte-6j7tjw")},m(r,k){de(r,t,k),u(t,n),u(n,i),u(n,a),u(n,_),u(_,v);for(let l=0;l<C.length;l+=1)C[l]&&C[l].m(v,null);u(v,c),u(v,h),u(_,$),u(_,I),u(t,ee),u(t,E),u(E,y),u(y,g),u(y,U),u(y,D);for(let l=0;l<B.length;l+=1)B[l]&&B[l].m(D,null);u(E,_e),u(E,M),u(M,T),u(T,oe),u(T,ae),u(T,ve),u(M,ge),u(M,R);for(let l=0;l<V.length;l+=1)V[l]&&V[l].m(R,null);u(E,me),u(E,Q),u(Q,s),u(Q,d),u(Q,p);for(let l=0;l<S.length;l+=1)S[l]&&S[l].m(p,null);u(p,L),O&&O.m(p,null),z||(le=[re(h,"click",e[10]),re(v,"click",e[10]),re(I,"click",e[11]),re(s,"input",e[7])],z=!0)},p(r,k){if(k[0]&1){J=Y(r[0]);let l;for(l=0;l<J.length;l+=1){const P=Me(r,J,l);C[l]?C[l].p(P,k):(C[l]=Qe(P),C[l].c(),C[l].m(v,c))}for(;l<C.length;l+=1)C[l].d(1);C.length=J.length}if(k[0]&336){W=Y(r[6]);let l;for(l=0;l<W.length;l+=1){const P=Te(r,W,l);B[l]?B[l].p(P,k):(B[l]=He(P),B[l].c(),B[l].m(D,null))}for(;l<B.length;l+=1)B[l].d(1);B.length=W.length}if(k[0]&16&&te!==(te=r[4].clusterBy+"")&&pe(ae,te),k[0]&8730){X=Y(r[1].sort());let l;for(l=0;l<X.length;l+=1){const P=Ne(r,X,l);V[l]?V[l].p(P,k):(V[l]=Ue(P),V[l].c(),V[l].m(R,null))}for(;l<V.length;l+=1)V[l].d(1);V.length=X.length}if(k[0]&16&&o!==(o="Filter "+r[4].moveBy+"...")&&m(s,"placeholder",o),k[0]&32&&s.value!==r[5]&&(s.value=r[5]),k[0]&4108){ce=Y(r[2].slice(0,100).sort(Ke));let l;for(l=0;l<ce.length;l+=1){const P=Ae(r,ce,l);S[l]?S[l].p(P,k):(S[l]=Re(P),S[l].c(),S[l].m(p,L))}for(;l<S.length;l+=1)S[l].d(1);S.length=ce.length}r[2].length>100?O?O.p(r,k):(O=Je(r),O.c(),O.m(p,null)):O&&(O.d(1),O=null)},i:qe,o:qe,d(r){r&&j(t),Ve(C,r),Ve(B,r),Ve(V,r),Ve(S,r),O&&O.d(),z=!1,We(le)}}}const Oe=12,tt=30,Pe=12,lt=30;function Fe(e,t){const n={city:"cities",sport:"sports",height:"heights",noc:"NOCs",team:"teams",weight:"weights",year:"years",age:"ages",event:"events",medal:"medals",name:"names",is:"are"};return e===1?t:n[t]||`${t}s`}function st(e){return e.clusterBy?e.clusterBy:"all clusters"}const Ke=([e],[t])=>e.localeCompare(t);function nt(e,t,n){let i,f,a,_,v,c,h,H,$,I,x,ee,E,y,g,ie,U;ye(e,Se,s=>n(28,E=s)),ye(e,ne,s=>n(3,y=s)),ye(e,Z,s=>n(4,g=s)),ye(e,Le,s=>n(29,ie=s)),ye(e,Ze,s=>n(18,U=s));let D=g.queryValue||"";Z.update(s=>({...s,filters:s.filters||{}}));function _e(s){n(5,D=s.target.value),Z.update(o=>({...o,queryValue:D}))}function M(s){var L;const o=g.filters||{},d=s.dataPoints;for(const[z,le]of Object.entries(o)){if(!le||le.length===0)continue;if(!d.some(C=>{var B;const W=(B=C[z])==null?void 0:B.toString().toLowerCase();return le.some(X=>W===X.toLowerCase())}))return!1}const p=((L=g.queryValue)==null?void 0:L.toLowerCase())||"";if(p.length>=0){const z=g.queryCategory||"name";if(!d.some(J=>{var C;return(C=J[z])==null?void 0:C.toString().toLowerCase().includes(p)}))return!1}return y.length>0?y.includes(s.moveBy):!0}function T(s,o){s==="clusterBy"?Z.update(d=>({...d,clusterBy:o})):s==="moveBy"&&Z.update(d=>({...d,moveBy:o}))}function oe(s){const o=g.clusterBy;Z.update(d=>{var z;const p={...d.filters};return((z=p[o])==null?void 0:z[0])===s?delete p[o]:p[o]=[s],{...d,filters:p}})}function te(){Z.update(s=>({...s,queryValue:"",filters:{}})),n(5,D=""),ne.set([])}function ae(){const s={title:"Default Title",caption:"Add a caption here",media:!1,config:{clusterBy:g.clusterBy,moveBy:g.moveBy,filters:g.filters,queryValue:D,queryCategory:g.queryCategory||"name",speed:g.speed||6,stroke:g.stroke||10,loops:g.loopsToComplete||1,highlightedEntities:De(ne)}},o=JSON.stringify(s,null,2);navigator.clipboard.writeText(o).then(()=>{alert("Config copied to clipboard!")}).catch(d=>{console.error("Could not copy text: ",d)})}function ve(s){return h===H?Oe:Oe+(s-h)*(tt-Oe)/(H-h)}function ge(s){return x===ee?Pe:Pe+(s-x)*(lt-Pe)/(ee-x)}const R=s=>T("clusterBy",s),me=s=>{se(ne,y=[],y),oe(s)},Q=s=>{se(ne,y=[],y),ne.update(o=>(o.includes(s)||o.push(s),o))};return e.$$.update=()=>{if(e.$$.dirty[0]&262160&&(()=>{const s=new Set;return Object.values(U).forEach(o=>{o.dataPoints.forEach(d=>{const p=d[g.clusterBy];p&&s.add(p)})}),Array.from(s)})(),e.$$.dirty[0]&262144&&n(16,f=Object.entries(U).filter(([s,o])=>M(o)).reduce((s,[o,d])=>(s[o]=d,s),{})),e.$$.dirty[0]&65536&&n(2,_=Object.entries(f||{}).map(([s,o])=>[s,o.dataPoints.length])),e.$$.dirty[0]&4&&n(14,v=_.map(([s,o])=>s)),e.$$.dirty[0]&278528&&Object.entries(U).length!=v.length&&se(ne,y=v,y),e.$$.dirty[0]&25){n(0,a=[]);const s=g.filters||{};for(const[o,d]of Object.entries(s))for(const p of d)a.push({label:p,type:o});y.length===1&&a.push({label:y[0],type:"name"})}e.$$.dirty[0]&4&&n(17,c=_.map(([s,o])=>o)),e.$$.dirty[0]&131072&&(h=c.length>0?Math.min(...c):0),e.$$.dirty[0]&131072&&(H=c.length>0?Math.max(...c):1),e.$$.dirty[0]&65552&&n(1,$=(()=>{const s={};return Object.values(f).forEach(o=>{o.dataPoints.forEach(d=>{const p=d[g.clusterBy];p&&(s[p]=(s[p]||0)+1)})}),se(Le,ie=Object.entries(s),ie),Object.entries(s)})()),e.$$.dirty[0]&2&&n(15,I=$.map(([s,o])=>o)),e.$$.dirty[0]&32768&&(x=I.length>0?Math.min(...I):0),e.$$.dirty[0]&32768&&(ee=I.length>0?Math.max(...I):1),e.$$.dirty[0]&16409&&(()=>{const s=st(g),o=y.length>0?y.length:v.length;let d="";if(a.length>0){const p=a.find(L=>L.type==="name");if(p&&a.length===1)d=`${p.label} is shown moving across ${s}`,se(Se,E=d,E);else{const L=a.map(z=>z.type==="name"?z.label:`${z.type} â†’ ${z.label}`).join(", ");d=`${o} ${Fe(o,"participant")} {${L}} ${Fe(o,"is")} seen moving across ${s}`,se(Se,E=d,E)}}else d=`${o} ${Fe(o,"participant")} ${Fe(o,"is")}`,se(Se,E=`${d} ${$e[De(Z).clusterBy].text}`,E);return d})()},n(6,i=xe),n(0,a=[]),[a,$,_,y,g,D,i,_e,T,oe,te,ae,ve,ge,v,I,f,c,U,R,me,Q]}class ut extends Xe{constructor(t){super(),Ye(this,t,nt,et,Ge,{},null,[-1,-1])}}export{ut as C};
