const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./p5.min.7_hCuTSf.js","./_commonjsHelpers.Cpj98o6Y.js"])))=>i.map(i=>d[i]);
import{s as xt,e as St,c as bt,b as Pt,f as at,o as $,i as Rt,$ as Tt,n as st,a0 as kt,q as wt,k as W,x as ct,y as a}from"./scheduler.C4GZKIzL.js";import{S as Ct,i as vt,b as _t,d as It,m as jt,t as At,a as Bt,f as Mt}from"./index.DmHFZWEd.js";import{_ as Nt}from"./preload-helper.C1FmrZbK.js";import{b as zt}from"./paths.CShxcjV_.js";import{w as Ot}from"./index.TkERMdVl.js";import{w as B,i as lt,b as Z,r as ut,p as tt,j as ft,h as J,g as Ft,d as ht,e as Y,k as Q,l as dt,a as Lt,m as Ut,n as Ht,o as et,c as Gt}from"./stores.DNmsBm8e.js";import{c as X}from"./constants.B-I1Kvm2.js";function Dt(e){let n,r,s;return{c(){n=St("div"),this.h()},l(u){n=bt(u,"DIV",{style:!0,class:!0}),Pt(n).forEach(at),this.h()},h(){$(n,"style",e[0]),$(n,"class","m-0")},m(u,P){Rt(u,n,P),r||(s=Tt(e[1].call(null,n)),r=!0)},p(u,[P]){P&1&&$(n,"style",u[0])},i:st,o:st,d(u){u&&at(n),r=!1,s()}}}function qt(e,n){return n.forEach(([r,s])=>e[r]=s),e}function Jt(e,n,r){let{target:s=void 0}=n,{sketch:u=void 0}=n,{parentDivStyle:P="display: block;"}=n,{debug:k=!1}=n,F;const U=kt(),H={ref(){U("ref",s)},instance(){U("instance",F)}};function j(o){return r(2,s=o),{destroy(){r(2,s=void 0)}}}return wt(async()=>{const o=await Nt(()=>import("./p5.min.7_hCuTSf.js").then(d=>d.p),__vite__mapDeps([0,1]),import.meta.url),{default:C}=o,y=Object.entries(o).filter(([d,t])=>t instanceof Function&&d[0]!=="_"&&d!=="default");k&&console.log("available p5 native classes",y),F=new C(d=>(d=qt(d,y),k&&console.log("p5 instance",d),window._p5Instance=d,u(d)),s),H.ref(),H.instance()}),e.$$set=o=>{"target"in o&&r(2,s=o.target),"sketch"in o&&r(3,u=o.sketch),"parentDivStyle"in o&&r(0,P=o.parentDivStyle),"debug"in o&&r(4,k=o.debug)},[P,j,s,u,k]}class Wt extends Ct{constructor(n){super(),vt(this,n,Jt,Dt,xt,{target:2,sketch:3,parentDivStyle:0,debug:4})}}const gt=Ot(!1);function Zt(e){let n,r;return n=new Wt({props:{sketch:e[0]}}),{c(){_t(n.$$.fragment)},l(s){It(n.$$.fragment,s)},m(s,u){jt(n,s,u),r=!0},p:st,i(s){r||(At(n.$$.fragment,s),r=!0)},o(s){Bt(n.$$.fragment,s),r=!1},d(s){Mt(n,s)}}}function mt(e,n){const r=e.x-n.x,s=e.y-n.y;return r*r+s*s}function Vt(e,n,r){let s,u,P,k,F;W(e,gt,t=>r(6,s=t)),W(e,B,t=>r(7,u=t)),W(e,lt,t=>r(1,P=t)),W(e,Z,t=>r(2,k=t)),W(e,ut,t=>r(3,F=t));let U;const H=t=>{t.preload=()=>{U=t.loadFont(zt+"/font/CircularStd-Book.otf",()=>{ft.set(!0)})},t.windowResized=()=>{ct(B,u=t.windowWidth,u),t.resizeCanvas(t.windowWidth,a(J)),j()},t.setup=()=>{const i=t.createCanvas(a(B),a(J));Ft.set(i.canvas),t.colorMode(t.HSL),t.background(0),t.frameRate(30),a(ht).length>0&&j()},t.draw=()=>{t.background(0,.1);const i=a(Y),x=a(Q),l=a(dt),f=a(lt),c=a(Z),m=c.highlightedEntities||a(Lt),p=c.stroke||a(Ut),g=a(ft),v=c.speed||a(Ht),A=a(et),E=a(ut),R=Math.max(...Object.values(A));a(tt)&&(j(),tt.set(!1)),y(t,i,A,R,l,m,c,p,v,f);const _={highlighted:[],normal:[]};if(Object.values(i).forEach(h=>{if(h.isStationary)return;m.length===0||m.includes(h.moveBy)?_.highlighted.push(h):_.normal.push(h)}),_.highlighted.length>0&&_.highlighted.forEach(h=>{C(t,h,!0,l,f,v,p,c,m)}),_.normal.length>0&&_.normal.forEach(h=>{C(t,h,!1,l,f,v,p,c,m)}),g){d(t,x,l,c,E),t.textAlign(t.CENTER,t.CENTER);let h=600;a(B)<600?(t.textSize(12),h=300):a(B)>3e3?(t.textSize(40),h=1200):t.textSize(20),t.text(a(Z).caption||a(Gt),a(B)/2-h/2,a(J)/2,h)}}};function j(){const t=new Map,i={},x=a(Z);a(ht).forEach(l=>{const f=l[x.moveBy],c=l[x.clusterBy];!f||f==="NA"||!c||c==="NA"||(i[f]||(i[f]={categories:[],moveBy:f,dataPoints:[],currentCategoryIndex:0,position:null,t:0,isStationary:!0,trail:[],loopsCompleted:0,loopsToComplete:x.loops||1}),i[f].dataPoints.push(l),i[f].categories.push(c),c!==i[f].categories[0]&&(i[f].isStationary=!1),t.has(c)||t.set(c,[]),t.get(c).push(l))}),Y.set(i),Q.set(Array.from(t.entries()).sort(([l],[f])=>!isNaN(l)&&!isNaN(f)?+l-+f:l.localeCompare(f))),o()}function o(){let t=30;const i=(a(B)-t*2)/2,x=(a(J)-t*1.5)/2,l={},f=a(Q).length,c=Math.PI;a(Q).forEach(([g],v)=>{const A=c+v/f*Math.PI*2;l[g]={x:a(B)/2+i*Math.cos(A),y:a(J)/2+x*Math.sin(A)}}),dt.set(l);const m=a(Y),p={};Object.values(m).forEach(g=>{const v=g.categories[0];l[v]&&(g.position={...l[v]},g.t=0,g.currentCategoryIndex=0,g.isStationary&&(p[v]||(p[v]=0),p[v]++))}),Y.set(m),y.trails={},et.set(p)}function C(t,i,x,l,f,c,m,p,g){if(i.isStationary||!i.position)return;const v=g.length===0||x,A=X[p.clusterBy]||{start:[0,0,100],end:[0,0,0]},E=i.categories,R=i.currentCategoryIndex,_=i.position;let h=i.t||0;const G=E[R%E.length],T=E[(R+1)%E.length],S=l[G],M=l[T];if(S&&M){const q=i.isGoingBack?[0,0,20]:w(t,i,A,h,i.isGoingBack);m=i.isGoingBack?m/3:m,t.stroke(v?[...q]:[0,0,20]),t.strokeWeight(v?m:.5),t.noFill(),t.strokeJoin(t.ROUND);let I={x:null,y:null};if(f){const L={x:S.x-12.5,y:S.y-12.5},it={x:M.x+25/2,y:M.y+25/2};I.x=t.bezierPoint(S.x,L.x-25,it.x-25,M.x,h),I.y=t.bezierPoint(S.y,L.y+25,it.y+25,M.y,h)}else I.x=t.lerp(S.x,M.x,h),I.y=t.lerp(S.y,M.y,h);const N=i.trail||[],K=N[N.length-1],O=1;(!K||mt(K,I)>=O*O)&&(N.length>=2&&N.shift(),N.push({x:I.x,y:I.y}));const z=.004*c;h+=z,h>1&&(h=0,i.currentCategoryIndex=(R+1)%E.length,i.currentCategoryIndex==E.length-1?(i.isGoingBack=!0,s!==!0&&!i.isStationary&&ct(gt,s=!0,s)):i.isGoingBack=!1),i.t=h,_.x=I.x,_.y=I.y,t.beginShape();for(let D=0;D<N.length;D++){const L=N[D];t.vertex(L.x,L.y)}t.endShape()}}function w(t,i,x,l,f){var c;return f?x.end:x.start,f?x.start:x.end,(c=X[a(Z).clusterBy])==null?void 0:c.start}function y(t,i,x,l,f,c,m,p,g,v){const A=.004*g;y.trails||(y.trails={});const E=y.trails;Object.keys(x).forEach(R=>{const _=x[R],h=f[R],G=h;if(R&&_&&h){E[R]||(E[R]={t:null,trail:[],isGoingBack:!1});const T=E[R];T.t+=A,T.t>1&&(T.t=null);const S=25,M=T.t;let q={x:0,y:0};if(v){const O={x:h.x-S/2,y:h.y-S/2},z={x:G.x+S/2,y:G.y+S/2};q.x=t.bezierPoint(h.x,O.x-S,z.x-S,G.x,M),q.y=t.bezierPoint(h.y,O.y+S,z.y+S,G.y,M)}const I=1,N=T.trail[T.trail.length-1];if((!N||mt(N,q)>=I*I)&&(T.trail.length>=10&&T.trail.shift(),T.trail.push(q)),(c.length===0||c.some(O=>{const z=i[O];return z&&z.categories.includes(R)&&z.isStationary}))&&m.clusterBy){const O=X[m.clusterBy]||{start:[0,0,100],end:[0,0,0]},z=w(t,null,O,T.t,!1),D=t.map(_,1,l,p,p*5);t.noFill(),t.stroke(...z),t.strokeWeight(c.length>10?D:m.stroke||D),t.strokeJoin(t.ROUND),t.beginShape(),T.trail.forEach(L=>t.vertex(L.x,L.y)),t.endShape()}}})}function d(t,i,x,l,f){var m;const c=a(et);Math.max(...Object.values(c)),t.fill(...((m=X[l.clusterBy])==null?void 0:m.end)||[0,0,20]),t.noStroke(),t.textFont(U),i.forEach(([p])=>{const g=x[p];if(c[p],g){if(t.push(),f)t.translate(g.x,g.y);else{let E=Math.atan2(g.y-a(J)/2,g.x-a(B)/2);E>Math.PI/2||E<-Math.PI/2?(E+=Math.PI,t.textAlign(t.RIGHT,t.BOTTOM),t.textAlign(t.LEFT,t.LEFT)):(t.textAlign(t.LEFT,t.TOP),t.textAlign(t.RIGHT,t.RIGHT)),t.translate(g.x,g.y),t.rotate(E)}let v=6;a(B)<600?t.textSize(6):a(B)>3e3?(t.textSize(20),v=20):(t.textSize(12),v=12),t.textSize(v);const A=p.length<22?p:`${p.substring(0,22)}...`;t.text(A,0,0),t.pop()}})}return e.$$.update=()=>{e.$$.dirty&14&&(k.clusterBy||k.moveBy||F||k.speed||P)&&(j(),tt.set(!1))},[H,P,k,F]}class fe extends Ct{constructor(n){super(),vt(this,n,Vt,Zt,xt,{})}}var pt={},nt={},ot=34,V=10,rt=13;function Et(e){return new Function("d","return {"+e.map(function(n,r){return JSON.stringify(n)+": d["+r+'] || ""'}).join(",")+"}")}function Yt(e,n){var r=Et(e);return function(s,u){return n(r(s),u,e)}}function yt(e){var n=Object.create(null),r=[];return e.forEach(function(s){for(var u in s)u in n||r.push(n[u]=u)}),r}function b(e,n){var r=e+"",s=r.length;return s<n?new Array(n-s+1).join(0)+r:r}function Qt(e){return e<0?"-"+b(-e,6):e>9999?"+"+b(e,6):b(e,4)}function Xt(e){var n=e.getUTCHours(),r=e.getUTCMinutes(),s=e.getUTCSeconds(),u=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":Qt(e.getUTCFullYear())+"-"+b(e.getUTCMonth()+1,2)+"-"+b(e.getUTCDate(),2)+(u?"T"+b(n,2)+":"+b(r,2)+":"+b(s,2)+"."+b(u,3)+"Z":s?"T"+b(n,2)+":"+b(r,2)+":"+b(s,2)+"Z":r||n?"T"+b(n,2)+":"+b(r,2)+"Z":"")}function Kt(e){var n=new RegExp('["'+e+`
\r]`),r=e.charCodeAt(0);function s(o,C){var w,y,d=u(o,function(t,i){if(w)return w(t,i-1);y=t,w=C?Yt(t,C):Et(t)});return d.columns=y||[],d}function u(o,C){var w=[],y=o.length,d=0,t=0,i,x=y<=0,l=!1;o.charCodeAt(y-1)===V&&--y,o.charCodeAt(y-1)===rt&&--y;function f(){if(x)return nt;if(l)return l=!1,pt;var m,p=d,g;if(o.charCodeAt(p)===ot){for(;d++<y&&o.charCodeAt(d)!==ot||o.charCodeAt(++d)===ot;);return(m=d)>=y?x=!0:(g=o.charCodeAt(d++))===V?l=!0:g===rt&&(l=!0,o.charCodeAt(d)===V&&++d),o.slice(p+1,m-1).replace(/""/g,'"')}for(;d<y;){if((g=o.charCodeAt(m=d++))===V)l=!0;else if(g===rt)l=!0,o.charCodeAt(d)===V&&++d;else if(g!==r)continue;return o.slice(p,m)}return x=!0,o.slice(p,y)}for(;(i=f())!==nt;){for(var c=[];i!==pt&&i!==nt;)c.push(i),i=f();C&&(c=C(c,t++))==null||w.push(c)}return w}function P(o,C){return o.map(function(w){return C.map(function(y){return j(w[y])}).join(e)})}function k(o,C){return C==null&&(C=yt(o)),[C.map(j).join(e)].concat(P(o,C)).join(`
`)}function F(o,C){return C==null&&(C=yt(o)),P(o,C).join(`
`)}function U(o){return o.map(H).join(`
`)}function H(o){return o.map(j).join(e)}function j(o){return o==null?"":o instanceof Date?Xt(o):n.test(o+="")?'"'+o.replace(/"/g,'""')+'"':o}return{parse:s,parseRows:u,format:k,formatBody:F,formatRows:U,formatRow:H,formatValue:j}}var $t=Kt("	"),te=$t.parse;function ee(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.text()}function ne(e,n){return fetch(e,n).then(ee)}function oe(e){return function(n,r,s){return arguments.length===2&&typeof r=="function"&&(s=r,r=void 0),ne(n,r).then(function(u){return e(u,s)})}}var he=oe(te);export{fe as S,gt as m,he as t};
