const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./p5.min.7_hCuTSf.js","./_commonjsHelpers.Cpj98o6Y.js"])))=>i.map(i=>d[i]);
import{s as Ct,e as St,c as bt,b as Pt,f as it,m as $,i as Rt,X as kt,n as rt,Y as wt,p as _t,k as Y,v as at,y as l}from"./scheduler.D7Q2dnVI.js";import{S as xt,i as vt,b as Tt,d as Bt,m as jt,t as It,a as Mt,e as At}from"./index.BmfHaTgE.js";import{_ as Nt}from"./preload-helper.C1FmrZbK.js";import{b as Ot}from"./paths.DoyKTxwY.js";import{w as Lt}from"./index.CTu8yMmy.js";import{w as D,i as ct,b as Z,r as lt,p as tt,j as ut,g as Ft,e as Q,k as X,l as ft,s as ht,h as W,d as dt,a as zt,m as Ut,n as Ht,c as Dt}from"./stores.CxXQ8zAK.js";import{c as q}from"./constants.UMJNy51y.js";function Gt(e){let n,r,s;return{c(){n=St("div"),this.h()},l(u){n=bt(u,"DIV",{style:!0,class:!0}),Pt(n).forEach(it),this.h()},h(){$(n,"style",e[0]),$(n,"class","m-0")},m(u,b){Rt(u,n,b),r||(s=kt(e[1].call(null,n)),r=!0)},p(u,[b]){b&1&&$(n,"style",u[0])},i:rt,o:rt,d(u){u&&it(n),r=!1,s()}}}function Jt(e,n){return n.forEach(([r,s])=>e[r]=s),e}function Wt(e,n,r){let{target:s=void 0}=n,{sketch:u=void 0}=n,{parentDivStyle:b="display: block;"}=n,{debug:k=!1}=n,L;const z=wt(),U={ref(){z("ref",s)},instance(){z("instance",L)}};function j(o){return r(2,s=o),{destroy(){r(2,s=void 0)}}}return _t(async()=>{const o=await Nt(()=>import("./p5.min.7_hCuTSf.js").then(h=>h.p),__vite__mapDeps([0,1]),import.meta.url),{default:x}=o,y=Object.entries(o).filter(([h,t])=>t instanceof Function&&h[0]!=="_"&&h!=="default");k&&console.log("available p5 native classes",y),L=new x(h=>(h=Jt(h,y),k&&console.log("p5 instance",h),window._p5Instance=h,u(h)),s),U.ref(),U.instance()}),e.$$set=o=>{"target"in o&&r(2,s=o.target),"sketch"in o&&r(3,u=o.sketch),"parentDivStyle"in o&&r(0,b=o.parentDivStyle),"debug"in o&&r(4,k=o.debug)},[b,j,s,u,k]}class Yt extends xt{constructor(n){super(),vt(this,n,Wt,Gt,Ct,{target:2,sketch:3,parentDivStyle:0,debug:4})}}const gt=Lt(!1);function Zt(e){let n,r;return n=new Yt({props:{sketch:e[0]}}),{c(){Tt(n.$$.fragment)},l(s){Bt(n.$$.fragment,s)},m(s,u){jt(n,s,u),r=!0},p:rt,i(s){r||(It(n.$$.fragment,s),r=!0)},o(s){Mt(n.$$.fragment,s),r=!1},d(s){At(n,s)}}}function mt(e,n){const r=e.x-n.x,s=e.y-n.y;return r*r+s*s}function qt(e,n,r){let s,u,b,k,L;Y(e,gt,t=>r(6,s=t)),Y(e,D,t=>r(7,u=t)),Y(e,ct,t=>r(1,b=t)),Y(e,Z,t=>r(2,k=t)),Y(e,lt,t=>r(3,L=t));let z;const U=t=>{t.preload=()=>{z=t.loadFont(Ot+"/font/CircularStd-Book.otf",()=>{ut.set(!0)})},t.windowResized=()=>{at(D,u=t.windowWidth,u),t.resizeCanvas(t.windowWidth,l(W)),j()},t.setup=()=>{const i=t.createCanvas(l(D),l(W));Ft.set(i.canvas),t.colorMode(t.HSL),t.background(0),t.frameRate(30),l(dt).length>0&&j()},t.draw=()=>{t.background(0,.1);const i=l(Q),C=l(X),a=l(ft),f=l(ct),c=l(Z),g=c.highlightedEntities||l(zt),d=c.stroke||l(Ut),p=l(ut),v=c.speed||l(Ht),N=l(ht),_=l(lt),P=Math.max(...Object.values(N));l(tt)&&(j(),tt.set(!1)),y(t,i,N,P,a,g,c,d,v,f);const T={highlighted:[],normal:[]};Object.values(i).forEach(m=>{if(m.isStationary)return;g.length===0||g.includes(m.moveBy)?T.highlighted.push(m):T.normal.push(m)}),T.highlighted.length>0&&T.highlighted.forEach(m=>{x(t,m,!0,a,f,v,d,c,g)}),T.normal.length>0&&T.normal.forEach(m=>{x(t,m,!1,a,f,v,d,c,g)}),p&&(h(t,C,a,c,_),t.textAlign(t.CENTER,t.CENTER),t.textSize(12),t.text(l(Z).caption||l(Dt)||q[c.clusterBy].text,l(D)/2,l(W)/2))}};function j(){const t=new Map,i={},C=l(Z);l(dt).forEach(a=>{const f=a[C.moveBy],c=a[C.clusterBy];i[f]||(i[f]={categories:[],moveBy:f,dataPoints:[],currentCategoryIndex:0,position:null,t:0,isStationary:!0,trail:[],loopsCompleted:0,loopsToComplete:C.loops||1}),i[f].dataPoints.push(a),i[f].categories.push(c),c!==i[f].categories[0]&&(i[f].isStationary=!1),t.has(c)||t.set(c,[]),t.get(c).push(a)}),Q.set(i),X.set(Array.from(t.entries()).sort(([a],[f])=>!isNaN(a)&&!isNaN(f)?+a-+f:a.localeCompare(f))),o()}function o(){const i=(l(D)-100)/2,C=(l(W)-50*2)/2,a={},f=l(X).length,c=Math.PI;l(X).forEach(([p],v)=>{const N=c+v/f*Math.PI*2;a[p]={x:l(D)/2+i*Math.cos(N),y:l(W)/2+C*Math.sin(N)}}),ft.set(a);const g=l(Q),d={};Object.values(g).forEach(p=>{const v=p.categories[0];a[v]&&(p.position={...a[v]},p.t=0,p.currentCategoryIndex=0,p.isStationary&&(d[v]||(d[v]=0),d[v]++))}),Q.set(g),y.trails={},ht.set(d)}function x(t,i,C,a,f,c,g,d,p){if(i.isStationary||!i.position)return;const v=p.length===0||C,N=q[d.clusterBy]||{start:[0,0,100],end:[0,0,0]},_=i.categories,P=i.currentCategoryIndex,T=i.position;let m=i.t||0;const H=_[P%_.length],R=_[(P+1)%_.length],E=a[H],I=a[R];if(E&&I){const G=i.isGoingBack?[0,0,20]:w(t,i,N,m,i.isGoingBack);g=i.isGoingBack?g/3:g,t.stroke(v?[...G]:[0,0,20]),t.strokeWeight(v?g:.5),t.noFill(),t.strokeJoin(t.ROUND);let B={x:null,y:null};if(f){const F={x:E.x-12.5,y:E.y-12.5},st={x:I.x+25/2,y:I.y+25/2};B.x=t.bezierPoint(E.x,F.x-25,st.x-25,I.x,m),B.y=t.bezierPoint(E.y,F.y+25,st.y+25,I.y,m)}else B.x=t.lerp(E.x,I.x,m),B.y=t.lerp(E.y,I.y,m);const M=i.trail||[],K=M[M.length-1],O=1;(!K||mt(K,B)>=O*O)&&(M.length>=2&&M.shift(),M.push({x:B.x,y:B.y}));const A=.004*c;m+=A,m>1&&(m=0,i.currentCategoryIndex=(P+1)%_.length,i.currentCategoryIndex==_.length-1?(i.isGoingBack=!0,s!==!0&&!i.isStationary&&at(gt,s=!0,s)):i.isGoingBack=!1),i.t=m,T.x=B.x,T.y=B.y,t.beginShape();for(let J=0;J<M.length;J++){const F=M[J];t.vertex(F.x,F.y)}t.endShape()}}function w(t,i,C,a,f){var c;return f?C.end:C.start,f?C.start:C.end,(c=q[l(Z).clusterBy])==null?void 0:c.start}function y(t,i,C,a,f,c,g,d,p,v){const N=.004*p;y.trails||(y.trails={});const _=y.trails;Object.keys(C).forEach(P=>{const T=C[P],m=f[P],H=m;if(P&&T&&m){_[P]||(_[P]={t:null,trail:[],isGoingBack:!1});const R=_[P];R.t+=N,R.t>1&&(R.t=null);const E=25,I=R.t;let G={x:0,y:0};if(v){const O={x:m.x-E/2,y:m.y-E/2},A={x:H.x+E/2,y:H.y+E/2};G.x=t.bezierPoint(m.x,O.x-E,A.x-E,H.x,I),G.y=t.bezierPoint(m.y,O.y+E,A.y+E,H.y,I)}const B=1,M=R.trail[R.trail.length-1];if((!M||mt(M,G)>=B*B)&&(R.trail.length>=10&&R.trail.shift(),R.trail.push(G)),(c.length===0||c.some(O=>{const A=i[O];return A&&A.categories.includes(P)&&A.isStationary}))&&g.clusterBy){const O=q[g.clusterBy]||{start:[0,0,100],end:[0,0,0]},A=w(t,null,O,R.t,!1),J=t.map(T,1,a,d,d*5);t.noFill(),t.stroke(...A),t.strokeWeight(g.stroke||J),t.strokeJoin(t.ROUND),t.beginShape(),R.trail.forEach(F=>t.vertex(F.x,F.y)),t.endShape()}}})}function h(t,i,C,a,f){var c;t.fill(...((c=q[a.clusterBy])==null?void 0:c.end)||[0,0,20]),t.noStroke(),t.textFont(z),i.forEach(([g])=>{const d=C[g];if(d){if(t.push(),f)t.translate(d.x,d.y);else{let p=Math.atan2(d.y-l(W)/2,d.x-l(D)/2);p>Math.PI/2||p<-Math.PI/2?(p+=Math.PI,t.textAlign(t.RIGHT,t.BOTTOM)):t.textAlign(t.LEFT,t.TOP),t.translate(d.x,d.y),t.rotate(p)}t.textSize(14),t.text(g,0,0),t.pop()}})}return e.$$.update=()=>{e.$$.dirty&14&&(k.clusterBy||k.moveBy||L||k.speed||b)&&(j(),tt.set(!1))},[U,b,k,L]}class fe extends xt{constructor(n){super(),vt(this,n,qt,Zt,Ct,{})}}var pt={},et={},nt=34,V=10,ot=13;function Et(e){return new Function("d","return {"+e.map(function(n,r){return JSON.stringify(n)+": d["+r+'] || ""'}).join(",")+"}")}function Vt(e,n){var r=Et(e);return function(s,u){return n(r(s),u,e)}}function yt(e){var n=Object.create(null),r=[];return e.forEach(function(s){for(var u in s)u in n||r.push(n[u]=u)}),r}function S(e,n){var r=e+"",s=r.length;return s<n?new Array(n-s+1).join(0)+r:r}function Qt(e){return e<0?"-"+S(-e,6):e>9999?"+"+S(e,6):S(e,4)}function Xt(e){var n=e.getUTCHours(),r=e.getUTCMinutes(),s=e.getUTCSeconds(),u=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":Qt(e.getUTCFullYear())+"-"+S(e.getUTCMonth()+1,2)+"-"+S(e.getUTCDate(),2)+(u?"T"+S(n,2)+":"+S(r,2)+":"+S(s,2)+"."+S(u,3)+"Z":s?"T"+S(n,2)+":"+S(r,2)+":"+S(s,2)+"Z":r||n?"T"+S(n,2)+":"+S(r,2)+"Z":"")}function Kt(e){var n=new RegExp('["'+e+`
\r]`),r=e.charCodeAt(0);function s(o,x){var w,y,h=u(o,function(t,i){if(w)return w(t,i-1);y=t,w=x?Vt(t,x):Et(t)});return h.columns=y||[],h}function u(o,x){var w=[],y=o.length,h=0,t=0,i,C=y<=0,a=!1;o.charCodeAt(y-1)===V&&--y,o.charCodeAt(y-1)===ot&&--y;function f(){if(C)return et;if(a)return a=!1,pt;var g,d=h,p;if(o.charCodeAt(d)===nt){for(;h++<y&&o.charCodeAt(h)!==nt||o.charCodeAt(++h)===nt;);return(g=h)>=y?C=!0:(p=o.charCodeAt(h++))===V?a=!0:p===ot&&(a=!0,o.charCodeAt(h)===V&&++h),o.slice(d+1,g-1).replace(/""/g,'"')}for(;h<y;){if((p=o.charCodeAt(g=h++))===V)a=!0;else if(p===ot)a=!0,o.charCodeAt(h)===V&&++h;else if(p!==r)continue;return o.slice(d,g)}return C=!0,o.slice(d,y)}for(;(i=f())!==et;){for(var c=[];i!==pt&&i!==et;)c.push(i),i=f();x&&(c=x(c,t++))==null||w.push(c)}return w}function b(o,x){return o.map(function(w){return x.map(function(y){return j(w[y])}).join(e)})}function k(o,x){return x==null&&(x=yt(o)),[x.map(j).join(e)].concat(b(o,x)).join(`
`)}function L(o,x){return x==null&&(x=yt(o)),b(o,x).join(`
`)}function z(o){return o.map(U).join(`
`)}function U(o){return o.map(j).join(e)}function j(o){return o==null?"":o instanceof Date?Xt(o):n.test(o+="")?'"'+o.replace(/"/g,'""')+'"':o}return{parse:s,parseRows:u,format:k,formatBody:L,formatRows:z,formatRow:U,formatValue:j}}var $t=Kt("	"),te=$t.parse;function ee(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.text()}function ne(e,n){return fetch(e,n).then(ee)}function oe(e){return function(n,r,s){return arguments.length===2&&typeof r=="function"&&(s=r,r=void 0),ne(n,r).then(function(u){return e(u,s)})}}var he=oe(te);export{fe as S,gt as m,he as t};
