import{s as He,e as C,t as Q,a as L,c as b,b as F,d as U,f as m,g as N,l as Fe,m as v,i as ce,h as c,p as le,j as se,n as ze,q as Ve,r as Je,k as Oe,u as Ke,v as oe,w as ue,x as Ge}from"./scheduler.Xi5sktIg.js";import{e as Y}from"./each.D6YF6ztN.js";import{S as We,i as Xe}from"./index.DXItMEGr.js";import{a as ve,c as te,e as Ye}from"./stores.DfVWKANe.js";import{f as Ze}from"./constants.BfKEPlZp.js";function je(e,t,n){const i=e.slice();return i[31]=t[n][0],i[32]=t[n][1],i}function De(e,t,n){const i=e.slice();return i[32]=t[n][0],i[35]=t[n][1],i}function Le(e,t,n){const i=e.slice();return i[38]=t[n],i}function Ne(e,t,n){const i=e.slice();return i[41]=t[n],i}function Ae(e){let t,n=e[41].label+"",i;return{c(){t=C("span"),i=Q(n),this.h()},l(h){t=b(h,"SPAN",{class:!0});var o=F(t);i=U(o,n),o.forEach(m),this.h()},h(){v(t,"class","filter svelte-1ahhu9d")},m(h,o){ce(h,t,o),c(t,i)},p(h,o){o[0]&1&&n!==(n=h[41].label+"")&&se(i,n)},d(h){h&&m(t)}}}function Te(e){let t,n=e[38]+"",i,h,o,d;function _(){return e[20](e[38])}return{c(){t=C("span"),i=Q(n),h=L(),this.h()},l(u){t=b(u,"SPAN",{class:!0});var f=F(t);i=U(f,n),h=N(f),f.forEach(m),this.h()},h(){v(t,"class","svelte-1ahhu9d"),oe(t,"selected",e[38]===e[4].clusterBy)},m(u,f){ce(u,t,f),c(t,i),c(t,h),o||(d=le(t,"click",_),o=!0)},p(u,f){e=u,f[0]&128&&n!==(n=e[38]+"")&&se(i,n),f[0]&144&&oe(t,"selected",e[38]===e[4].clusterBy)},d(u){u&&m(t),o=!1,d()}}}function Me(e){let t,n=e[32]+"",i,h,o,d;function _(){return e[21](e[32])}return{c(){t=C("span"),i=Q(n),h=L(),this.h()},l(u){t=b(u,"SPAN",{style:!0,class:!0});var f=F(t);i=U(f,n),h=N(f),f.forEach(m),this.h()},h(){var u;ue(t,"font-size",e[14](e[35])+"px"),v(t,"class","svelte-1ahhu9d"),oe(t,"selected",((u=e[4].filters[e[4].clusterBy])==null?void 0:u[0])===e[32])},m(u,f){ce(u,t,f),c(t,i),c(t,h),o||(d=le(t,"click",_),o=!0)},p(u,f){var R;e=u,f[0]&2&&n!==(n=e[32]+"")&&se(i,n),f[0]&2&&ue(t,"font-size",e[14](e[35])+"px"),f[0]&18&&oe(t,"selected",((R=e[4].filters[e[4].clusterBy])==null?void 0:R[0])===e[32])},d(u){u&&m(t),o=!1,d()}}}function Qe(e){let t,n=e[31]+"",i,h,o;function d(){return e[22](e[31])}return{c(){t=C("span"),i=Q(n),this.h()},l(_){t=b(_,"SPAN",{style:!0,class:!0});var u=F(t);i=U(u,n),u.forEach(m),this.h()},h(){ue(t,"font-size",e[13](e[32])+"px"),v(t,"class","svelte-1ahhu9d"),oe(t,"highlighted",e[3].includes(e[31]))},m(_,u){ce(_,t,u),c(t,i),h||(o=le(t,"click",d),h=!0)},p(_,u){e=_,u[0]&4&&n!==(n=e[31]+"")&&se(i,n),u[0]&4&&ue(t,"font-size",e[13](e[32])+"px"),u[0]&12&&oe(t,"highlighted",e[3].includes(e[31]))},d(_){_&&m(t),h=!1,o()}}}function Ue(e){let t,n,i=e[2].length+"",h;return{c(){t=C("p"),n=Q("50 out of "),h=Q(i),this.h()},l(o){t=b(o,"P",{style:!0});var d=F(t);n=U(d,"50 out of "),h=U(d,i),d.forEach(m),this.h()},h(){ue(t,"border-top","1px solid"),ue(t,"padding-top","10px")},m(o,d){ce(o,t,d),c(t,n),c(t,h)},p(o,d){d[0]&4&&i!==(i=o[2].length+"")&&se(h,i)},d(o){o&&m(t)}}}function $e(e){let t,n,i,h,o,d,_,u,f,R="Reset",Z,w,$="Copy Config",x,D,B,g,W="Cluster By:",H,J,he,A,T,fe,ee=e[4].clusterBy+"",ne,de,pe,K,_e,s,a,p,y,S,I,X,ge,M=Y(e[0]),k=[];for(let r=0;r<M.length;r+=1)k[r]=Ae(Ne(e,M,r));let G=Y(e[7]),V=[];for(let r=0;r<G.length;r+=1)V[r]=Te(Le(e,G,r));let re=Y(e[1]),O=[];for(let r=0;r<re.length;r+=1)O[r]=Me(De(e,re,r));let ie=Y(e[2].slice(0,50).sort(Re)),P=[];for(let r=0;r<ie.length;r+=1)P[r]=Qe(je(e,ie,r));let q=e[2].length>50&&Ue(e);return{c(){t=C("header"),n=C("div"),i=C("div"),h=Q(e[6]),o=L(),d=C("div"),_=C("div");for(let r=0;r<k.length;r+=1)k[r].c();u=L(),f=C("button"),f.textContent=R,Z=L(),w=C("button"),w.textContent=$,x=L(),D=C("div"),B=C("div"),g=C("label"),g.textContent=W,H=L(),J=C("div");for(let r=0;r<V.length;r+=1)V[r].c();he=L(),A=C("div"),T=C("label"),fe=Q("Filter "),ne=Q(ee),de=Q(":"),pe=L(),K=C("div");for(let r=0;r<O.length;r+=1)O[r].c();_e=L(),s=C("div"),a=C("input"),y=L(),S=C("div");for(let r=0;r<P.length;r+=1)P[r].c();I=L(),q&&q.c(),this.h()},l(r){t=b(r,"HEADER",{class:!0});var E=F(t);n=b(E,"DIV",{class:!0});var l=F(n);i=b(l,"DIV",{class:!0});var j=F(i);h=U(j,e[6]),j.forEach(m),o=N(l),d=b(l,"DIV",{class:!0});var me=F(d);_=b(me,"DIV",{class:!0});var ye=F(_);for(let z=0;z<k.length;z+=1)k[z].l(ye);u=N(ye),f=b(ye,"BUTTON",{class:!0,"data-svelte-h":!0}),Fe(f)!=="svelte-qy1k7w"&&(f.textContent=R),ye.forEach(m),Z=N(me),w=b(me,"BUTTON",{class:!0,"data-svelte-h":!0}),Fe(w)!=="svelte-i2notl"&&(w.textContent=$),me.forEach(m),l.forEach(m),x=N(E),D=b(E,"DIV",{class:!0});var ae=F(D);B=b(ae,"DIV",{class:!0});var Ce=F(B);g=b(Ce,"LABEL",{class:!0,"data-svelte-h":!0}),Fe(g)!=="svelte-1ekr4iz"&&(g.textContent=W),H=N(Ce),J=b(Ce,"DIV",{class:!0});var qe=F(J);for(let z=0;z<V.length;z+=1)V[z].l(qe);qe.forEach(m),Ce.forEach(m),he=N(ae),A=b(ae,"DIV",{class:!0});var be=F(A);T=b(be,"LABEL",{class:!0});var Ee=F(T);fe=U(Ee,"Filter "),ne=U(Ee,ee),de=U(Ee,":"),Ee.forEach(m),pe=N(be),K=b(be,"DIV",{class:!0});var we=F(K);for(let z=0;z<O.length;z+=1)O[z].l(we);we.forEach(m),be.forEach(m),_e=N(ae),s=b(ae,"DIV",{class:!0});var Be=F(s);a=b(Be,"INPUT",{type:!0,placeholder:!0,class:!0}),y=N(Be),S=b(Be,"DIV",{class:!0});var ke=F(S);for(let z=0;z<P.length;z+=1)P[z].l(ke);I=N(ke),q&&q.l(ke),ke.forEach(m),Be.forEach(m),ae.forEach(m),E.forEach(m),this.h()},h(){v(i,"class","methodology svelte-1ahhu9d"),v(f,"class","reset svelte-1ahhu9d"),v(_,"class","active-filters svelte-1ahhu9d"),v(w,"class","copy-config svelte-1ahhu9d"),v(d,"class","header-buttons svelte-1ahhu9d"),v(n,"class","header-info svelte-1ahhu9d"),v(g,"class","svelte-1ahhu9d"),v(J,"class","options svelte-1ahhu9d"),v(B,"class","category svelte-1ahhu9d"),v(T,"class","svelte-1ahhu9d"),v(K,"class","options tiny svelte-1ahhu9d"),v(A,"class","filtered-cluster-values svelte-1ahhu9d"),v(a,"type","text"),v(a,"placeholder",p="Filter "+e[4].moveBy+"..."),a.value=e[5],v(a,"class","svelte-1ahhu9d"),v(S,"class","options tiny svelte-1ahhu9d"),v(s,"class","filtered-entities svelte-1ahhu9d"),v(D,"class","categories svelte-1ahhu9d"),v(t,"class","svelte-1ahhu9d")},m(r,E){ce(r,t,E),c(t,n),c(n,i),c(i,h),c(n,o),c(n,d),c(d,_);for(let l=0;l<k.length;l+=1)k[l]&&k[l].m(_,null);c(_,u),c(_,f),c(d,Z),c(d,w),c(t,x),c(t,D),c(D,B),c(B,g),c(B,H),c(B,J);for(let l=0;l<V.length;l+=1)V[l]&&V[l].m(J,null);c(D,he),c(D,A),c(A,T),c(T,fe),c(T,ne),c(T,de),c(A,pe),c(A,K);for(let l=0;l<O.length;l+=1)O[l]&&O[l].m(K,null);c(D,_e),c(D,s),c(s,a),c(s,y),c(s,S);for(let l=0;l<P.length;l+=1)P[l]&&P[l].m(S,null);c(S,I),q&&q.m(S,null),X||(ge=[le(f,"click",e[11]),le(_,"click",e[11]),le(w,"click",e[12]),le(a,"input",e[8])],X=!0)},p(r,E){if(E[0]&64&&se(h,r[6]),E[0]&1){M=Y(r[0]);let l;for(l=0;l<M.length;l+=1){const j=Ne(r,M,l);k[l]?k[l].p(j,E):(k[l]=Ae(j),k[l].c(),k[l].m(_,u))}for(;l<k.length;l+=1)k[l].d(1);k.length=M.length}if(E[0]&656){G=Y(r[7]);let l;for(l=0;l<G.length;l+=1){const j=Le(r,G,l);V[l]?V[l].p(j,E):(V[l]=Te(j),V[l].c(),V[l].m(J,null))}for(;l<V.length;l+=1)V[l].d(1);V.length=G.length}if(E[0]&16&&ee!==(ee=r[4].clusterBy+"")&&se(ne,ee),E[0]&17426){re=Y(r[1]);let l;for(l=0;l<re.length;l+=1){const j=De(r,re,l);O[l]?O[l].p(j,E):(O[l]=Me(j),O[l].c(),O[l].m(K,null))}for(;l<O.length;l+=1)O[l].d(1);O.length=re.length}if(E[0]&16&&p!==(p="Filter "+r[4].moveBy+"...")&&v(a,"placeholder",p),E[0]&32&&a.value!==r[5]&&(a.value=r[5]),E[0]&8204){ie=Y(r[2].slice(0,50).sort(Re));let l;for(l=0;l<ie.length;l+=1){const j=je(r,ie,l);P[l]?P[l].p(j,E):(P[l]=Qe(j),P[l].c(),P[l].m(S,I))}for(;l<P.length;l+=1)P[l].d(1);P.length=ie.length}r[2].length>50?q?q.p(r,E):(q=Ue(r),q.c(),q.m(S,null)):q&&(q.d(1),q=null)},i:ze,o:ze,d(r){r&&m(t),Ve(k,r),Ve(V,r),Ve(O,r),Ve(P,r),q&&q.d(),X=!1,Je(ge)}}}const Pe=12,xe=30,Ie=12,et=30;function Se(e,t){const n={city:"cities",sport:"sports",height:"heights",noc:"NOCs",team:"teams",weight:"weights",year:"years",age:"ages",event:"events",medal:"medals",name:"names",is:"are"};return e===1?t:n[t]||`${t}s`}function tt(e){return e.clusterBy?e.clusterBy:"all clusters"}const Re=([e],[t])=>e.localeCompare(t);function lt(e,t,n){let i,h,o,d,_,u,f,R,Z,w,$,x,D,B,g,W;Oe(e,ve,s=>n(3,B=s)),Oe(e,te,s=>n(4,g=s)),Oe(e,Ye,s=>n(19,W=s));let H=g.queryValue||"";te.update(s=>({...s,filters:s.filters||{}}));function J(s){n(5,H=s.target.value),te.update(a=>({...a,queryValue:H}))}function he(s){var S;const a=g.filters||{},p=s.dataPoints;for(const[I,X]of Object.entries(a)){if(!X||X.length===0)continue;if(!p.some(M=>{var G;const k=(G=M[I])==null?void 0:G.toString().toLowerCase();return X.some(V=>k===V.toLowerCase())}))return!1}const y=((S=g.queryValue)==null?void 0:S.toLowerCase())||"";if(y.length>=3){const I=g.queryCategory||"name";if(!p.some(ge=>{var M;return(M=ge[I])==null?void 0:M.toString().toLowerCase().includes(y)}))return!1}return B.length>0?B.includes(s.moveBy):!0}function A(s,a){s==="clusterBy"?te.update(p=>({...p,clusterBy:a})):s==="moveBy"&&te.update(p=>({...p,moveBy:a}))}function T(s){const a=g.clusterBy;te.update(p=>{var I;const y={...p.filters};return((I=y[a])==null?void 0:I[0])===s?delete y[a]:y[a]=[s],{...p,filters:y}})}function fe(){te.update(s=>({...s,queryValue:"",filters:{}})),n(5,H=""),ve.set([])}function ee(){const s={title:"",description:"",methodology:"",media:!0,config:{clusterBy:g.clusterBy,moveBy:g.moveBy,filters:g.filters,queryValue:H,queryCategory:g.queryCategory||"name",speed:g.speed||3,stroke:g.stroke||1,loops:g.loopsToComplete||1,highlightedEntities:Ge(ve)}},a=JSON.stringify(s,null,2);navigator.clipboard.writeText(a).then(()=>{alert("Config copied to clipboard!")}).catch(p=>{console.error("Could not copy text: ",p)})}function ne(s){return f===R?Pe:Pe+(s-f)*(xe-Pe)/(R-f)}function de(s){return $===x?Ie:Ie+(s-$)*(et-Ie)/(x-$)}const pe=s=>A("clusterBy",s),K=s=>T(s),_e=s=>ve.set([s]);return e.$$.update=()=>{if(e.$$.dirty[0]&524304&&(()=>{const s=new Set;return Object.values(W).forEach(a=>{a.dataPoints.forEach(p=>{const y=p[g.clusterBy];y&&s.add(y)})}),Array.from(s)})(),e.$$.dirty[0]&524288&&n(17,h=Object.entries(W).filter(([s,a])=>he(a)).reduce((s,[a,p])=>(s[a]=p,s),{})),e.$$.dirty[0]&131072&&n(2,d=Object.entries(h||{}).map(([s,a])=>[s,a.dataPoints.length])),e.$$.dirty[0]&4&&n(15,_=d.map(([s,a])=>s)),e.$$.dirty[0]&557056&&Object.entries(W).length!=_.length&&Ke(ve,B=_,B),e.$$.dirty[0]&25){n(0,o=[]);const s=g.filters||{};for(const[a,p]of Object.entries(s))for(const y of p)o.push({label:y,type:a});B.length===1&&o.push({label:B[0],type:"name"})}e.$$.dirty[0]&4&&n(18,u=d.map(([s,a])=>a)),e.$$.dirty[0]&262144&&(f=u.length>0?Math.min(...u):0),e.$$.dirty[0]&262144&&(R=u.length>0?Math.max(...u):1),e.$$.dirty[0]&131088&&n(1,Z=(()=>{const s={};return Object.values(h).forEach(a=>{a.dataPoints.forEach(p=>{const y=p[g.clusterBy];y&&(s[y]=(s[y]||0)+1)})}),Object.entries(s)})()),e.$$.dirty[0]&2&&n(16,w=Z.map(([s,a])=>a)),e.$$.dirty[0]&65536&&($=w.length>0?Math.min(...w):0),e.$$.dirty[0]&65536&&(x=w.length>0?Math.max(...w):1),e.$$.dirty[0]&32793&&n(6,D=(()=>{const s=tt(g),a=B.length>0?B.length:_.length;let p="";if(o.length>0){const y=o.find(S=>S.type==="name");if(y&&o.length===1)p=`${y.label} is shown moving across ${s}`;else{const S=o.map(I=>I.type==="name"?I.label:`${I.type}:${I.label}`).join(", ");p=`${a} ${Se(a,"participant")} [${S}]  ${Se(a,"is")} seen moving across ${s}`}}else p=`${a}  ${Se(a,"participant")}  ${Se(a,"is")} grouped by ${s}`;return p})())},n(7,i=Ze),n(0,o=[]),[o,Z,d,B,g,H,D,i,J,A,T,fe,ee,ne,de,_,w,h,u,W,pe,K,_e]}class ot extends We{constructor(t){super(),Xe(this,t,lt,$e,He,{},null,[-1,-1])}}export{ot as C};
