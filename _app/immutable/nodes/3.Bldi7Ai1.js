import{s as Xe,e as k,t as W,a as T,c as V,b as B,d as K,f as y,g as D,l as Ce,m as b,i as Y,h as d,E as ne,j as re,n as Pe,B as Se,F as lt,k as ye,G as fe,r as pe,I as Te,q as st}from"../chunks/scheduler.evRM0l9T.js";import{S as Ye,i as Ze,b as $e,d as xe,m as et,t as qe,c as nt,a as Ie,e as tt,g as rt}from"../chunks/index.aiZKxZDj.js";import{b as ot}from"../chunks/paths.nctIOhLB.js";import{h as de,c as se,e as De,b as it,d as Ae,w as at,a as ct}from"../chunks/stores.D9mTdjSf.js";import{t as ut,S as ht}from"../chunks/dsv.DGZHL61o.js";import{e as $}from"../chunks/each.D6YF6ztN.js";import{f as dt,a as ft}from"../chunks/constants.CA4Cg4R8.js";function Le(t,e,l){const n=t.slice();return n[33]=e[l][0],n[34]=e[l][1],n}function je(t,e,l){const n=t.slice();return n[34]=e[l][0],n[37]=e[l][1],n}function Me(t,e,l){const n=t.slice();return n[40]=e[l],n}function Ue(t,e,l){const n=t.slice();return n[43]=e[l],n}function Qe(t){let e,l=t[43].label+"",n,i,a,u="x",f,h,c;function H(){return t[22](t[43])}return{c(){e=k("span"),n=W(l),i=T(),a=k("button"),a.textContent=u,f=T(),this.h()},l(v){e=V(v,"SPAN",{class:!0});var p=B(e);n=K(p,l),i=D(p),a=V(p,"BUTTON",{class:!0,"data-svelte-h":!0}),Ce(a)!=="svelte-1drtrua"&&(a.textContent=u),f=D(p),p.forEach(y),this.h()},h(){b(a,"class","svelte-rl4d7s"),b(e,"class","filter svelte-rl4d7s")},m(v,p){Y(v,e,p),d(e,n),d(e,i),d(e,a),d(e,f),h||(c=ne(e,"click",H),h=!0)},p(v,p){t=v,p[0]&8&&l!==(l=t[43].label+"")&&re(n,l)},d(v){v&&y(e),h=!1,c()}}}function He(t){let e,l=t[40]+"",n,i,a,u;function f(){return t[23](t[40])}return{c(){e=k("span"),n=W(l),i=T(),this.h()},l(h){e=V(h,"SPAN",{class:!0});var c=B(e);n=K(c,l),i=D(c),c.forEach(y),this.h()},h(){b(e,"class","svelte-rl4d7s"),fe(e,"selected",t[40]===t[5].clusterBy)},m(h,c){Y(h,e,c),d(e,n),d(e,i),a||(u=ne(e,"click",f),a=!0)},p(h,c){t=h,c[0]&128&&l!==(l=t[40]+"")&&re(n,l),c[0]&160&&fe(e,"selected",t[40]===t[5].clusterBy)},d(h){h&&y(e),a=!1,u()}}}function Re(t){let e,l=t[34]+"",n,i,a,u;function f(){return t[24](t[34])}return{c(){e=k("span"),n=W(l),i=T(),this.h()},l(h){e=V(h,"SPAN",{style:!0,class:!0});var c=B(e);n=K(c,l),i=D(c),c.forEach(y),this.h()},h(){pe(e,"font-size",t[15](t[37])+"px"),b(e,"class","svelte-rl4d7s"),fe(e,"highlighted",t[34]==t[5].selectedClusterValue)},m(h,c){Y(h,e,c),d(e,n),d(e,i),a||(u=ne(e,"click",f),a=!0)},p(h,c){t=h,c[0]&2&&l!==(l=t[34]+"")&&re(n,l),c[0]&2&&pe(e,"font-size",t[15](t[37])+"px"),c[0]&34&&fe(e,"highlighted",t[34]==t[5].selectedClusterValue)},d(h){h&&y(e),a=!1,u()}}}function Ge(t){let e,l=t[33]+"",n,i,a;function u(){return t[25](t[33])}return{c(){e=k("span"),n=W(l),this.h()},l(f){e=V(f,"SPAN",{style:!0,class:!0});var h=B(e);n=K(h,l),h.forEach(y),this.h()},h(){pe(e,"font-size",t[14](t[34])+"px"),b(e,"class","svelte-rl4d7s"),fe(e,"highlighted",t[4].includes(t[33]))},m(f,h){Y(f,e,h),d(e,n),i||(a=ne(e,"click",u),i=!0)},p(f,h){t=f,h[0]&4&&l!==(l=t[33]+"")&&re(n,l),h[0]&4&&pe(e,"font-size",t[14](t[34])+"px"),h[0]&20&&fe(e,"highlighted",t[4].includes(t[33]))},d(f){f&&y(e),i=!1,a()}}}function Je(t){let e,l,n=t[2].length+"",i;return{c(){e=k("p"),l=W("50 out of "),i=W(n),this.h()},l(a){e=V(a,"P",{style:!0});var u=B(e);l=K(u,"50 out of "),i=K(u,n),u.forEach(y),this.h()},h(){pe(e,"border-top","1px solid"),pe(e,"padding-top","10px")},m(a,u){Y(a,e,u),d(e,l),d(e,i)},p(a,u){u[0]&4&&n!==(n=a[2].length+"")&&re(i,n)},d(a){a&&y(e)}}}function pt(t){let e,l,n,i,a,u,f,h,c,H="Reset",v,p,A="Copy Config",x,M,w,C,ee="Cluster By:",te,z,ge,R,G,oe,Z=t[5].clusterBy+"",le,ie,_e,X,me,J,U,ae,ve,r,g,q,Q,F=$(t[3]),_=[];for(let o=0;o<F.length;o+=1)_[o]=Qe(Ue(t,F,o));let I=$(t[7]),m=[];for(let o=0;o<I.length;o+=1)m[o]=He(Me(t,I,o));let L=$(t[1]),E=[];for(let o=0;o<L.length;o+=1)E[o]=Re(je(t,L,o));let ce=$(t[2].slice(0,50).sort(Ke)),P=[];for(let o=0;o<ce.length;o+=1)P[o]=Ge(Le(t,ce,o));let O=t[2].length>50&&Je(t);return{c(){e=k("header"),l=k("div"),n=k("div"),i=W(t[6]),a=T(),u=k("div"),f=k("div");for(let o=0;o<_.length;o+=1)_[o].c();h=T(),c=k("button"),c.textContent=H,v=T(),p=k("button"),p.textContent=A,x=T(),M=k("div"),w=k("div"),C=k("label"),C.textContent=ee,te=T(),z=k("div");for(let o=0;o<m.length;o+=1)m[o].c();ge=T(),R=k("div"),G=k("label"),oe=W("Filter "),le=W(Z),ie=W(":"),_e=T(),X=k("div");for(let o=0;o<E.length;o+=1)E[o].c();me=T(),J=k("div"),U=k("input"),ve=T(),r=k("div");for(let o=0;o<P.length;o+=1)P[o].c();g=T(),O&&O.c(),this.h()},l(o){e=V(o,"HEADER",{class:!0});var S=B(e);l=V(S,"DIV",{class:!0});var s=B(l);n=V(s,"DIV",{class:!0});var j=B(n);i=K(j,t[6]),j.forEach(y),a=D(s),u=V(s,"DIV",{class:!0});var ue=B(u);f=V(ue,"DIV",{class:!0});var ze=B(f);for(let N=0;N<_.length;N+=1)_[N].l(ze);ze.forEach(y),h=D(ue),c=V(ue,"BUTTON",{class:!0,"data-svelte-h":!0}),Ce(c)!=="svelte-qy1k7w"&&(c.textContent=H),v=D(ue),p=V(ue,"BUTTON",{class:!0,"data-svelte-h":!0}),Ce(p)!=="svelte-i2notl"&&(p.textContent=A),ue.forEach(y),s.forEach(y),x=D(S),M=V(S,"DIV",{class:!0});var he=B(M);w=V(he,"DIV",{class:!0});var be=B(w);C=V(be,"LABEL",{class:!0,"data-svelte-h":!0}),Ce(C)!=="svelte-1ekr4iz"&&(C.textContent=ee),te=D(be),z=V(be,"DIV",{class:!0});var Fe=B(z);for(let N=0;N<m.length;N+=1)m[N].l(Fe);Fe.forEach(y),be.forEach(y),ge=D(he),R=V(he,"DIV",{class:!0});var ke=B(R);G=V(ke,"LABEL",{class:!0});var Ve=B(G);oe=K(Ve,"Filter "),le=K(Ve,Z),ie=K(Ve,":"),Ve.forEach(y),_e=D(ke),X=V(ke,"DIV",{class:!0});var Ne=B(X);for(let N=0;N<E.length;N+=1)E[N].l(Ne);Ne.forEach(y),ke.forEach(y),me=D(he),J=V(he,"DIV",{class:!0});var Ee=B(J);U=V(Ee,"INPUT",{type:!0,placeholder:!0,class:!0}),ve=D(Ee),r=V(Ee,"DIV",{class:!0});var Be=B(r);for(let N=0;N<P.length;N+=1)P[N].l(Be);g=D(Be),O&&O.l(Be),Be.forEach(y),Ee.forEach(y),he.forEach(y),S.forEach(y),this.h()},h(){b(n,"class","methodology svelte-rl4d7s"),b(f,"class","active-filters svelte-rl4d7s"),b(c,"class","reset svelte-rl4d7s"),b(p,"class","copy-config svelte-rl4d7s"),b(u,"class","header-buttons svelte-rl4d7s"),b(l,"class","header-info svelte-rl4d7s"),b(C,"class","svelte-rl4d7s"),b(z,"class","options svelte-rl4d7s"),b(w,"class","category svelte-rl4d7s"),b(G,"class","svelte-rl4d7s"),b(X,"class","options tiny svelte-rl4d7s"),b(R,"class","filtered-cluster-values svelte-rl4d7s"),b(U,"type","text"),b(U,"placeholder",ae="Filter "+t[5].moveBy+"..."),U.value=t[0],b(U,"class","svelte-rl4d7s"),b(r,"class","options tiny svelte-rl4d7s"),b(J,"class","filtered-entities svelte-rl4d7s"),b(M,"class","categories svelte-rl4d7s"),b(e,"class","svelte-rl4d7s")},m(o,S){Y(o,e,S),d(e,l),d(l,n),d(n,i),d(l,a),d(l,u),d(u,f);for(let s=0;s<_.length;s+=1)_[s]&&_[s].m(f,null);d(u,h),d(u,c),d(u,v),d(u,p),d(e,x),d(e,M),d(M,w),d(w,C),d(w,te),d(w,z);for(let s=0;s<m.length;s+=1)m[s]&&m[s].m(z,null);d(M,ge),d(M,R),d(R,G),d(G,oe),d(G,le),d(G,ie),d(R,_e),d(R,X);for(let s=0;s<E.length;s+=1)E[s]&&E[s].m(X,null);d(M,me),d(M,J),d(J,U),d(J,ve),d(J,r);for(let s=0;s<P.length;s+=1)P[s]&&P[s].m(r,null);d(r,g),O&&O.m(r,null),q||(Q=[ne(c,"click",t[12]),ne(p,"click",t[13]),ne(U,"input",t[8])],q=!0)},p(o,S){if(S[0]&64&&re(i,o[6]),S[0]&1032){F=$(o[3]);let s;for(s=0;s<F.length;s+=1){const j=Ue(o,F,s);_[s]?_[s].p(j,S):(_[s]=Qe(j),_[s].c(),_[s].m(f,null))}for(;s<_.length;s+=1)_[s].d(1);_.length=F.length}if(S[0]&672){I=$(o[7]);let s;for(s=0;s<I.length;s+=1){const j=Me(o,I,s);m[s]?m[s].p(j,S):(m[s]=He(j),m[s].c(),m[s].m(z,null))}for(;s<m.length;s+=1)m[s].d(1);m.length=I.length}if(S[0]&32&&Z!==(Z=o[5].clusterBy+"")&&re(le,Z),S[0]&34850){L=$(o[1]);let s;for(s=0;s<L.length;s+=1){const j=je(o,L,s);E[s]?E[s].p(j,S):(E[s]=Re(j),E[s].c(),E[s].m(X,null))}for(;s<E.length;s+=1)E[s].d(1);E.length=L.length}if(S[0]&32&&ae!==(ae="Filter "+o[5].moveBy+"...")&&b(U,"placeholder",ae),S[0]&1&&U.value!==o[0]&&(U.value=o[0]),S[0]&16404){ce=$(o[2].slice(0,50).sort(Ke));let s;for(s=0;s<ce.length;s+=1){const j=Le(o,ce,s);P[s]?P[s].p(j,S):(P[s]=Ge(j),P[s].c(),P[s].m(r,g))}for(;s<P.length;s+=1)P[s].d(1);P.length=ce.length}o[2].length>50?O?O.p(o,S):(O=Je(o),O.c(),O.m(r,null)):O&&(O.d(1),O=null)},i:Pe,o:Pe,d(o){o&&y(e),Se(_,o),Se(m,o),Se(E,o),Se(P,o),O&&O.d(),q=!1,lt(Q)}}}const we=12,gt=30,Oe=12,_t=30;function We(t,e){const l={city:"cities",sport:"sports",height:"heights",noc:"NOCs",team:"teams",weight:"weights",year:"years",age:"ages",event:"events",medal:"medals",name:"names"};return t===1?e:l[e]||`${e}s`}function mt(t){return t.clusterBy?t.clusterBy:"all clusters"}function vt(t){return t.moveBy?t.moveBy:"participants"}function yt(t){return Object.values(t).reduce((e,l)=>e+l.dataPoints.length,0)}const Ke=([t],[e])=>t.localeCompare(e);function Ct(t,e,l){let n,i,a,u,f,h,c,H,v,p,A,x,M,w,C,ee,te;ye(t,de,r=>l(4,w=r)),ye(t,se,r=>l(5,C=r)),ye(t,De,r=>l(20,ee=r)),ye(t,it,r=>l(21,te=r));let z=C.queryValue||"";function ge(r){r.target.value.length>3&&l(0,z=r.target.value)}const R=[],G=[];function oe(r,g){r==="clusterBy"?se.update(q=>({...q,clusterBy:g})):r==="moveBy"&&se.update(q=>({...q,moveBy:g}))}function Z(r){r.type==="clusterValue"?se.update(g=>({...g,selectedClusterValue:null})):r.type==="query"?(l(0,z=""),se.update(g=>({...g,queryValue:""}))):r.type==="name"&&de.set([])}function le(r){se.update(F=>({...F,selectedClusterValue:r}));const g=z.toLowerCase(),q=C.queryCategory||"name",Q=[];Object.entries(Te(De)).forEach(([F,_])=>{const I=_.dataPoints.some(L=>{var E;return((E=L[C.clusterBy])==null?void 0:E.toString())===r.toString()}),m=_.dataPoints.some(L=>{var E;return(E=L[q])==null?void 0:E.toString().toLowerCase().includes(g)});I&&m&&(Q.push(F),_.currentCategoryIndex=0,_.t=0,_.trail=[])}),de.set(Q)}function ie(){se.update(r=>({...r,queryValue:"",selectedClusterValue:null})),l(0,z=""),de.set([])}function _e(){const r={title:"",description:"",methodology:"",media:!0,config:{clusterBy:C.clusterBy,moveBy:C.moveBy,selectedClusterValue:C.selectedClusterValue||"",queryValue:z,queryCategory:C.queryCategory||"name",speed:C.speed||3,stroke:C.stroke||1,loops:C.loopsToComplete||1,highlightedEntities:Te(de)}},g=JSON.stringify(r,null,2);navigator.clipboard.writeText(g).then(()=>{alert("Config copied to clipboard!")}).catch(q=>{console.error("Could not copy text: ",q)})}function X(r){return c===H?we:we+(r-c)*(gt-we)/(H-c)}function me(r){return A===x?Oe:Oe+(r-A)*(_t-Oe)/(x-A)}const J=r=>Z(r),U=r=>oe("clusterBy",r),ae=r=>le(r),ve=r=>de.set([r]);return t.$$.update=()=>{t.$$.dirty[0]&2097152&&l(18,i=te.map(([r])=>r)),t.$$.dirty[0]&1048609&&l(16,a=Object.entries(ee).filter(([r,g])=>{const q=C.selectedClusterValue?g.dataPoints.some(I=>{var m;return((m=I[C.clusterBy])==null?void 0:m.toString())===C.selectedClusterValue.toString()}):!0,Q=z.toLowerCase(),F=C.queryCategory||"name",_=Q.length>=3?g.dataPoints.some(I=>{var m;return(m=I[F])==null?void 0:m.toString().toLowerCase().includes(Q)}):!0;return q&&_}).reduce((r,[g,q])=>(r[g]=q,r),{})),t.$$.dirty[0]&56&&(l(3,u=[]),C.selectedClusterValue&&u.push({label:`${C.selectedClusterValue}`,type:"clusterValue"}),w.length===1&&u.push({label:`${w[0]}`,type:"name"}),u.length==0&&ie()),t.$$.dirty[0]&65536&&l(2,f=Object.entries(a).map(([r,g])=>[r,g.dataPoints.length])),t.$$.dirty[0]&4&&l(19,h=f.map(([r,g])=>g)),t.$$.dirty[0]&524288&&(c=h.length>0?Math.min(...h):0),t.$$.dirty[0]&524288&&(H=h.length>0?Math.max(...h):1),t.$$.dirty[0]&1310736&&l(1,v=(()=>{const r=Object.values(ee),g=new Set(w),q=g.size>0;let Q=i;const F=[];q&&(Q=i.filter(_=>{for(let I=0;I<r.length;I++){const m=r[I];if(g.has(m.moveBy)&&m.categories.includes(_))return!0}return!1}));for(let _=0;_<Q.length;_++){const I=Q[_];let m=0;for(let L=0;L<r.length;L++){const E=r[L];(!q||g.has(E.moveBy))&&E.categories.includes(I)&&m++}F.push([I,m])}return F})()),t.$$.dirty[0]&2&&l(17,p=v.map(([r,g])=>g)),t.$$.dirty[0]&131072&&(A=p.length>0?Math.min(...p):0),t.$$.dirty[0]&131072&&(x=p.length>0?Math.max(...p):1),t.$$.dirty[0]&65584&&l(6,M=(()=>{const r=mt(C);vt(C);const g=w.length==0?yt(a):w.length;return`This visualization clusters ${g} ${We(g,"participant")}, based on ${We(r,r)}.`})())},l(7,n=dt.filter(r=>!R.includes(r))),ft.filter(r=>!G.includes(r)),l(3,u=[]),[z,v,f,u,w,C,M,n,ge,oe,Z,le,ie,_e,X,me,a,p,i,h,ee,te,J,U,ae,ve]}class bt extends Ye{constructor(e){super(),Ze(this,e,Ct,pt,Xe,{},null,[-1,-1])}}function kt(t){let e,l="Loading...";return{c(){e=k("p"),e.textContent=l,this.h()},l(n){e=V(n,"P",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-qdsr2u"&&(e.textContent=l),this.h()},h(){b(e,"class","svelte-13tgnqv")},m(n,i){Y(n,e,i)},i:Pe,o:Pe,d(n){n&&y(e)}}}function Vt(t){let e,l,n;return l=new ht({}),{c(){e=k("div"),$e(l.$$.fragment),this.h()},l(i){e=V(i,"DIV",{class:!0});var a=B(e);xe(l.$$.fragment,a),a.forEach(y),this.h()},h(){b(e,"class","svelte-13tgnqv")},m(i,a){Y(i,e,a),et(l,e,null),n=!0},i(i){n||(Ie(l.$$.fragment,i),n=!0)},o(i){qe(l.$$.fragment,i),n=!1},d(i){i&&y(e),tt(l)}}}function Et(t){let e,l,n,i,a,u,f;const h=[Vt,kt],c=[];function H(v,p){return v[0].length>0?0:1}return l=H(t),n=c[l]=h[l](t),u=new bt({}),{c(){e=k("main"),n.c(),i=T(),a=k("div"),$e(u.$$.fragment),this.h()},l(v){e=V(v,"MAIN",{});var p=B(e);n.l(p),i=D(p),a=V(p,"DIV",{class:!0});var A=B(a);xe(u.$$.fragment,A),A.forEach(y),p.forEach(y),this.h()},h(){b(a,"class","svelte-13tgnqv")},m(v,p){Y(v,e,p),c[l].m(e,null),d(e,i),d(e,a),et(u,a,null),f=!0},p(v,[p]){let A=l;l=H(v),l!==A&&(rt(),qe(c[A],1,1,()=>{c[A]=null}),nt(),n=c[l],n||(n=c[l]=h[l](v),n.c()),Ie(n,1),n.m(e,i))},i(v){f||(Ie(n),Ie(u.$$.fragment,v),f=!0)},o(v){qe(n),qe(u.$$.fragment,v),f=!1},d(v){v&&y(e),c[l].d(),tt(u)}}}function Bt(t,e,l){let n;return ye(t,Ae,i=>l(0,n=i)),st(async()=>{const a=(await ut(ot+"/data/update-until-2022/data.tsv")).map(u=>{const f={};for(const[h,c]of Object.entries(u))f[h]=c!=null&&c.trim()?c:"NA";return f});Ae.set(a),at.set(window.innerWidth),ct.set(600)}),[n]}class Ft extends Ye{constructor(e){super(),Ze(this,e,Bt,Et,Xe,{})}}export{Ft as component};
