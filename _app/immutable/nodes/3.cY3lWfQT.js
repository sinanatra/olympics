import{s as $e,e as g,a as F,t as G,c as m,b as E,l as be,g as M,f as d,d as J,m as k,i as $,h,E as oe,j as re,n as ze,B as Le,F as rt,k as ke,G as le,r as ge,I as Te,q as at}from"../chunks/scheduler.evRM0l9T.js";import{S as et,i as tt,b as lt,d as st,m as nt,t as Oe,c as it,a as Pe,e as ot,g as ct}from"../chunks/index.aiZKxZDj.js";import{b as ut}from"../chunks/paths.CVTNpBiD.js";import{h as pe,e as Qe,c as _e,b as ht,d as Ue,w as ft,a as dt}from"../chunks/stores.0UUoU4mb.js";import{t as pt,S as _t}from"../chunks/dsv.DTXZnfGG.js";import{e as te}from"../chunks/each.D6YF6ztN.js";import{f as gt,a as mt}from"../chunks/constants.nl2QH9fV.js";function He(t,e,l){const s=t.slice();return s[30]=e[l][0],s[31]=e[l][1],s}function Re(t,e,l){const s=t.slice();return s[34]=e[l],s}function xe(t,e,l){const s=t.slice();return s[31]=e[l][0],s[37]=e[l][1],s}function Ge(t,e,l){const s=t.slice();return s[34]=e[l],s}function Je(t){let e,l=t[34]+"",s,c,u,f;function _(){return t[20](t[34])}return{c(){e=g("span"),s=G(l),c=F(),this.h()},l(i){e=m(i,"SPAN",{class:!0});var r=E(e);s=J(r,l),c=M(r),r.forEach(d),this.h()},h(){k(e,"class","svelte-hplaxf"),le(e,"selected",t[34]===t[4].clusterBy)},m(i,r){$(i,e,r),h(e,s),h(e,c),u||(f=oe(e,"click",_),u=!0)},p(i,r){t=i,r[0]&64&&l!==(l=t[34]+"")&&re(s,l),r[0]&80&&le(e,"selected",t[34]===t[4].clusterBy)},d(i){i&&d(e),u=!1,f()}}}function We(t){let e,l=t[31]+"",s,c,u,f;function _(){return t[21](t[31])}return{c(){e=g("span"),s=G(l),c=F(),this.h()},l(i){e=m(i,"SPAN",{style:!0,class:!0});var r=E(e);s=J(r,l),c=M(r),r.forEach(d),this.h()},h(){ge(e,"font-size",t[13](t[37])+"px"),k(e,"class","svelte-hplaxf"),le(e,"highlighted",t[31]==t[4].selectedClusterValue)},m(i,r){$(i,e,r),h(e,s),h(e,c),u||(f=oe(e,"click",_),u=!0)},p(i,r){t=i,r[0]&2&&l!==(l=t[31]+"")&&re(s,l),r[0]&2&&ge(e,"font-size",t[13](t[37])+"px"),r[0]&18&&le(e,"highlighted",t[31]==t[4].selectedClusterValue)},d(i){i&&d(e),u=!1,f()}}}function Ke(t){let e,l=t[34]+"",s,c,u,f;function _(){return t[22](t[34])}return{c(){e=g("span"),s=G(l),c=F(),this.h()},l(i){e=m(i,"SPAN",{class:!0});var r=E(e);s=J(r,l),c=M(r),r.forEach(d),this.h()},h(){k(e,"class","svelte-hplaxf"),le(e,"selected",t[34]===t[4].moveBy)},m(i,r){$(i,e,r),h(e,s),h(e,c),u||(f=oe(e,"click",_),u=!0)},p(i,r){t=i,r[0]&32&&l!==(l=t[34]+"")&&re(s,l),r[0]&48&&le(e,"selected",t[34]===t[4].moveBy)},d(i){i&&d(e),u=!1,f()}}}function Xe(t){let e,l=t[30]+"",s,c,u;function f(){return t[23](t[30])}return{c(){e=g("span"),s=G(l),this.h()},l(_){e=m(_,"SPAN",{style:!0,class:!0});var i=E(e);s=J(i,l),i.forEach(d),this.h()},h(){ge(e,"font-size",t[12](t[31])+"px"),k(e,"class","svelte-hplaxf"),le(e,"highlighted",t[3].includes(t[30]))},m(_,i){$(_,e,i),h(e,s),c||(u=oe(e,"click",f),c=!0)},p(_,i){t=_,i[0]&4&&l!==(l=t[30]+"")&&re(s,l),i[0]&4&&ge(e,"font-size",t[12](t[31])+"px"),i[0]&12&&le(e,"highlighted",t[3].includes(t[30]))},d(_){_&&d(e),c=!1,u()}}}function Ye(t){let e,l,s=t[2].length+"",c;return{c(){e=g("p"),l=G("50 out of "),c=G(s),this.h()},l(u){e=m(u,"P",{style:!0});var f=E(e);l=J(f,"50 out of "),c=J(f,s),f.forEach(d),this.h()},h(){ge(e,"border-top","1px solid"),ge(e,"padding-top","10px")},m(u,f){$(u,e,f),h(e,l),h(e,c)},p(u,f){f[0]&4&&s!==(s=u[2].length+"")&&re(c,s)},d(u){u&&d(e)}}}function vt(t){let e,l,s,c="Reset",u,f,_="Copy Config",i,r,A,v,q="Cluster By:",D,W,se,j,y,ne,T=t[4].clusterBy+"",ae,me,ve,K,ie,X,ee,Ee="Move By:",ye,Y,Ce,U,Z,a,p=t[4].moveBy+"",V,Q,H,C,P,b,R,x,Ne,ce=te(t[6]),I=[];for(let o=0;o<ce.length;o+=1)I[o]=Je(Ge(t,ce,o));let ue=te(t[1]),w=[];for(let o=0;o<ue.length;o+=1)w[o]=We(xe(t,ue,o));let he=te(t[5]),L=[];for(let o=0;o<he.length;o+=1)L[o]=Ke(Re(t,he,o));let fe=te(t[2].slice(0,50).sort(Ze)),O=[];for(let o=0;o<fe.length;o+=1)O[o]=Xe(He(t,fe,o));let z=t[2].length>50&&Ye(t);return{c(){e=g("header"),l=g("div"),s=g("button"),s.textContent=c,u=F(),f=g("button"),f.textContent=_,i=F(),r=g("div"),A=g("div"),v=g("label"),v.textContent=q,D=F(),W=g("div");for(let o=0;o<I.length;o+=1)I[o].c();se=F(),j=g("div"),y=g("label"),ne=G("Values for "),ae=G(T),me=G(":"),ve=F(),K=g("div");for(let o=0;o<w.length;o+=1)w[o].c();ie=F(),X=g("div"),ee=g("label"),ee.textContent=Ee,ye=F(),Y=g("div");for(let o=0;o<L.length;o+=1)L[o].c();Ce=F(),U=g("div"),Z=g("label"),a=G("Filter "),V=G(p),Q=G(" By:"),H=F(),C=g("input"),P=F(),b=g("div");for(let o=0;o<O.length;o+=1)O[o].c();R=F(),z&&z.c(),this.h()},l(o){e=m(o,"HEADER",{class:!0});var S=E(e);l=m(S,"DIV",{class:!0});var n=E(l);s=m(n,"BUTTON",{class:!0,"data-svelte-h":!0}),be(s)!=="svelte-qy1k7w"&&(s.textContent=c),u=M(n),f=m(n,"BUTTON",{class:!0,"data-svelte-h":!0}),be(f)!=="svelte-18xqo2h"&&(f.textContent=_),n.forEach(d),i=M(S),r=m(S,"DIV",{class:!0});var B=E(r);A=m(B,"DIV",{class:!0});var Be=E(A);v=m(Be,"LABEL",{"data-svelte-h":!0}),be(v)!=="svelte-1ekr4iz"&&(v.textContent=q),D=M(Be),W=m(Be,"DIV",{class:!0});var Fe=E(W);for(let N=0;N<I.length;N+=1)I[N].l(Fe);Fe.forEach(d),Be.forEach(d),se=M(B),j=m(B,"DIV",{class:!0});var Ve=E(j);y=m(Ve,"LABEL",{});var Se=E(y);ne=J(Se,"Values for "),ae=J(Se,T),me=J(Se,":"),Se.forEach(d),ve=M(Ve),K=m(Ve,"DIV",{class:!0});var Me=E(K);for(let N=0;N<w.length;N+=1)w[N].l(Me);Me.forEach(d),Ve.forEach(d),ie=M(B),X=m(B,"DIV",{class:!0});var qe=E(X);ee=m(qe,"LABEL",{"data-svelte-h":!0}),be(ee)!=="svelte-8r6yw"&&(ee.textContent=Ee),ye=M(qe),Y=m(qe,"DIV",{class:!0});var je=E(Y);for(let N=0;N<L.length;N+=1)L[N].l(je);je.forEach(d),qe.forEach(d),Ce=M(B),U=m(B,"DIV",{class:!0});var de=E(U);Z=m(de,"LABEL",{});var Ie=E(Z);a=J(Ie,"Filter "),V=J(Ie,p),Q=J(Ie," By:"),Ie.forEach(d),H=M(de),C=m(de,"INPUT",{type:!0,placeholder:!0,class:!0}),P=M(de),b=m(de,"DIV",{class:!0});var we=E(b);for(let N=0;N<O.length;N+=1)O[N].l(we);R=M(we),z&&z.l(we),we.forEach(d),de.forEach(d),B.forEach(d),S.forEach(d),this.h()},h(){k(s,"class","reset svelte-hplaxf"),k(f,"class","copy-config svelte-hplaxf"),k(l,"class","header-buttons svelte-hplaxf"),k(W,"class","options svelte-hplaxf"),k(A,"class","category svelte-hplaxf"),k(K,"class","options tiny svelte-hplaxf"),k(j,"class","filtered-cluster-values svelte-hplaxf"),k(Y,"class","options svelte-hplaxf"),k(X,"class","category svelte-hplaxf"),k(C,"type","text"),k(C,"placeholder","Enter your query"),C.value=t[0],k(C,"class","svelte-hplaxf"),k(b,"class","options tiny svelte-hplaxf"),k(U,"class","filtered-entities svelte-hplaxf"),k(r,"class","categories svelte-hplaxf"),k(e,"class","svelte-hplaxf")},m(o,S){$(o,e,S),h(e,l),h(l,s),h(l,u),h(l,f),h(e,i),h(e,r),h(r,A),h(A,v),h(A,D),h(A,W);for(let n=0;n<I.length;n+=1)I[n]&&I[n].m(W,null);h(r,se),h(r,j),h(j,y),h(y,ne),h(y,ae),h(y,me),h(j,ve),h(j,K);for(let n=0;n<w.length;n+=1)w[n]&&w[n].m(K,null);h(r,ie),h(r,X),h(X,ee),h(X,ye),h(X,Y);for(let n=0;n<L.length;n+=1)L[n]&&L[n].m(Y,null);h(r,Ce),h(r,U),h(U,Z),h(Z,a),h(Z,V),h(Z,Q),h(U,H),h(U,C),h(U,P),h(U,b);for(let n=0;n<O.length;n+=1)O[n]&&O[n].m(b,null);h(b,R),z&&z.m(b,null),x||(Ne=[oe(s,"click",t[10]),oe(f,"click",t[11]),oe(C,"input",t[7])],x=!0)},p(o,S){if(S[0]&336){ce=te(o[6]);let n;for(n=0;n<ce.length;n+=1){const B=Ge(o,ce,n);I[n]?I[n].p(B,S):(I[n]=Je(B),I[n].c(),I[n].m(W,null))}for(;n<I.length;n+=1)I[n].d(1);I.length=ce.length}if(S[0]&16&&T!==(T=o[4].clusterBy+"")&&re(ae,T),S[0]&8722){ue=te(o[1]);let n;for(n=0;n<ue.length;n+=1){const B=xe(o,ue,n);w[n]?w[n].p(B,S):(w[n]=We(B),w[n].c(),w[n].m(K,null))}for(;n<w.length;n+=1)w[n].d(1);w.length=ue.length}if(S[0]&304){he=te(o[5]);let n;for(n=0;n<he.length;n+=1){const B=Re(o,he,n);L[n]?L[n].p(B,S):(L[n]=Ke(B),L[n].c(),L[n].m(Y,null))}for(;n<L.length;n+=1)L[n].d(1);L.length=he.length}if(S[0]&16&&p!==(p=o[4].moveBy+"")&&re(V,p),S[0]&1&&C.value!==o[0]&&(C.value=o[0]),S[0]&4108){fe=te(o[2].slice(0,50).sort(Ze));let n;for(n=0;n<fe.length;n+=1){const B=He(o,fe,n);O[n]?O[n].p(B,S):(O[n]=Xe(B),O[n].c(),O[n].m(b,R))}for(;n<O.length;n+=1)O[n].d(1);O.length=fe.length}o[2].length>50?z?z.p(o,S):(z=Ye(o),z.c(),z.m(b,null)):z&&(z.d(1),z=null)},i:ze,o:ze,d(o){o&&d(e),Le(I,o),Le(w,o),Le(L,o),Le(O,o),z&&z.d(),x=!1,rt(Ne)}}}const Ae=12,yt=30,De=12,Ct=30,Ze=([t],[e])=>t.localeCompare(e);function bt(t,e,l){let s,c,u,f,_,i,r,A,v,q,D,W,se,j,y,ne;ke(t,pe,a=>l(3,se=a)),ke(t,Qe,a=>l(18,j=a)),ke(t,_e,a=>l(4,y=a)),ke(t,ht,a=>l(19,ne=a));let T=y.queryValue||"";function ae(a){a.target.value.length>3&&(l(0,T=a.target.value),_e.update(p=>({...p,queryValue:T})))}const me=[],ve=[];function K(a,p){X(),pe.set([]),a==="clusterBy"?_e.update(V=>({...V,clusterBy:p})):a==="moveBy"&&_e.update(V=>({...V,moveBy:p}))}function ie(a){_e.update(H=>({...H,selectedClusterValue:a}));const p=T.toLowerCase(),V=y.queryCategory||"name",Q=[];Object.entries(Te(Qe)).forEach(([H,C])=>{const P=C.dataPoints.some(R=>{var x;return((x=R[y.clusterBy])==null?void 0:x.toString())===a.toString()}),b=C.dataPoints.some(R=>{var x;return(x=R[V])==null?void 0:x.toString().toLowerCase().includes(p)});P&&b&&(Q.push(H),C.currentCategoryIndex=0,C.t=0,C.trail=[])}),pe.set(Q)}function X(){_e.update(a=>({...a,queryValue:"",selectedClusterValue:null})),l(0,T=""),pe.set([])}function ee(){const a={title:"",description:"",methodology:"",media:!0,config:{clusterBy:y.clusterBy,moveBy:y.moveBy,selectedClusterValue:y.selectedClusterValue||"",queryValue:T,queryCategory:y.queryCategory||"name",speed:y.speed||3,stroke:y.stroke||1,loops:y.loopsToComplete||1,highlightedEntities:Te(pe)}},p=JSON.stringify(a,null,2);navigator.clipboard.writeText(p).then(()=>{alert("Config copied to clipboard!")}).catch(V=>{console.error("Could not copy text: ",V)})}function Ee(a){return r===A?Ae:Ae+(a-r)*(yt-Ae)/(A-r)}function ye(a){return D===W?De:De+(a-D)*(Ct-De)/(W-D)}const Y=a=>K("clusterBy",a),Ce=a=>ie(a),U=a=>K("moveBy",a),Z=a=>pe.set([a]);return t.$$.update=()=>{t.$$.dirty[0]&524288&&l(15,u=ne.map(([a])=>a)),t.$$.dirty[0]&262161&&l(17,f=Object.entries(j).filter(([a,p])=>{const V=y.selectedClusterValue?p.dataPoints.some(P=>{var b;return((b=P[y.clusterBy])==null?void 0:b.toString())===y.selectedClusterValue.toString()}):!0,Q=T.toLowerCase(),H=y.queryCategory||"name",C=Q.length>=3?p.dataPoints.some(P=>{var b;return(b=P[H])==null?void 0:b.toString().toLowerCase().includes(Q)}):!0;return V&&C}).reduce((a,[p,V])=>(a[p]=V,a),{})),t.$$.dirty[0]&131072&&l(2,_=Object.entries(f).map(([a,p])=>[a,p.dataPoints.length])),t.$$.dirty[0]&4&&l(16,i=_.map(([a,p])=>p)),t.$$.dirty[0]&65536&&(r=i.length>0?Math.min(...i):0),t.$$.dirty[0]&65536&&(A=i.length>0?Math.max(...i):1),t.$$.dirty[0]&294920&&l(1,v=(()=>{const a=Object.values(j),p=new Set(se),V=p.size>0;let Q=u;const H=[];V&&(Q=u.filter(C=>{for(let P=0;P<a.length;P++){const b=a[P];if(p.has(b.moveBy)&&b.categories.includes(C))return!0}return!1}));for(let C=0;C<Q.length;C++){const P=Q[C];let b=0;for(let R=0;R<a.length;R++){const x=a[R];(!V||p.has(x.moveBy))&&x.categories.includes(P)&&b++}H.push([P,b])}return H})()),t.$$.dirty[0]&2&&l(14,q=v.map(([a,p])=>p)),t.$$.dirty[0]&16384&&(D=q.length>0?Math.min(...q):0),t.$$.dirty[0]&16384&&(W=q.length>0?Math.max(...q):1)},l(6,s=gt.filter(a=>!me.includes(a))),l(5,c=mt.filter(a=>!ve.includes(a))),[T,v,_,se,y,c,s,ae,K,ie,X,ee,Ee,ye,q,u,i,f,j,ne,Y,Ce,U,Z]}class kt extends et{constructor(e){super(),tt(this,e,bt,vt,$e,{},null,[-1,-1])}}function Et(t){let e,l="Loading...";return{c(){e=g("p"),e.textContent=l,this.h()},l(s){e=m(s,"P",{class:!0,"data-svelte-h":!0}),be(e)!=="svelte-qdsr2u"&&(e.textContent=l),this.h()},h(){k(e,"class","svelte-13tgnqv")},m(s,c){$(s,e,c)},i:ze,o:ze,d(s){s&&d(e)}}}function Bt(t){let e,l,s;return l=new _t({}),{c(){e=g("div"),lt(l.$$.fragment),this.h()},l(c){e=m(c,"DIV",{class:!0});var u=E(e);st(l.$$.fragment,u),u.forEach(d),this.h()},h(){k(e,"class","svelte-13tgnqv")},m(c,u){$(c,e,u),nt(l,e,null),s=!0},i(c){s||(Pe(l.$$.fragment,c),s=!0)},o(c){Oe(l.$$.fragment,c),s=!1},d(c){c&&d(e),ot(l)}}}function Vt(t){let e,l,s,c,u,f,_;const i=[Bt,Et],r=[];function A(v,q){return v[0].length>0?0:1}return l=A(t),s=r[l]=i[l](t),f=new kt({}),{c(){e=g("main"),s.c(),c=F(),u=g("div"),lt(f.$$.fragment),this.h()},l(v){e=m(v,"MAIN",{});var q=E(e);s.l(q),c=M(q),u=m(q,"DIV",{class:!0});var D=E(u);st(f.$$.fragment,D),D.forEach(d),q.forEach(d),this.h()},h(){k(u,"class","svelte-13tgnqv")},m(v,q){$(v,e,q),r[l].m(e,null),h(e,c),h(e,u),nt(f,u,null),_=!0},p(v,[q]){let D=l;l=A(v),l!==D&&(ct(),Oe(r[D],1,1,()=>{r[D]=null}),it(),s=r[l],s||(s=r[l]=i[l](v),s.c()),Pe(s,1),s.m(e,c))},i(v){_||(Pe(s),Pe(f.$$.fragment,v),_=!0)},o(v){Oe(s),Oe(f.$$.fragment,v),_=!1},d(v){v&&d(e),r[l].d(),ot(f)}}}function St(t,e,l){let s;return ke(t,Ue,c=>l(0,s=c)),at(async()=>{const u=(await pt(ut+"/data/update-until-2022/data.tsv")).map(f=>{const _={};for(const[i,r]of Object.entries(f))_[i]=r!=null&&r.trim()?r:"?";return _});Ue.set(u),ft.set(window.innerWidth),dt.set(600)}),[s]}class At extends et{constructor(e){super(),tt(this,e,St,Vt,$e,{})}}export{At as component};
