import{s as xe,e as p,a as N,t as J,c as v,b as E,l as Ce,g as M,f as d,d as W,m,i as ee,h,E as oe,j as re,n as ze,B as Le,F as rt,k as ke,G as le,r as me,I as Te,q as it}from"../chunks/scheduler.evRM0l9T.js";import{S as et,i as tt,b as lt,d as st,m as nt,t as Oe,c as at,a as Pe,e as ot,g as ct}from"../chunks/index.aiZKxZDj.js";import{b as ut}from"../chunks/paths.Dc8V-wAq.js";import{h as ge,e as Qe,c as _e,b as ht,d as Ue,w as ft,a as dt}from"../chunks/stores.D9mTdjSf.js";import{t as gt,S as _t}from"../chunks/dsv.BiChMoXn.js";import{e as te}from"../chunks/each.D6YF6ztN.js";import{f as mt,a as pt}from"../chunks/constants.CA4Cg4R8.js";function He(t,e,l){const s=t.slice();return s[30]=e[l][0],s[31]=e[l][1],s}function Re(t,e,l){const s=t.slice();return s[34]=e[l],s}function Ge(t,e,l){const s=t.slice();return s[31]=e[l][0],s[37]=e[l][1],s}function Je(t,e,l){const s=t.slice();return s[34]=e[l],s}function We(t){let e,l=t[34]+"",s,c,u,f;function _(){return t[20](t[34])}return{c(){e=p("span"),s=J(l),c=N(),this.h()},l(a){e=v(a,"SPAN",{class:!0});var r=E(e);s=W(r,l),c=M(r),r.forEach(d),this.h()},h(){m(e,"class","svelte-gomhbg"),le(e,"selected",t[34]===t[4].clusterBy)},m(a,r){ee(a,e,r),h(e,s),h(e,c),u||(f=oe(e,"click",_),u=!0)},p(a,r){t=a,r[0]&64&&l!==(l=t[34]+"")&&re(s,l),r[0]&80&&le(e,"selected",t[34]===t[4].clusterBy)},d(a){a&&d(e),u=!1,f()}}}function Ke(t){let e,l=t[31]+"",s,c,u,f;function _(){return t[21](t[31])}return{c(){e=p("span"),s=J(l),c=N(),this.h()},l(a){e=v(a,"SPAN",{style:!0,class:!0});var r=E(e);s=W(r,l),c=M(r),r.forEach(d),this.h()},h(){me(e,"font-size",t[13](t[37])+"px"),m(e,"class","svelte-gomhbg"),le(e,"highlighted",t[31]==t[4].selectedClusterValue)},m(a,r){ee(a,e,r),h(e,s),h(e,c),u||(f=oe(e,"click",_),u=!0)},p(a,r){t=a,r[0]&2&&l!==(l=t[31]+"")&&re(s,l),r[0]&2&&me(e,"font-size",t[13](t[37])+"px"),r[0]&18&&le(e,"highlighted",t[31]==t[4].selectedClusterValue)},d(a){a&&d(e),u=!1,f()}}}function Xe(t){let e,l=t[34]+"",s,c,u,f;function _(){return t[22](t[34])}return{c(){e=p("span"),s=J(l),c=N(),this.h()},l(a){e=v(a,"SPAN",{class:!0});var r=E(e);s=W(r,l),c=M(r),r.forEach(d),this.h()},h(){m(e,"class","svelte-gomhbg"),le(e,"selected",t[34]===t[4].moveBy)},m(a,r){ee(a,e,r),h(e,s),h(e,c),u||(f=oe(e,"click",_),u=!0)},p(a,r){t=a,r[0]&32&&l!==(l=t[34]+"")&&re(s,l),r[0]&48&&le(e,"selected",t[34]===t[4].moveBy)},d(a){a&&d(e),u=!1,f()}}}function Ye(t){let e,l=t[30]+"",s,c,u;function f(){return t[23](t[30])}return{c(){e=p("span"),s=J(l),this.h()},l(_){e=v(_,"SPAN",{style:!0,class:!0});var a=E(e);s=W(a,l),a.forEach(d),this.h()},h(){me(e,"font-size",t[12](t[31])+"px"),m(e,"class","svelte-gomhbg"),le(e,"highlighted",t[3].includes(t[30]))},m(_,a){ee(_,e,a),h(e,s),c||(u=oe(e,"click",f),c=!0)},p(_,a){t=_,a[0]&4&&l!==(l=t[30]+"")&&re(s,l),a[0]&4&&me(e,"font-size",t[12](t[31])+"px"),a[0]&12&&le(e,"highlighted",t[3].includes(t[30]))},d(_){_&&d(e),c=!1,u()}}}function Ze(t){let e,l,s=t[2].length+"",c;return{c(){e=p("p"),l=J("50 out of "),c=J(s),this.h()},l(u){e=v(u,"P",{style:!0});var f=E(e);l=W(f,"50 out of "),c=W(f,s),f.forEach(d),this.h()},h(){me(e,"border-top","1px solid"),me(e,"padding-top","10px")},m(u,f){ee(u,e,f),h(e,l),h(e,c)},p(u,f){f[0]&4&&s!==(s=u[2].length+"")&&re(c,s)},d(u){u&&d(e)}}}function vt(t){let e,l,s,c="Reset",u,f,_="Copy Config",a,r,A,b,q="Cluster By:",D,K,se,j,y,ne,T=t[4].clusterBy+"",ie,pe,ve,X,ae,Y,$,Ee="Move By:",be,x,ye,U,Z,i,g=t[4].moveBy+"",V,Q,H,C,P,k,R,G,Fe,ce=te(t[6]),I=[];for(let o=0;o<ce.length;o+=1)I[o]=We(Je(t,ce,o));let ue=te(t[1]),w=[];for(let o=0;o<ue.length;o+=1)w[o]=Ke(Ge(t,ue,o));let he=te(t[5]),L=[];for(let o=0;o<he.length;o+=1)L[o]=Xe(Re(t,he,o));let fe=te(t[2].slice(0,50).sort($e)),O=[];for(let o=0;o<fe.length;o+=1)O[o]=Ye(He(t,fe,o));let z=t[2].length>50&&Ze(t);return{c(){e=p("header"),l=p("div"),s=p("button"),s.textContent=c,u=N(),f=p("button"),f.textContent=_,a=N(),r=p("div"),A=p("div"),b=p("label"),b.textContent=q,D=N(),K=p("div");for(let o=0;o<I.length;o+=1)I[o].c();se=N(),j=p("div"),y=p("label"),ne=J("Filter "),ie=J(T),pe=J(":"),ve=N(),X=p("div");for(let o=0;o<w.length;o+=1)w[o].c();ae=N(),Y=p("div"),$=p("label"),$.textContent=Ee,be=N(),x=p("div");for(let o=0;o<L.length;o+=1)L[o].c();ye=N(),U=p("div"),Z=p("label"),i=J("Filter "),V=J(g),Q=J(":"),H=N(),C=p("input"),P=N(),k=p("div");for(let o=0;o<O.length;o+=1)O[o].c();R=N(),z&&z.c(),this.h()},l(o){e=v(o,"HEADER",{class:!0});var S=E(e);l=v(S,"DIV",{class:!0});var n=E(l);s=v(n,"BUTTON",{class:!0,"data-svelte-h":!0}),Ce(s)!=="svelte-qy1k7w"&&(s.textContent=c),u=M(n),f=v(n,"BUTTON",{class:!0,"data-svelte-h":!0}),Ce(f)!=="svelte-18xqo2h"&&(f.textContent=_),n.forEach(d),a=M(S),r=v(S,"DIV",{class:!0});var B=E(r);A=v(B,"DIV",{class:!0});var Be=E(A);b=v(Be,"LABEL",{class:!0,"data-svelte-h":!0}),Ce(b)!=="svelte-1ekr4iz"&&(b.textContent=q),D=M(Be),K=v(Be,"DIV",{class:!0});var Ne=E(K);for(let F=0;F<I.length;F+=1)I[F].l(Ne);Ne.forEach(d),Be.forEach(d),se=M(B),j=v(B,"DIV",{class:!0});var Ve=E(j);y=v(Ve,"LABEL",{class:!0});var Se=E(y);ne=W(Se,"Filter "),ie=W(Se,T),pe=W(Se,":"),Se.forEach(d),ve=M(Ve),X=v(Ve,"DIV",{class:!0});var Me=E(X);for(let F=0;F<w.length;F+=1)w[F].l(Me);Me.forEach(d),Ve.forEach(d),ae=M(B),Y=v(B,"DIV",{class:!0});var qe=E(Y);$=v(qe,"LABEL",{class:!0,"data-svelte-h":!0}),Ce($)!=="svelte-8r6yw"&&($.textContent=Ee),be=M(qe),x=v(qe,"DIV",{class:!0});var je=E(x);for(let F=0;F<L.length;F+=1)L[F].l(je);je.forEach(d),qe.forEach(d),ye=M(B),U=v(B,"DIV",{class:!0});var de=E(U);Z=v(de,"LABEL",{class:!0});var Ie=E(Z);i=W(Ie,"Filter "),V=W(Ie,g),Q=W(Ie,":"),Ie.forEach(d),H=M(de),C=v(de,"INPUT",{type:!0,placeholder:!0,class:!0}),P=M(de),k=v(de,"DIV",{class:!0});var we=E(k);for(let F=0;F<O.length;F+=1)O[F].l(we);R=M(we),z&&z.l(we),we.forEach(d),de.forEach(d),B.forEach(d),S.forEach(d),this.h()},h(){m(s,"class","reset svelte-gomhbg"),m(f,"class","copy-config svelte-gomhbg"),m(l,"class","header-buttons svelte-gomhbg"),m(b,"class","svelte-gomhbg"),m(K,"class","options svelte-gomhbg"),m(A,"class","category svelte-gomhbg"),m(y,"class","svelte-gomhbg"),m(X,"class","options tiny svelte-gomhbg"),m(j,"class","filtered-cluster-values svelte-gomhbg"),m($,"class","svelte-gomhbg"),m(x,"class","options svelte-gomhbg"),m(Y,"class","category svelte-gomhbg"),m(Z,"class","svelte-gomhbg"),m(C,"type","text"),m(C,"placeholder","Enter your query"),C.value=t[0],m(C,"class","svelte-gomhbg"),m(k,"class","options tiny svelte-gomhbg"),m(U,"class","filtered-entities svelte-gomhbg"),m(r,"class","categories svelte-gomhbg"),m(e,"class","svelte-gomhbg")},m(o,S){ee(o,e,S),h(e,l),h(l,s),h(l,u),h(l,f),h(e,a),h(e,r),h(r,A),h(A,b),h(A,D),h(A,K);for(let n=0;n<I.length;n+=1)I[n]&&I[n].m(K,null);h(r,se),h(r,j),h(j,y),h(y,ne),h(y,ie),h(y,pe),h(j,ve),h(j,X);for(let n=0;n<w.length;n+=1)w[n]&&w[n].m(X,null);h(r,ae),h(r,Y),h(Y,$),h(Y,be),h(Y,x);for(let n=0;n<L.length;n+=1)L[n]&&L[n].m(x,null);h(r,ye),h(r,U),h(U,Z),h(Z,i),h(Z,V),h(Z,Q),h(U,H),h(U,C),h(U,P),h(U,k);for(let n=0;n<O.length;n+=1)O[n]&&O[n].m(k,null);h(k,R),z&&z.m(k,null),G||(Fe=[oe(s,"click",t[10]),oe(f,"click",t[11]),oe(C,"input",t[7])],G=!0)},p(o,S){if(S[0]&336){ce=te(o[6]);let n;for(n=0;n<ce.length;n+=1){const B=Je(o,ce,n);I[n]?I[n].p(B,S):(I[n]=We(B),I[n].c(),I[n].m(K,null))}for(;n<I.length;n+=1)I[n].d(1);I.length=ce.length}if(S[0]&16&&T!==(T=o[4].clusterBy+"")&&re(ie,T),S[0]&8722){ue=te(o[1]);let n;for(n=0;n<ue.length;n+=1){const B=Ge(o,ue,n);w[n]?w[n].p(B,S):(w[n]=Ke(B),w[n].c(),w[n].m(X,null))}for(;n<w.length;n+=1)w[n].d(1);w.length=ue.length}if(S[0]&304){he=te(o[5]);let n;for(n=0;n<he.length;n+=1){const B=Re(o,he,n);L[n]?L[n].p(B,S):(L[n]=Xe(B),L[n].c(),L[n].m(x,null))}for(;n<L.length;n+=1)L[n].d(1);L.length=he.length}if(S[0]&16&&g!==(g=o[4].moveBy+"")&&re(V,g),S[0]&1&&C.value!==o[0]&&(C.value=o[0]),S[0]&4108){fe=te(o[2].slice(0,50).sort($e));let n;for(n=0;n<fe.length;n+=1){const B=He(o,fe,n);O[n]?O[n].p(B,S):(O[n]=Ye(B),O[n].c(),O[n].m(k,R))}for(;n<O.length;n+=1)O[n].d(1);O.length=fe.length}o[2].length>50?z?z.p(o,S):(z=Ze(o),z.c(),z.m(k,null)):z&&(z.d(1),z=null)},i:ze,o:ze,d(o){o&&d(e),Le(I,o),Le(w,o),Le(L,o),Le(O,o),z&&z.d(),G=!1,rt(Fe)}}}const Ae=12,bt=30,De=12,yt=30,$e=([t],[e])=>t.localeCompare(e);function Ct(t,e,l){let s,c,u,f,_,a,r,A,b,q,D,K,se,j,y,ne;ke(t,ge,i=>l(3,se=i)),ke(t,Qe,i=>l(18,j=i)),ke(t,_e,i=>l(4,y=i)),ke(t,ht,i=>l(19,ne=i));let T=y.queryValue||"";function ie(i){i.target.value.length>3&&(l(0,T=i.target.value),_e.update(g=>({...g,queryValue:T})))}const pe=[],ve=[];function X(i,g){Y(),ge.set([]),i==="clusterBy"?_e.update(V=>({...V,clusterBy:g})):i==="moveBy"&&_e.update(V=>({...V,moveBy:g}))}function ae(i){_e.update(H=>({...H,selectedClusterValue:i}));const g=T.toLowerCase(),V=y.queryCategory||"name",Q=[];Object.entries(Te(Qe)).forEach(([H,C])=>{const P=C.dataPoints.some(R=>{var G;return((G=R[y.clusterBy])==null?void 0:G.toString())===i.toString()}),k=C.dataPoints.some(R=>{var G;return(G=R[V])==null?void 0:G.toString().toLowerCase().includes(g)});P&&k&&(Q.push(H),C.currentCategoryIndex=0,C.t=0,C.trail=[])}),ge.set(Q)}function Y(){_e.update(i=>({...i,queryValue:"",selectedClusterValue:null})),l(0,T=""),ge.set([])}function $(){const i={title:"",description:"",methodology:"",media:!0,config:{clusterBy:y.clusterBy,moveBy:y.moveBy,selectedClusterValue:y.selectedClusterValue||"",queryValue:T,queryCategory:y.queryCategory||"name",speed:y.speed||3,stroke:y.stroke||1,loops:y.loopsToComplete||1,highlightedEntities:Te(ge)}},g=JSON.stringify(i,null,2);navigator.clipboard.writeText(g).then(()=>{alert("Config copied to clipboard!")}).catch(V=>{console.error("Could not copy text: ",V)})}function Ee(i){return r===A?Ae:Ae+(i-r)*(bt-Ae)/(A-r)}function be(i){return D===K?De:De+(i-D)*(yt-De)/(K-D)}const x=i=>X("clusterBy",i),ye=i=>ae(i),U=i=>X("moveBy",i),Z=i=>ge.set([i]);return t.$$.update=()=>{t.$$.dirty[0]&524288&&l(15,u=ne.map(([i])=>i)),t.$$.dirty[0]&262161&&l(17,f=Object.entries(j).filter(([i,g])=>{const V=y.selectedClusterValue?g.dataPoints.some(P=>{var k;return((k=P[y.clusterBy])==null?void 0:k.toString())===y.selectedClusterValue.toString()}):!0,Q=T.toLowerCase(),H=y.queryCategory||"name",C=Q.length>=3?g.dataPoints.some(P=>{var k;return(k=P[H])==null?void 0:k.toString().toLowerCase().includes(Q)}):!0;return V&&C}).reduce((i,[g,V])=>(i[g]=V,i),{})),t.$$.dirty[0]&131072&&l(2,_=Object.entries(f).map(([i,g])=>[i,g.dataPoints.length])),t.$$.dirty[0]&4&&l(16,a=_.map(([i,g])=>g)),t.$$.dirty[0]&65536&&(r=a.length>0?Math.min(...a):0),t.$$.dirty[0]&65536&&(A=a.length>0?Math.max(...a):1),t.$$.dirty[0]&294920&&l(1,b=(()=>{const i=Object.values(j),g=new Set(se),V=g.size>0;let Q=u;const H=[];V&&(Q=u.filter(C=>{for(let P=0;P<i.length;P++){const k=i[P];if(g.has(k.moveBy)&&k.categories.includes(C))return!0}return!1}));for(let C=0;C<Q.length;C++){const P=Q[C];let k=0;for(let R=0;R<i.length;R++){const G=i[R];(!V||g.has(G.moveBy))&&G.categories.includes(P)&&k++}H.push([P,k])}return H})()),t.$$.dirty[0]&2&&l(14,q=b.map(([i,g])=>g)),t.$$.dirty[0]&16384&&(D=q.length>0?Math.min(...q):0),t.$$.dirty[0]&16384&&(K=q.length>0?Math.max(...q):1)},l(6,s=mt.filter(i=>!pe.includes(i))),l(5,c=pt.filter(i=>!ve.includes(i))),[T,b,_,se,y,c,s,ie,X,ae,Y,$,Ee,be,q,u,a,f,j,ne,x,ye,U,Z]}class kt extends et{constructor(e){super(),tt(this,e,Ct,vt,xe,{},null,[-1,-1])}}function Et(t){let e,l="Loading...";return{c(){e=p("p"),e.textContent=l,this.h()},l(s){e=v(s,"P",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-qdsr2u"&&(e.textContent=l),this.h()},h(){m(e,"class","svelte-13tgnqv")},m(s,c){ee(s,e,c)},i:ze,o:ze,d(s){s&&d(e)}}}function Bt(t){let e,l,s;return l=new _t({}),{c(){e=p("div"),lt(l.$$.fragment),this.h()},l(c){e=v(c,"DIV",{class:!0});var u=E(e);st(l.$$.fragment,u),u.forEach(d),this.h()},h(){m(e,"class","svelte-13tgnqv")},m(c,u){ee(c,e,u),nt(l,e,null),s=!0},i(c){s||(Pe(l.$$.fragment,c),s=!0)},o(c){Oe(l.$$.fragment,c),s=!1},d(c){c&&d(e),ot(l)}}}function Vt(t){let e,l,s,c,u,f,_;const a=[Bt,Et],r=[];function A(b,q){return b[0].length>0?0:1}return l=A(t),s=r[l]=a[l](t),f=new kt({}),{c(){e=p("main"),s.c(),c=N(),u=p("div"),lt(f.$$.fragment),this.h()},l(b){e=v(b,"MAIN",{});var q=E(e);s.l(q),c=M(q),u=v(q,"DIV",{class:!0});var D=E(u);st(f.$$.fragment,D),D.forEach(d),q.forEach(d),this.h()},h(){m(u,"class","svelte-13tgnqv")},m(b,q){ee(b,e,q),r[l].m(e,null),h(e,c),h(e,u),nt(f,u,null),_=!0},p(b,[q]){let D=l;l=A(b),l!==D&&(ct(),Oe(r[D],1,1,()=>{r[D]=null}),at(),s=r[l],s||(s=r[l]=a[l](b),s.c()),Pe(s,1),s.m(e,c))},i(b){_||(Pe(s),Pe(f.$$.fragment,b),_=!0)},o(b){Oe(s),Oe(f.$$.fragment,b),_=!1},d(b){b&&d(e),r[l].d(),ot(f)}}}function St(t,e,l){let s;return ke(t,Ue,c=>l(0,s=c)),it(async()=>{const u=(await gt(ut+"/data/update-until-2022/data.tsv")).map(f=>{const _={};for(const[a,r]of Object.entries(f))_[a]=r!=null&&r.trim()?r:"?";return _});Ue.set(u),ft.set(window.innerWidth),dt.set(600)}),[s]}class At extends et{constructor(e){super(),tt(this,e,St,Vt,xe,{})}}export{At as component};
