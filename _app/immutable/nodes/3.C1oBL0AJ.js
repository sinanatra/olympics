import{s as He,e as g,t as J,a as L,c as y,b as E,d as G,f as v,g as A,l as qe,m,i as Y,h as f,E as se,j as ne,n as Fe,B as Be,F as xe,k as Se,G as et,I as ce,r as ue,J as tt,q as lt}from"../chunks/scheduler.B6iofcAQ.js";import{S as Ke,i as We,b as Xe,d as Ye,m as Ze,t as we,c as st,a as Ie,e as $e,g as nt}from"../chunks/index.DcOQwsS0.js";import{b as rt}from"../chunks/paths.B32r9G3u.js";import{c as le,h as me,e as at,d as je,w as it,a as ot}from"../chunks/stores.HNDzHde5.js";import{t as ct,S as ut}from"../chunks/dsv.BEifjoE_.js";import{e as x}from"../chunks/each.D6YF6ztN.js";import{f as ht}from"../chunks/constants.BVuMyF_R.js";function Ne(t,e,l){const n=t.slice();return n[31]=e[l][0],n[32]=e[l][1],n}function Le(t,e,l){const n=t.slice();return n[32]=e[l][0],n[35]=e[l][1],n}function Ae(t,e,l){const n=t.slice();return n[38]=e[l],n}function Te(t,e,l){const n=t.slice();return n[41]=e[l],n}function Me(t){let e,l=t[41].label+"",n;return{c(){e=g("span"),n=J(l),this.h()},l(i){e=y(i,"SPAN",{class:!0});var o=E(e);n=G(o,l),o.forEach(v),this.h()},h(){m(e,"class","filter svelte-1ahhu9d")},m(i,o){Y(i,e,o),f(e,n)},p(i,o){o[0]&4&&l!==(l=i[41].label+"")&&ne(n,l)},d(i){i&&v(e)}}}function Qe(t){let e,l=t[38]+"",n,i,o,d;function _(){return t[20](t[38])}return{c(){e=g("span"),n=J(l),i=L(),this.h()},l(u){e=y(u,"SPAN",{class:!0});var c=E(e);n=G(c,l),i=A(c),c.forEach(v),this.h()},h(){m(e,"class","svelte-1ahhu9d"),ce(e,"selected",t[38]===t[3].clusterBy)},m(u,c){Y(u,e,c),f(e,n),f(e,i),o||(d=se(e,"click",_),o=!0)},p(u,c){t=u,c[0]&128&&l!==(l=t[38]+"")&&ne(n,l),c[0]&136&&ce(e,"selected",t[38]===t[3].clusterBy)},d(u){u&&v(e),o=!1,d()}}}function Re(t){let e,l=t[32]+"",n,i,o,d;function _(){return t[21](t[32])}return{c(){e=g("span"),n=J(l),i=L(),this.h()},l(u){e=y(u,"SPAN",{style:!0,class:!0});var c=E(e);n=G(c,l),i=A(c),c.forEach(v),this.h()},h(){var u;ue(e,"font-size",t[14](t[35])+"px"),m(e,"class","svelte-1ahhu9d"),ce(e,"selected",((u=t[3].filters[t[3].clusterBy])==null?void 0:u[0])===t[32])},m(u,c){Y(u,e,c),f(e,n),f(e,i),o||(d=se(e,"click",_),o=!0)},p(u,c){var T;t=u,c[0]&1&&l!==(l=t[32]+"")&&ne(n,l),c[0]&1&&ue(e,"font-size",t[14](t[35])+"px"),c[0]&9&&ce(e,"selected",((T=t[3].filters[t[3].clusterBy])==null?void 0:T[0])===t[32])},d(u){u&&v(e),o=!1,d()}}}function Ue(t){let e,l=t[31]+"",n,i,o;function d(){return t[22](t[31])}return{c(){e=g("span"),n=J(l),this.h()},l(_){e=y(_,"SPAN",{style:!0,class:!0});var u=E(e);n=G(u,l),u.forEach(v),this.h()},h(){ue(e,"font-size",t[13](t[32])+"px"),m(e,"class","svelte-1ahhu9d"),ce(e,"highlighted",t[4].includes(t[31]))},m(_,u){Y(_,e,u),f(e,n),i||(o=se(e,"click",d),i=!0)},p(_,u){t=_,u[0]&2&&l!==(l=t[31]+"")&&ne(n,l),u[0]&2&&ue(e,"font-size",t[13](t[32])+"px"),u[0]&18&&ce(e,"highlighted",t[4].includes(t[31]))},d(_){_&&v(e),i=!1,o()}}}function Je(t){let e,l,n=t[1].length+"",i;return{c(){e=g("p"),l=J("50 out of "),i=J(n),this.h()},l(o){e=y(o,"P",{style:!0});var d=E(e);l=G(d,"50 out of "),i=G(d,n),d.forEach(v),this.h()},h(){ue(e,"border-top","1px solid"),ue(e,"padding-top","10px")},m(o,d){Y(o,e,d),f(e,l),f(e,i)},p(o,d){d[0]&2&&n!==(n=o[1].length+"")&&ne(i,n)},d(o){o&&v(e)}}}function ft(t){let e,l,n,i,o,d,_,u,c,T="Reset",k,C,D="Copy Config",ee,N,p,F,Z="Cluster By:",H,K,he,M,Q,fe,te=t[3].clusterBy+"",re,de,_e,W,pe,r,h,b,V,z,R,$,ve,U=x(t[2]),q=[];for(let a=0;a<U.length;a+=1)q[a]=Me(Te(t,U,a));let X=x(t[7]),S=[];for(let a=0;a<X.length;a+=1)S[a]=Qe(Ae(t,X,a));let ae=x(t[0]),w=[];for(let a=0;a<ae.length;a+=1)w[a]=Re(Le(t,ae,a));let ie=x(t[1].slice(0,50).sort(Ge)),I=[];for(let a=0;a<ie.length;a+=1)I[a]=Ue(Ne(t,ie,a));let O=t[1].length>50&&Je(t);return{c(){e=g("header"),l=g("div"),n=g("div"),i=J(t[6]),o=L(),d=g("div"),_=g("div");for(let a=0;a<q.length;a+=1)q[a].c();u=L(),c=g("button"),c.textContent=T,k=L(),C=g("button"),C.textContent=D,ee=L(),N=g("div"),p=g("div"),F=g("label"),F.textContent=Z,H=L(),K=g("div");for(let a=0;a<S.length;a+=1)S[a].c();he=L(),M=g("div"),Q=g("label"),fe=J("Filter "),re=J(te),de=J(":"),_e=L(),W=g("div");for(let a=0;a<w.length;a+=1)w[a].c();pe=L(),r=g("div"),h=g("input"),V=L(),z=g("div");for(let a=0;a<I.length;a+=1)I[a].c();R=L(),O&&O.c(),this.h()},l(a){e=y(a,"HEADER",{class:!0});var B=E(e);l=y(B,"DIV",{class:!0});var s=E(l);n=y(s,"DIV",{class:!0});var j=E(n);i=G(j,t[6]),j.forEach(v),o=A(s),d=y(s,"DIV",{class:!0});var ge=E(d);_=y(ge,"DIV",{class:!0});var ye=E(_);for(let P=0;P<q.length;P+=1)q[P].l(ye);u=A(ye),c=y(ye,"BUTTON",{class:!0,"data-svelte-h":!0}),qe(c)!=="svelte-qy1k7w"&&(c.textContent=T),ye.forEach(v),k=A(ge),C=y(ge,"BUTTON",{class:!0,"data-svelte-h":!0}),qe(C)!=="svelte-i2notl"&&(C.textContent=D),ge.forEach(v),s.forEach(v),ee=A(B),N=y(B,"DIV",{class:!0});var oe=E(N);p=y(oe,"DIV",{class:!0});var be=E(p);F=y(be,"LABEL",{class:!0,"data-svelte-h":!0}),qe(F)!=="svelte-1ekr4iz"&&(F.textContent=Z),H=A(be),K=y(be,"DIV",{class:!0});var De=E(K);for(let P=0;P<S.length;P+=1)S[P].l(De);De.forEach(v),be.forEach(v),he=A(oe),M=y(oe,"DIV",{class:!0});var Ce=E(M);Q=y(Ce,"LABEL",{class:!0});var ke=E(Q);fe=G(ke,"Filter "),re=G(ke,te),de=G(ke,":"),ke.forEach(v),_e=A(Ce),W=y(Ce,"DIV",{class:!0});var ze=E(W);for(let P=0;P<w.length;P+=1)w[P].l(ze);ze.forEach(v),Ce.forEach(v),pe=A(oe),r=y(oe,"DIV",{class:!0});var Ee=E(r);h=y(Ee,"INPUT",{type:!0,placeholder:!0,class:!0}),V=A(Ee),z=y(Ee,"DIV",{class:!0});var Ve=E(z);for(let P=0;P<I.length;P+=1)I[P].l(Ve);R=A(Ve),O&&O.l(Ve),Ve.forEach(v),Ee.forEach(v),oe.forEach(v),B.forEach(v),this.h()},h(){m(n,"class","methodology svelte-1ahhu9d"),m(c,"class","reset svelte-1ahhu9d"),m(_,"class","active-filters svelte-1ahhu9d"),m(C,"class","copy-config svelte-1ahhu9d"),m(d,"class","header-buttons svelte-1ahhu9d"),m(l,"class","header-info svelte-1ahhu9d"),m(F,"class","svelte-1ahhu9d"),m(K,"class","options svelte-1ahhu9d"),m(p,"class","category svelte-1ahhu9d"),m(Q,"class","svelte-1ahhu9d"),m(W,"class","options tiny svelte-1ahhu9d"),m(M,"class","filtered-cluster-values svelte-1ahhu9d"),m(h,"type","text"),m(h,"placeholder",b="Filter "+t[3].moveBy+"..."),h.value=t[5],m(h,"class","svelte-1ahhu9d"),m(z,"class","options tiny svelte-1ahhu9d"),m(r,"class","filtered-entities svelte-1ahhu9d"),m(N,"class","categories svelte-1ahhu9d"),m(e,"class","svelte-1ahhu9d")},m(a,B){Y(a,e,B),f(e,l),f(l,n),f(n,i),f(l,o),f(l,d),f(d,_);for(let s=0;s<q.length;s+=1)q[s]&&q[s].m(_,null);f(_,u),f(_,c),f(d,k),f(d,C),f(e,ee),f(e,N),f(N,p),f(p,F),f(p,H),f(p,K);for(let s=0;s<S.length;s+=1)S[s]&&S[s].m(K,null);f(N,he),f(N,M),f(M,Q),f(Q,fe),f(Q,re),f(Q,de),f(M,_e),f(M,W);for(let s=0;s<w.length;s+=1)w[s]&&w[s].m(W,null);f(N,pe),f(N,r),f(r,h),f(r,V),f(r,z);for(let s=0;s<I.length;s+=1)I[s]&&I[s].m(z,null);f(z,R),O&&O.m(z,null),$||(ve=[se(c,"click",t[11]),se(_,"click",t[11]),se(C,"click",t[12]),se(h,"input",t[8])],$=!0)},p(a,B){if(B[0]&64&&ne(i,a[6]),B[0]&4){U=x(a[2]);let s;for(s=0;s<U.length;s+=1){const j=Te(a,U,s);q[s]?q[s].p(j,B):(q[s]=Me(j),q[s].c(),q[s].m(_,u))}for(;s<q.length;s+=1)q[s].d(1);q.length=U.length}if(B[0]&648){X=x(a[7]);let s;for(s=0;s<X.length;s+=1){const j=Ae(a,X,s);S[s]?S[s].p(j,B):(S[s]=Qe(j),S[s].c(),S[s].m(K,null))}for(;s<S.length;s+=1)S[s].d(1);S.length=X.length}if(B[0]&8&&te!==(te=a[3].clusterBy+"")&&ne(re,te),B[0]&17417){ae=x(a[0]);let s;for(s=0;s<ae.length;s+=1){const j=Le(a,ae,s);w[s]?w[s].p(j,B):(w[s]=Re(j),w[s].c(),w[s].m(W,null))}for(;s<w.length;s+=1)w[s].d(1);w.length=ae.length}if(B[0]&8&&b!==(b="Filter "+a[3].moveBy+"...")&&m(h,"placeholder",b),B[0]&32&&h.value!==a[5]&&(h.value=a[5]),B[0]&8210){ie=x(a[1].slice(0,50).sort(Ge));let s;for(s=0;s<ie.length;s+=1){const j=Ne(a,ie,s);I[s]?I[s].p(j,B):(I[s]=Ue(j),I[s].c(),I[s].m(z,R))}for(;s<I.length;s+=1)I[s].d(1);I.length=ie.length}a[1].length>50?O?O.p(a,B):(O=Je(a),O.c(),O.m(z,null)):O&&(O.d(1),O=null)},i:Fe,o:Fe,d(a){a&&v(e),Be(q,a),Be(S,a),Be(w,a),Be(I,a),O&&O.d(),$=!1,xe(ve)}}}const Oe=12,dt=30,Pe=12,_t=30;function pt(t,e){const l={city:"cities",sport:"sports",height:"heights",noc:"NOCs",team:"teams",weight:"weights",year:"years",age:"ages",event:"events",medal:"medals",name:"names"};return t===1?e:l[e]||`${e}s`}function vt(t){return t.clusterBy?t.clusterBy:"all clusters"}const Ge=([t],[e])=>t.localeCompare(e);function mt(t,e,l){let n,i,o,d,_,u,c,T,k,C,D,ee,N,p,F,Z;Se(t,le,r=>l(3,p=r)),Se(t,me,r=>l(4,F=r)),Se(t,at,r=>l(19,Z=r));let H=p.queryValue||"";le.update(r=>({...r,filters:r.filters||{}}));function K(r){l(5,H=r.target.value),le.update(h=>({...h,queryValue:H}))}function he(r){var z;const h=p.filters||{},b=r.dataPoints;for(const[R,$]of Object.entries(h)){if(!$||$.length===0)continue;if(!b.some(U=>{var X;const q=(X=U[R])==null?void 0:X.toString().toLowerCase();return $.some(S=>q===S.toLowerCase())}))return!1}const V=((z=p.queryValue)==null?void 0:z.toLowerCase())||"";if(V.length>=3){const R=p.queryCategory||"name";if(!b.some(ve=>{var U;return(U=ve[R])==null?void 0:U.toString().toLowerCase().includes(V)}))return!1}return F.length>0?F.includes(r.moveBy):!0}function M(r,h){r==="clusterBy"?le.update(b=>({...b,clusterBy:h})):r==="moveBy"&&le.update(b=>({...b,moveBy:h}))}function Q(r){const h=p.clusterBy;le.update(b=>{var R;const V={...b.filters};return((R=V[h])==null?void 0:R[0])===r?delete V[h]:V[h]=[r],{...b,filters:V}})}function fe(){le.update(r=>({...r,queryValue:"",filters:{}})),l(5,H=""),me.set([])}function te(){const r={title:"",description:"",methodology:"",media:!0,config:{clusterBy:p.clusterBy,moveBy:p.moveBy,filters:p.filters,queryValue:H,queryCategory:p.queryCategory||"name",speed:p.speed||3,stroke:p.stroke||1,loops:p.loopsToComplete||1,highlightedEntities:tt(me)}},h=JSON.stringify(r,null,2);navigator.clipboard.writeText(h).then(()=>{alert("Config copied to clipboard!")}).catch(b=>{console.error("Could not copy text: ",b)})}function re(r){return c===T?Oe:Oe+(r-c)*(dt-Oe)/(T-c)}function de(r){return D===ee?Pe:Pe+(r-D)*(_t-Pe)/(ee-D)}const _e=r=>M("clusterBy",r),W=r=>Q(r),pe=r=>me.set([r]);return t.$$.update=()=>{if(t.$$.dirty[0]&524296&&(()=>{const r=new Set;return Object.values(Z).forEach(h=>{h.dataPoints.forEach(b=>{const V=b[p.clusterBy];V&&r.add(V)})}),Array.from(r)})(),t.$$.dirty[0]&524288&&l(15,i=Object.entries(Z).filter(([r,h])=>he(h)).reduce((r,[h,b])=>(r[h]=b,r),{})),t.$$.dirty[0]&32768&&l(1,d=Object.entries(i||{}).map(([r,h])=>[r,h.dataPoints.length])),t.$$.dirty[0]&2&&l(18,_=d.map(([r,h])=>r)),t.$$.dirty[0]&786432&&Object.entries(Z).length!=_.length&&et(me,F=_,F),t.$$.dirty[0]&28){l(2,o=[]);const r=p.filters||{};for(const[h,b]of Object.entries(r))for(const V of b)o.push({label:V,type:h});p.queryValue&&p.queryValue.length>=3&&o.push({label:p.queryValue,type:"query"}),F.length===1&&o.push({label:F[0],type:"name"})}t.$$.dirty[0]&2&&l(17,u=d.map(([r,h])=>h)),t.$$.dirty[0]&131072&&(c=u.length>0?Math.min(...u):0),t.$$.dirty[0]&131072&&(T=u.length>0?Math.max(...u):1),t.$$.dirty[0]&32776&&l(0,k=(()=>{const r={};return Object.values(i).forEach(h=>{h.dataPoints.forEach(b=>{const V=b[p.clusterBy];V&&(r[V]=(r[V]||0)+1)})}),Object.entries(r)})()),t.$$.dirty[0]&1&&l(16,C=k.map(([r,h])=>h)),t.$$.dirty[0]&65536&&(D=C.length>0?Math.min(...C):0),t.$$.dirty[0]&65536&&(ee=C.length>0?Math.max(...C):1),t.$$.dirty[0]&32776&&l(6,N=(()=>{const r=vt(p),h=Object.keys(i).length;return`This visualization clusters ${h} ${pt(h,"participant")}, based on ${r}.`})())},l(7,n=ht),l(2,o=[]),[k,d,o,p,F,H,N,n,K,M,Q,fe,te,re,de,i,C,u,_,Z,_e,W,pe]}class gt extends Ke{constructor(e){super(),We(this,e,mt,ft,He,{},null,[-1,-1])}}function yt(t){let e,l="Loading...";return{c(){e=g("p"),e.textContent=l,this.h()},l(n){e=y(n,"P",{class:!0,"data-svelte-h":!0}),qe(e)!=="svelte-qdsr2u"&&(e.textContent=l),this.h()},h(){m(e,"class","svelte-13tgnqv")},m(n,i){Y(n,e,i)},i:Fe,o:Fe,d(n){n&&v(e)}}}function bt(t){let e,l,n;return l=new ut({}),{c(){e=g("div"),Xe(l.$$.fragment),this.h()},l(i){e=y(i,"DIV",{class:!0});var o=E(e);Ye(l.$$.fragment,o),o.forEach(v),this.h()},h(){m(e,"class","svelte-13tgnqv")},m(i,o){Y(i,e,o),Ze(l,e,null),n=!0},i(i){n||(Ie(l.$$.fragment,i),n=!0)},o(i){we(l.$$.fragment,i),n=!1},d(i){i&&v(e),$e(l)}}}function Ct(t){let e,l,n,i,o,d,_;const u=[bt,yt],c=[];function T(k,C){return k[0].length>0?0:1}return l=T(t),n=c[l]=u[l](t),d=new gt({}),{c(){e=g("main"),n.c(),i=L(),o=g("div"),Xe(d.$$.fragment),this.h()},l(k){e=y(k,"MAIN",{});var C=E(e);n.l(C),i=A(C),o=y(C,"DIV",{class:!0});var D=E(o);Ye(d.$$.fragment,D),D.forEach(v),C.forEach(v),this.h()},h(){m(o,"class","svelte-13tgnqv")},m(k,C){Y(k,e,C),c[l].m(e,null),f(e,i),f(e,o),Ze(d,o,null),_=!0},p(k,[C]){let D=l;l=T(k),l!==D&&(nt(),we(c[D],1,1,()=>{c[D]=null}),st(),n=c[l],n||(n=c[l]=u[l](k),n.c()),Ie(n,1),n.m(e,i))},i(k){_||(Ie(n),Ie(d.$$.fragment,k),_=!0)},o(k){we(n),we(d.$$.fragment,k),_=!1},d(k){k&&v(e),c[l].d(),$e(d)}}}function kt(t,e,l){let n;return Se(t,je,i=>l(0,n=i)),lt(async()=>{const o=(await ct(rt+"/data/update-until-2022/data.tsv")).map(d=>{const _={};for(const[u,c]of Object.entries(d))_[u]=c!=null&&c.trim()?c:"NA";return _});je.set(o),it.set(window.innerWidth),ot.set(600)}),[n]}class Ft extends Ke{constructor(e){super(),We(this,e,kt,Ct,He,{})}}export{Ft as component};
