const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/RecordRTC.Bv7qv1Kq.js","../chunks/_commonjsHelpers.Cpj98o6Y.js"])))=>i.map(i=>d[i]);
import{s as W,e as y,t as D,a as T,c as k,b as A,d as O,f as b,g as B,i as N,h as _,p as I,n as P,r as Z,x as G,m as M,k as x,o as ee,l as te}from"../chunks/scheduler.Xi5sktIg.js";import{S as X,i as Y,c as V,a as q,m as L,t as S,b as oe,d as E,e as j,g as ne}from"../chunks/index.DXItMEGr.js";import{b as ae}from"../chunks/paths.C9PU1Wws.js";import{c as U,b as se,f as re,d as H,w as le,h as ie}from"../chunks/stores.CnZXsj0Y.js";import{m as J,t as ce,S as de}from"../chunks/dsv.DWetE-iJ.js";import{C as ue}from"../chunks/ControlPanel.BnNGw33N.js";import{_ as fe}from"../chunks/preload-helper.C1FmrZbK.js";import{c as Q}from"../chunks/constants.BfKEPlZp.js";function me(l){let e,t,o,n,d,i,m,g,u,p,$,v,w,a,s,r,h,R;return{c(){e=y("div"),t=y("button"),o=D("Start Manual Recording"),d=T(),i=y("button"),m=D("Stop Manual Recording"),u=T(),p=y("button"),$=D("Start Auto-Recording"),w=T(),a=y("button"),s=D("Start Advanced Auto-Recording"),this.h()},l(c){e=k(c,"DIV",{});var f=A(e);t=k(f,"BUTTON",{});var C=A(t);o=O(C,"Start Manual Recording"),C.forEach(b),d=B(f),i=k(f,"BUTTON",{});var F=A(i);m=O(F,"Stop Manual Recording"),F.forEach(b),u=B(f),p=k(f,"BUTTON",{});var K=A(p);$=O(K,"Start Auto-Recording"),K.forEach(b),w=B(f),a=k(f,"BUTTON",{});var z=A(a);s=O(z,"Start Advanced Auto-Recording"),z.forEach(b),f.forEach(b),this.h()},h(){t.disabled=n=l[0]||l[1]||l[2],i.disabled=g=!l[0]||l[1]||l[2],p.disabled=v=l[1]||l[2],a.disabled=r=l[2]||l[1]},m(c,f){N(c,e,f),_(e,t),_(t,o),_(e,d),_(e,i),_(i,m),_(e,u),_(e,p),_(p,$),_(e,w),_(e,a),_(a,s),h||(R=[I(t,"click",l[3]),I(i,"click",l[4]),I(p,"click",l[5]),I(a,"click",l[6])],h=!0)},p(c,[f]){f&7&&n!==(n=c[0]||c[1]||c[2])&&(t.disabled=n),f&7&&g!==(g=!c[0]||c[1]||c[2])&&(i.disabled=g),f&6&&v!==(v=c[1]||c[2])&&(p.disabled=v),f&6&&r!==(r=c[2]||c[1])&&(a.disabled=r)},i:P,o:P,d(c){c&&b(e),h=!1,Z(R)}}}const pe=6e4;function ge(l,e,t){let o,n=!1,d=!1,i=!1,m=0,g;async function u(){const s=G(se);if(s){const{default:r}=await fe(async()=>{const{default:R}=await import("../chunks/RecordRTC.Bv7qv1Kq.js").then(c=>c.R);return{default:R}},__vite__mapDeps([0,1]),import.meta.url),h=s.captureStream(20);o=new r(h,{type:"video",mimeType:"video/webm",videoBitsPerSecond:15e6}),o.startRecording(),t(0,n=!0),console.log("Recording started")}else console.error("Canvas not found")}async function p(){o&&n?(o.stopRecording(()=>{const s=o.getBlob(),r=document.createElement("a");r.href=URL.createObjectURL(s),r.download="canvas_recording.webm",r.click(),console.log("Recording stopped and saved")}),t(0,n=!1)):console.error("No active recording")}function $(){if(d)return;t(1,d=!0);const s=Object.keys(Q).filter(r=>r!=="name");console.log("Auto-recording started"),n||u(),setInterval(()=>{if(m>=s.length){console.log("All steps completed. Stopping auto-recording."),v();return}const r=s[m];U.update(h=>({...h,clusterBy:r})),console.log(`Updated clusterBy to: ${r}`),m++},pe)}async function v(){d&&(clearInterval(g),t(1,d=!1),m=0,await p(),console.log("Auto-recording stopped"))}async function w(){if(i)return;t(2,i=!0);const s=Object.keys(Q).filter(R=>R!=="name");let r;console.log("Advanced auto-recording started"),n||await u();async function h(R){r=G(re);for(const c of r)U.update(f=>({...f,clusterBy:R,filters:{[R]:[c[0]]},speed:5})),await new Promise(f=>{J.subscribe(C=>{C&&(J.set(!1),f())})})}for(const R of s)if(U.update(c=>({...c,clusterBy:R,filters:{}})),await new Promise(c=>setTimeout(c,2e3)),await h(R),m++,m>=s.length){console.log("All categories and filters completed.");break}await a()}async function a(){i&&(t(2,i=!1),m=0,await p(),console.log("Advanced auto-recording stopped"))}return[n,d,i,u,p,$,w]}class _e extends X{constructor(e){super(),Y(this,e,ge,me,W,{})}}function ve(l){let e,t="Loading...";return{c(){e=y("p"),e.textContent=t,this.h()},l(o){e=k(o,"P",{class:!0,"data-svelte-h":!0}),te(e)!=="svelte-qdsr2u"&&(e.textContent=t),this.h()},h(){M(e,"class","svelte-13tgnqv")},m(o,n){N(o,e,n)},i:P,o:P,d(o){o&&b(e)}}}function be(l){let e,t,o;return t=new de({}),{c(){e=y("div"),V(t.$$.fragment),this.h()},l(n){e=k(n,"DIV",{class:!0});var d=A(e);q(t.$$.fragment,d),d.forEach(b),this.h()},h(){M(e,"class","svelte-13tgnqv")},m(n,d){N(n,e,d),L(t,e,null),o=!0},i(n){o||(E(t.$$.fragment,n),o=!0)},o(n){S(t.$$.fragment,n),o=!1},d(n){n&&b(e),j(t)}}}function he(l){let e,t,o,n,d,i,m,g,u,p;const $=[be,ve],v=[];function w(a,s){return a[0].length>0?0:1}return t=w(l),o=v[t]=$[t](l),i=new _e({}),u=new ue({}),{c(){e=y("main"),o.c(),n=T(),d=y("div"),V(i.$$.fragment),m=T(),g=y("div"),V(u.$$.fragment),this.h()},l(a){e=k(a,"MAIN",{});var s=A(e);o.l(s),n=B(s),d=k(s,"DIV",{class:!0});var r=A(d);q(i.$$.fragment,r),r.forEach(b),m=B(s),g=k(s,"DIV",{class:!0});var h=A(g);q(u.$$.fragment,h),h.forEach(b),s.forEach(b),this.h()},h(){M(d,"class","svelte-13tgnqv"),M(g,"class","svelte-13tgnqv")},m(a,s){N(a,e,s),v[t].m(e,null),_(e,n),_(e,d),L(i,d,null),_(e,m),_(e,g),L(u,g,null),p=!0},p(a,[s]){let r=t;t=w(a),t!==r&&(ne(),S(v[r],1,1,()=>{v[r]=null}),oe(),o=v[t],o||(o=v[t]=$[t](a),o.c()),E(o,1),o.m(e,n))},i(a){p||(E(o),E(i.$$.fragment,a),E(u.$$.fragment,a),p=!0)},o(a){S(o),S(i.$$.fragment,a),S(u.$$.fragment,a),p=!1},d(a){a&&b(e),v[t].d(),j(i),j(u)}}}function Re(l,e,t){let o;return x(l,H,n=>t(0,o=n)),ee(async()=>{const d=(await ce(ae+"/data/update-until-2022/data.tsv")).map(i=>{const m={};for(const[g,u]of Object.entries(i))m[g]=u!=null&&u.trim()?u:"NA";return m});H.set(d),le.set(3840),ie.set(2160)}),[o]}class Be extends X{constructor(e){super(),Y(this,e,Re,he,W,{})}}export{Be as component};
