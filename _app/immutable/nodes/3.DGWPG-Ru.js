import{s as Xe,e as _,a as N,t as Z,c as p,b as B,l as ve,g as D,f as v,d as $,m as k,i as x,h,P as ne,j as _e,n as Le,Q as qe,B as lt,k as be,R as se,r as ge,S as De,q as st}from"../chunks/scheduler.B5e5MwHY.js";import{S as Ye,i as Ze,b as $e,d as xe,m as et,t as we,c as nt,a as Ie,e as tt,g as ot}from"../chunks/index.yVqgE-ux.js";import{b as it}from"../chunks/paths.D-lTQfQa.js";import{h as fe,e as Me,a as de,b as rt,f as at,d as ct,g as Te,w as ut,i as ht}from"../chunks/constants.DYV4Q084.js";import{t as ft,S as dt}from"../chunks/dsv.Bi0fI8VR.js";function le(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function je(t,e,l){const s=t.slice();return s[30]=e[l][0],s[31]=e[l][1],s}function Fe(t,e,l){const s=t.slice();return s[31]=e[l][0],s[34]=e[l][1],s}function Qe(t,e,l){const s=t.slice();return s[37]=e[l],s}function Ue(t,e,l){const s=t.slice();return s[37]=e[l],s}function He(t){let e,l=t[37]+"",s,a,u,f;function m(){return t[20](t[37])}return{c(){e=_("span"),s=Z(l),a=N(),this.h()},l(c){e=p(c,"SPAN",{class:!0});var i=B(e);s=$(i,l),a=D(i),i.forEach(v),this.h()},h(){k(e,"class","svelte-1cvs0si"),se(e,"selected",t[37]===t[4].clusterBy)},m(c,i){x(c,e,i),h(e,s),h(e,a),u||(f=ne(e,"click",m),u=!0)},p(c,i){t=c,i[0]&64&&l!==(l=t[37]+"")&&_e(s,l),i[0]&80&&se(e,"selected",t[37]===t[4].clusterBy)},d(c){c&&v(e),u=!1,f()}}}function Re(t){let e,l=t[37]+"",s,a,u,f;function m(){return t[21](t[37])}return{c(){e=_("span"),s=Z(l),a=N(),this.h()},l(c){e=p(c,"SPAN",{class:!0});var i=B(e);s=$(i,l),a=D(i),i.forEach(v),this.h()},h(){k(e,"class","svelte-1cvs0si"),se(e,"selected",t[37]===t[4].moveBy)},m(c,i){x(c,e,i),h(e,s),h(e,a),u||(f=ne(e,"click",m),u=!0)},p(c,i){t=c,i[0]&32&&l!==(l=t[37]+"")&&_e(s,l),i[0]&48&&se(e,"selected",t[37]===t[4].moveBy)},d(c){c&&v(e),u=!1,f()}}}function Je(t){let e,l=t[31]+"",s,a,u,f;function m(){return t[22](t[31])}return{c(){e=_("span"),s=Z(l),a=N(),this.h()},l(c){e=p(c,"SPAN",{style:!0,class:!0});var i=B(e);s=$(i,l),a=D(i),i.forEach(v),this.h()},h(){ge(e,"font-size",t[13](t[34])+"px"),k(e,"class","svelte-1cvs0si"),se(e,"highlighted",t[31]===t[4].selectedClusterValue)},m(c,i){x(c,e,i),h(e,s),h(e,a),u||(f=ne(e,"click",m),u=!0)},p(c,i){t=c,i[0]&2&&l!==(l=t[31]+"")&&_e(s,l),i[0]&2&&ge(e,"font-size",t[13](t[34])+"px"),i[0]&18&&se(e,"highlighted",t[31]===t[4].selectedClusterValue)},d(c){c&&v(e),u=!1,f()}}}function We(t){let e,l=t[30]+"",s,a,u;function f(){return t[23](t[30])}return{c(){e=_("span"),s=Z(l),this.h()},l(m){e=p(m,"SPAN",{style:!0,class:!0});var c=B(e);s=$(c,l),c.forEach(v),this.h()},h(){ge(e,"font-size",t[12](t[31])+"px"),k(e,"class","svelte-1cvs0si"),se(e,"highlighted",t[3].includes(t[30]))},m(m,c){x(m,e,c),h(e,s),a||(u=ne(e,"click",f),a=!0)},p(m,c){t=m,c[0]&4&&l!==(l=t[30]+"")&&_e(s,l),c[0]&4&&ge(e,"font-size",t[12](t[31])+"px"),c[0]&12&&se(e,"highlighted",t[3].includes(t[30]))},d(m){m&&v(e),a=!1,u()}}}function Ge(t){let e,l,s=t[2].length+"",a;return{c(){e=_("p"),l=Z("50 out of "),a=Z(s),this.h()},l(u){e=p(u,"P",{style:!0});var f=B(e);l=$(f,"50 out of "),a=$(f,s),f.forEach(v),this.h()},h(){ge(e,"border-top","1px solid"),ge(e,"padding-top","10px")},m(u,f){x(u,e,f),h(e,l),h(e,a)},p(u,f){f[0]&4&&s!==(s=u[2].length+"")&&_e(a,s)},d(u){u&&v(e)}}}function vt(t){let e,l,s,a="Reset",u,f,m="Copy Config",c,i,P,C,V="Cluster By:",z,Q,R,M,y,oe="Move By:",U,K,pe,J,H,ie,ee=t[4].clusterBy+"",re,me,Ce,X,ye,T,te,r="Filter By:",d,g,j,L,F,Y,W,G=le(t[6]),b=[];for(let o=0;o<G.length;o+=1)b[o]=He(Ue(t,G,o));let ae=le(t[5]),q=[];for(let o=0;o<ae.length;o+=1)q[o]=Re(Qe(t,ae,o));let ce=le(t[1]),w=[];for(let o=0;o<ce.length;o+=1)w[o]=Je(Fe(t,ce,o));let ue=le(t[2].slice(0,50).sort(Ke)),I=[];for(let o=0;o<ue.length;o+=1)I[o]=We(je(t,ue,o));let O=t[2].length>50&&Ge(t);return{c(){e=_("header"),l=_("div"),s=_("button"),s.textContent=a,u=N(),f=_("button"),f.textContent=m,c=N(),i=_("div"),P=_("div"),C=_("label"),C.textContent=V,z=N(),Q=_("div");for(let o=0;o<b.length;o+=1)b[o].c();R=N(),M=_("div"),y=_("label"),y.textContent=oe,U=N(),K=_("div");for(let o=0;o<q.length;o+=1)q[o].c();pe=N(),J=_("div"),H=_("label"),ie=Z("Values for "),re=Z(ee),me=Z(":"),Ce=N(),X=_("div");for(let o=0;o<w.length;o+=1)w[o].c();ye=N(),T=_("div"),te=_("label"),te.textContent=r,d=N(),g=_("input"),j=N(),L=_("div");for(let o=0;o<I.length;o+=1)I[o].c();F=N(),O&&O.c(),this.h()},l(o){e=p(o,"HEADER",{class:!0});var S=B(e);l=p(S,"DIV",{class:!0});var n=B(l);s=p(n,"BUTTON",{class:!0,"data-svelte-h":!0}),ve(s)!=="svelte-qy1k7w"&&(s.textContent=a),u=D(n),f=p(n,"BUTTON",{class:!0,"data-svelte-h":!0}),ve(f)!=="svelte-18xqo2h"&&(f.textContent=m),n.forEach(v),c=D(S),i=p(S,"DIV",{class:!0});var E=B(i);P=p(E,"DIV",{class:!0});var ke=B(P);C=p(ke,"LABEL",{"data-svelte-h":!0}),ve(C)!=="svelte-1ekr4iz"&&(C.textContent=V),z=D(ke),Q=p(ke,"DIV",{class:!0});var ze=B(Q);for(let A=0;A<b.length;A+=1)b[A].l(ze);ze.forEach(v),ke.forEach(v),R=D(E),M=p(E,"DIV",{class:!0});var Ee=B(M);y=p(Ee,"LABEL",{"data-svelte-h":!0}),ve(y)!=="svelte-8r6yw"&&(y.textContent=oe),U=D(Ee),K=p(Ee,"DIV",{class:!0});var Ae=B(K);for(let A=0;A<q.length;A+=1)q[A].l(Ae);Ae.forEach(v),Ee.forEach(v),pe=D(E),J=p(E,"DIV",{class:!0});var Be=B(J);H=p(Be,"LABEL",{});var Ve=B(H);ie=$(Ve,"Values for "),re=$(Ve,ee),me=$(Ve,":"),Ve.forEach(v),Ce=D(Be),X=p(Be,"DIV",{class:!0});var Ne=B(X);for(let A=0;A<w.length;A+=1)w[A].l(Ne);Ne.forEach(v),Be.forEach(v),ye=D(E),T=p(E,"DIV",{class:!0});var he=B(T);te=p(he,"LABEL",{"data-svelte-h":!0}),ve(te)!=="svelte-24ucn1"&&(te.textContent=r),d=D(he),g=p(he,"INPUT",{type:!0,placeholder:!0,class:!0}),j=D(he),L=p(he,"DIV",{class:!0});var Se=B(L);for(let A=0;A<I.length;A+=1)I[A].l(Se);F=D(Se),O&&O.l(Se),Se.forEach(v),he.forEach(v),E.forEach(v),S.forEach(v),this.h()},h(){k(s,"class","reset svelte-1cvs0si"),k(f,"class","copy-config svelte-1cvs0si"),k(l,"class","header-buttons svelte-1cvs0si"),k(Q,"class","options svelte-1cvs0si"),k(P,"class","category svelte-1cvs0si"),k(K,"class","options svelte-1cvs0si"),k(M,"class","category svelte-1cvs0si"),k(X,"class","options tiny svelte-1cvs0si"),k(J,"class","filtered-cluster-values svelte-1cvs0si"),k(g,"type","text"),k(g,"placeholder","Enter your query"),g.value=t[0],k(g,"class","svelte-1cvs0si"),k(L,"class","options tiny svelte-1cvs0si"),k(T,"class","filtered-entities svelte-1cvs0si"),k(i,"class","categories svelte-1cvs0si"),k(e,"class","svelte-1cvs0si")},m(o,S){x(o,e,S),h(e,l),h(l,s),h(l,u),h(l,f),h(e,c),h(e,i),h(i,P),h(P,C),h(P,z),h(P,Q);for(let n=0;n<b.length;n+=1)b[n]&&b[n].m(Q,null);h(i,R),h(i,M),h(M,y),h(M,U),h(M,K);for(let n=0;n<q.length;n+=1)q[n]&&q[n].m(K,null);h(i,pe),h(i,J),h(J,H),h(H,ie),h(H,re),h(H,me),h(J,Ce),h(J,X);for(let n=0;n<w.length;n+=1)w[n]&&w[n].m(X,null);h(i,ye),h(i,T),h(T,te),h(T,d),h(T,g),h(T,j),h(T,L);for(let n=0;n<I.length;n+=1)I[n]&&I[n].m(L,null);h(L,F),O&&O.m(L,null),Y||(W=[ne(s,"click",t[10]),ne(f,"click",t[11]),ne(g,"input",t[7])],Y=!0)},p(o,S){if(S[0]&336){G=le(o[6]);let n;for(n=0;n<G.length;n+=1){const E=Ue(o,G,n);b[n]?b[n].p(E,S):(b[n]=He(E),b[n].c(),b[n].m(Q,null))}for(;n<b.length;n+=1)b[n].d(1);b.length=G.length}if(S[0]&304){ae=le(o[5]);let n;for(n=0;n<ae.length;n+=1){const E=Qe(o,ae,n);q[n]?q[n].p(E,S):(q[n]=Re(E),q[n].c(),q[n].m(K,null))}for(;n<q.length;n+=1)q[n].d(1);q.length=ae.length}if(S[0]&16&&ee!==(ee=o[4].clusterBy+"")&&_e(re,ee),S[0]&8722){ce=le(o[1]);let n;for(n=0;n<ce.length;n+=1){const E=Fe(o,ce,n);w[n]?w[n].p(E,S):(w[n]=Je(E),w[n].c(),w[n].m(X,null))}for(;n<w.length;n+=1)w[n].d(1);w.length=ce.length}if(S[0]&1&&g.value!==o[0]&&(g.value=o[0]),S[0]&4108){ue=le(o[2].slice(0,50).sort(Ke));let n;for(n=0;n<ue.length;n+=1){const E=je(o,ue,n);I[n]?I[n].p(E,S):(I[n]=We(E),I[n].c(),I[n].m(L,F))}for(;n<I.length;n+=1)I[n].d(1);I.length=ue.length}o[2].length>50?O?O.p(o,S):(O=Ge(o),O.c(),O.m(L,null)):O&&(O.d(1),O=null)},i:Le,o:Le,d(o){o&&v(e),qe(b,o),qe(q,o),qe(w,o),qe(I,o),O&&O.d(),Y=!1,lt(W)}}}const Oe=12,gt=30,Pe=12,_t=30,Ke=([t],[e])=>t.localeCompare(e);function pt(t,e,l){let s,a,u,f,m,c,i,P,C,V,z,Q,R,M,y,oe;be(t,fe,r=>l(3,R=r)),be(t,Me,r=>l(18,M=r)),be(t,de,r=>l(4,y=r)),be(t,rt,r=>l(19,oe=r));let U=y.queryValue||"";function K(r){r.target.value.length>3&&(l(0,U=r.target.value),de.update(d=>({...d,queryValue:U})))}const pe=[],J=[];function H(r,d){ee(),fe.set([]),r==="clusterBy"?de.update(g=>({...g,clusterBy:d})):r==="moveBy"&&de.update(g=>({...g,moveBy:d}))}function ie(r){de.update(L=>({...L,selectedClusterValue:r}));const d=U.toLowerCase(),g=y.queryCategory||"name",j=[];Object.entries(De(Me)).forEach(([L,F])=>{const Y=F.dataPoints.some(G=>{var b;return((b=G[y.clusterBy])==null?void 0:b.toString())===r.toString()}),W=d.length>=3?F.dataPoints.some(G=>{var b;return(b=G[g])==null?void 0:b.toString().toLowerCase().includes(d)}):!0;Y&&W&&(j.push(L),F.currentCategoryIndex=0,F.t=0,F.trail=[])}),fe.set(j)}function ee(){de.update(r=>({...r,queryValue:"",selectedClusterValue:null})),l(0,U=""),fe.set([])}function re(){const r={title:"",description:"",methodology:"",config:{clusterBy:y.clusterBy,moveBy:y.moveBy,selectedClusterValue:y.selectedClusterValue||"",queryValue:U,queryCategory:y.queryCategory||"name",speed:y.speed||3,stroke:y.stroke||1,loops:y.loopsToComplete||1,highlightedEntities:De(fe)}},d=JSON.stringify(r,null,4);navigator.clipboard.writeText(d).then(()=>{alert("Config copied to clipboard!")}).catch(g=>{console.error("Could not copy text: ",g)})}function me(r){return i===P?Oe:Oe+(r-i)*(gt-Oe)/(P-i)}function Ce(r){return z===Q?Pe:Pe+(r-z)*(_t-Pe)/(Q-z)}const X=r=>H("clusterBy",r),ye=r=>H("moveBy",r),T=r=>ie(r),te=r=>fe.set([r]);return t.$$.update=()=>{t.$$.dirty[0]&524288&&l(15,u=oe.map(([r])=>r)),t.$$.dirty[0]&262161&&l(17,f=Object.entries(M).filter(([r,d])=>{const g=y.selectedClusterValue?d.dataPoints.some(Y=>{var W;return((W=Y[y.clusterBy])==null?void 0:W.toString())===y.selectedClusterValue.toString()}):!0,j=U.toLowerCase(),L=y.queryCategory||"name",F=j.length>=3?d.dataPoints.some(Y=>{var W;return(W=Y[L])==null?void 0:W.toString().toLowerCase().includes(j)}):!0;return g&&F}).reduce((r,[d,g])=>(r[d]=g,r),{})),t.$$.dirty[0]&131072&&l(2,m=Object.entries(f).map(([r,d])=>[r,d.dataPoints.length])),t.$$.dirty[0]&4&&l(16,c=m.map(([r,d])=>d)),t.$$.dirty[0]&65536&&(i=c.length>0?Math.min(...c):0),t.$$.dirty[0]&65536&&(P=c.length>0?Math.max(...c):1),t.$$.dirty[0]&294920&&l(1,C=(()=>{let r=u;return R.length>0&&(r=u.filter(d=>Object.values(M).some(g=>R.includes(g.moveBy)&&g.categories.includes(d)))),r.map(d=>{const g=Object.values(M).filter(j=>(R.length===0||R.includes(j.moveBy))&&j.categories.includes(d)).length;return[d,g]})})()),t.$$.dirty[0]&2&&l(14,V=C.map(([r,d])=>d)),t.$$.dirty[0]&16384&&(z=V.length>0?Math.min(...V):0),t.$$.dirty[0]&16384&&(Q=V.length>0?Math.max(...V):1)},l(6,s=at.filter(r=>!pe.includes(r))),l(5,a=ct.filter(r=>!J.includes(r))),[U,C,m,R,y,a,s,K,H,ie,ee,re,me,Ce,V,u,c,f,M,oe,X,ye,T,te]}class mt extends Ye{constructor(e){super(),Ze(this,e,pt,vt,Xe,{},null,[-1,-1])}}function Ct(t){let e,l="Loading...";return{c(){e=_("p"),e.textContent=l,this.h()},l(s){e=p(s,"P",{class:!0,"data-svelte-h":!0}),ve(e)!=="svelte-qdsr2u"&&(e.textContent=l),this.h()},h(){k(e,"class","svelte-13tgnqv")},m(s,a){x(s,e,a)},i:Le,o:Le,d(s){s&&v(e)}}}function yt(t){let e,l,s;return l=new dt({}),{c(){e=_("div"),$e(l.$$.fragment),this.h()},l(a){e=p(a,"DIV",{class:!0});var u=B(e);xe(l.$$.fragment,u),u.forEach(v),this.h()},h(){k(e,"class","svelte-13tgnqv")},m(a,u){x(a,e,u),et(l,e,null),s=!0},i(a){s||(Ie(l.$$.fragment,a),s=!0)},o(a){we(l.$$.fragment,a),s=!1},d(a){a&&v(e),tt(l)}}}function bt(t){let e,l,s,a,u,f,m;const c=[yt,Ct],i=[];function P(C,V){return C[0].length>0?0:1}return l=P(t),s=i[l]=c[l](t),f=new mt({}),{c(){e=_("main"),s.c(),a=N(),u=_("div"),$e(f.$$.fragment),this.h()},l(C){e=p(C,"MAIN",{});var V=B(e);s.l(V),a=D(V),u=p(V,"DIV",{class:!0});var z=B(u);xe(f.$$.fragment,z),z.forEach(v),V.forEach(v),this.h()},h(){k(u,"class","svelte-13tgnqv")},m(C,V){x(C,e,V),i[l].m(e,null),h(e,a),h(e,u),et(f,u,null),m=!0},p(C,[V]){let z=l;l=P(C),l!==z&&(ot(),we(i[z],1,1,()=>{i[z]=null}),nt(),s=i[l],s||(s=i[l]=c[l](C),s.c()),Ie(s,1),s.m(e,a))},i(C){m||(Ie(s),Ie(f.$$.fragment,C),m=!0)},o(C){we(s),we(f.$$.fragment,C),m=!1},d(C){C&&v(e),i[l].d(),tt(f)}}}function kt(t,e,l){let s;return be(t,Te,a=>l(0,s=a)),st(async()=>{const a=await ft(it+"/data/update-until-2022/until2022-all-winter-olympia.tsv");Te.set(a),ut.set(window.innerWidth),ht.set(window.innerHeight-200)}),[s]}class wt extends Ye{constructor(e){super(),Ze(this,e,kt,bt,Xe,{})}}export{wt as component};
