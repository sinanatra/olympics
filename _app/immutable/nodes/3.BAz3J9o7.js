import{s as $e,e as p,a as F,t as G,c as g,b as E,l as be,g as M,f as d,d as J,m as k,i as $,h as u,E as re,j as oe,n as ze,B as Le,F as ot,k as ke,G as le,r as ge,I as je,q as at}from"../chunks/scheduler.evRM0l9T.js";import{S as et,i as tt,b as lt,d as st,m as nt,t as Oe,c as it,a as Pe,e as rt,g as ct}from"../chunks/index.aiZKxZDj.js";import{b as ut}from"../chunks/paths.CeSblYMY.js";import{h as _e,e as Qe,c as pe,b as ht,d as Ue,w as ft,a as dt}from"../chunks/stores.0UUoU4mb.js";import{t as _t,S as pt}from"../chunks/dsv.Bsj7G-pu.js";import{e as te}from"../chunks/each.D6YF6ztN.js";import{f as gt,a as vt}from"../chunks/constants.B7V-oudb.js";function He(t,e,l){const s=t.slice();return s[30]=e[l][0],s[31]=e[l][1],s}function xe(t,e,l){const s=t.slice();return s[34]=e[l],s}function Re(t,e,l){const s=t.slice();return s[31]=e[l][0],s[37]=e[l][1],s}function Ge(t,e,l){const s=t.slice();return s[34]=e[l],s}function Je(t){let e,l=t[34]+"",s,i,h,f;function v(){return t[20](t[34])}return{c(){e=p("span"),s=G(l),i=F(),this.h()},l(c){e=g(c,"SPAN",{class:!0});var a=E(e);s=J(a,l),i=M(a),a.forEach(d),this.h()},h(){k(e,"class","svelte-hplaxf"),le(e,"selected",t[34]===t[4].clusterBy)},m(c,a){$(c,e,a),u(e,s),u(e,i),h||(f=re(e,"click",v),h=!0)},p(c,a){t=c,a[0]&64&&l!==(l=t[34]+"")&&oe(s,l),a[0]&80&&le(e,"selected",t[34]===t[4].clusterBy)},d(c){c&&d(e),h=!1,f()}}}function We(t){let e,l=t[31]+"",s,i,h,f;function v(){return t[21](t[31])}return{c(){e=p("span"),s=G(l),i=F(),this.h()},l(c){e=g(c,"SPAN",{style:!0,class:!0});var a=E(e);s=J(a,l),i=M(a),a.forEach(d),this.h()},h(){ge(e,"font-size",t[13](t[37])+"px"),k(e,"class","svelte-hplaxf"),le(e,"highlighted",t[31]==t[4].selectedClusterValue)},m(c,a){$(c,e,a),u(e,s),u(e,i),h||(f=re(e,"click",v),h=!0)},p(c,a){t=c,a[0]&2&&l!==(l=t[31]+"")&&oe(s,l),a[0]&2&&ge(e,"font-size",t[13](t[37])+"px"),a[0]&18&&le(e,"highlighted",t[31]==t[4].selectedClusterValue)},d(c){c&&d(e),h=!1,f()}}}function Ke(t){let e,l=t[34]+"",s,i,h,f;function v(){return t[22](t[34])}return{c(){e=p("span"),s=G(l),i=F(),this.h()},l(c){e=g(c,"SPAN",{class:!0});var a=E(e);s=J(a,l),i=M(a),a.forEach(d),this.h()},h(){k(e,"class","svelte-hplaxf"),le(e,"selected",t[34]===t[4].moveBy)},m(c,a){$(c,e,a),u(e,s),u(e,i),h||(f=re(e,"click",v),h=!0)},p(c,a){t=c,a[0]&32&&l!==(l=t[34]+"")&&oe(s,l),a[0]&48&&le(e,"selected",t[34]===t[4].moveBy)},d(c){c&&d(e),h=!1,f()}}}function Xe(t){let e,l=t[30]+"",s,i,h;function f(){return t[23](t[30])}return{c(){e=p("span"),s=G(l),this.h()},l(v){e=g(v,"SPAN",{style:!0,class:!0});var c=E(e);s=J(c,l),c.forEach(d),this.h()},h(){ge(e,"font-size",t[12](t[31])+"px"),k(e,"class","svelte-hplaxf"),le(e,"highlighted",t[3].includes(t[30]))},m(v,c){$(v,e,c),u(e,s),i||(h=re(e,"click",f),i=!0)},p(v,c){t=v,c[0]&4&&l!==(l=t[30]+"")&&oe(s,l),c[0]&4&&ge(e,"font-size",t[12](t[31])+"px"),c[0]&12&&le(e,"highlighted",t[3].includes(t[30]))},d(v){v&&d(e),i=!1,h()}}}function Ye(t){let e,l,s=t[2].length+"",i;return{c(){e=p("p"),l=G("50 out of "),i=G(s),this.h()},l(h){e=g(h,"P",{style:!0});var f=E(e);l=J(f,"50 out of "),i=J(f,s),f.forEach(d),this.h()},h(){ge(e,"border-top","1px solid"),ge(e,"padding-top","10px")},m(h,f){$(h,e,f),u(e,l),u(e,i)},p(h,f){f[0]&4&&s!==(s=h[2].length+"")&&oe(i,s)},d(h){h&&d(e)}}}function mt(t){let e,l,s,i="Reset",h,f,v="Copy Config",c,a,A,m,q="Cluster By:",N,W,se,T,y,ne,j=t[4].clusterBy+"",ae,ve,me,K,ie,X,ee,Ee="Move By:",ye,Y,Ce,U,Z,o,_=t[4].moveBy+"",V,Q,H,C,P,b,x,R,De,ce=te(t[6]),I=[];for(let r=0;r<ce.length;r+=1)I[r]=Je(Ge(t,ce,r));let ue=te(t[1]),w=[];for(let r=0;r<ue.length;r+=1)w[r]=We(Re(t,ue,r));let he=te(t[5]),L=[];for(let r=0;r<he.length;r+=1)L[r]=Ke(xe(t,he,r));let fe=te(t[2].slice(0,50).sort(Ze)),O=[];for(let r=0;r<fe.length;r+=1)O[r]=Xe(He(t,fe,r));let z=t[2].length>50&&Ye(t);return{c(){e=p("header"),l=p("div"),s=p("button"),s.textContent=i,h=F(),f=p("button"),f.textContent=v,c=F(),a=p("div"),A=p("div"),m=p("label"),m.textContent=q,N=F(),W=p("div");for(let r=0;r<I.length;r+=1)I[r].c();se=F(),T=p("div"),y=p("label"),ne=G("Values for "),ae=G(j),ve=G(":"),me=F(),K=p("div");for(let r=0;r<w.length;r+=1)w[r].c();ie=F(),X=p("div"),ee=p("label"),ee.textContent=Ee,ye=F(),Y=p("div");for(let r=0;r<L.length;r+=1)L[r].c();Ce=F(),U=p("div"),Z=p("label"),o=G("Filter "),V=G(_),Q=G(" By:"),H=F(),C=p("input"),P=F(),b=p("div");for(let r=0;r<O.length;r+=1)O[r].c();x=F(),z&&z.c(),this.h()},l(r){e=g(r,"HEADER",{class:!0});var S=E(e);l=g(S,"DIV",{class:!0});var n=E(l);s=g(n,"BUTTON",{class:!0,"data-svelte-h":!0}),be(s)!=="svelte-qy1k7w"&&(s.textContent=i),h=M(n),f=g(n,"BUTTON",{class:!0,"data-svelte-h":!0}),be(f)!=="svelte-18xqo2h"&&(f.textContent=v),n.forEach(d),c=M(S),a=g(S,"DIV",{class:!0});var B=E(a);A=g(B,"DIV",{class:!0});var Be=E(A);m=g(Be,"LABEL",{"data-svelte-h":!0}),be(m)!=="svelte-1ekr4iz"&&(m.textContent=q),N=M(Be),W=g(Be,"DIV",{class:!0});var Fe=E(W);for(let D=0;D<I.length;D+=1)I[D].l(Fe);Fe.forEach(d),Be.forEach(d),se=M(B),T=g(B,"DIV",{class:!0});var Ve=E(T);y=g(Ve,"LABEL",{});var Se=E(y);ne=J(Se,"Values for "),ae=J(Se,j),ve=J(Se,":"),Se.forEach(d),me=M(Ve),K=g(Ve,"DIV",{class:!0});var Me=E(K);for(let D=0;D<w.length;D+=1)w[D].l(Me);Me.forEach(d),Ve.forEach(d),ie=M(B),X=g(B,"DIV",{class:!0});var qe=E(X);ee=g(qe,"LABEL",{"data-svelte-h":!0}),be(ee)!=="svelte-8r6yw"&&(ee.textContent=Ee),ye=M(qe),Y=g(qe,"DIV",{class:!0});var Te=E(Y);for(let D=0;D<L.length;D+=1)L[D].l(Te);Te.forEach(d),qe.forEach(d),Ce=M(B),U=g(B,"DIV",{class:!0});var de=E(U);Z=g(de,"LABEL",{});var Ie=E(Z);o=J(Ie,"Filter "),V=J(Ie,_),Q=J(Ie," By:"),Ie.forEach(d),H=M(de),C=g(de,"INPUT",{type:!0,placeholder:!0,class:!0}),P=M(de),b=g(de,"DIV",{class:!0});var we=E(b);for(let D=0;D<O.length;D+=1)O[D].l(we);x=M(we),z&&z.l(we),we.forEach(d),de.forEach(d),B.forEach(d),S.forEach(d),this.h()},h(){k(s,"class","reset svelte-hplaxf"),k(f,"class","copy-config svelte-hplaxf"),k(l,"class","header-buttons svelte-hplaxf"),k(W,"class","options svelte-hplaxf"),k(A,"class","category svelte-hplaxf"),k(K,"class","options tiny svelte-hplaxf"),k(T,"class","filtered-cluster-values svelte-hplaxf"),k(Y,"class","options svelte-hplaxf"),k(X,"class","category svelte-hplaxf"),k(C,"type","text"),k(C,"placeholder","Enter your query"),C.value=t[0],k(C,"class","svelte-hplaxf"),k(b,"class","options tiny svelte-hplaxf"),k(U,"class","filtered-entities svelte-hplaxf"),k(a,"class","categories svelte-hplaxf"),k(e,"class","svelte-hplaxf")},m(r,S){$(r,e,S),u(e,l),u(l,s),u(l,h),u(l,f),u(e,c),u(e,a),u(a,A),u(A,m),u(A,N),u(A,W);for(let n=0;n<I.length;n+=1)I[n]&&I[n].m(W,null);u(a,se),u(a,T),u(T,y),u(y,ne),u(y,ae),u(y,ve),u(T,me),u(T,K);for(let n=0;n<w.length;n+=1)w[n]&&w[n].m(K,null);u(a,ie),u(a,X),u(X,ee),u(X,ye),u(X,Y);for(let n=0;n<L.length;n+=1)L[n]&&L[n].m(Y,null);u(a,Ce),u(a,U),u(U,Z),u(Z,o),u(Z,V),u(Z,Q),u(U,H),u(U,C),u(U,P),u(U,b);for(let n=0;n<O.length;n+=1)O[n]&&O[n].m(b,null);u(b,x),z&&z.m(b,null),R||(De=[re(s,"click",t[10]),re(f,"click",t[11]),re(C,"input",t[7])],R=!0)},p(r,S){if(S[0]&336){ce=te(r[6]);let n;for(n=0;n<ce.length;n+=1){const B=Ge(r,ce,n);I[n]?I[n].p(B,S):(I[n]=Je(B),I[n].c(),I[n].m(W,null))}for(;n<I.length;n+=1)I[n].d(1);I.length=ce.length}if(S[0]&16&&j!==(j=r[4].clusterBy+"")&&oe(ae,j),S[0]&8722){ue=te(r[1]);let n;for(n=0;n<ue.length;n+=1){const B=Re(r,ue,n);w[n]?w[n].p(B,S):(w[n]=We(B),w[n].c(),w[n].m(K,null))}for(;n<w.length;n+=1)w[n].d(1);w.length=ue.length}if(S[0]&304){he=te(r[5]);let n;for(n=0;n<he.length;n+=1){const B=xe(r,he,n);L[n]?L[n].p(B,S):(L[n]=Ke(B),L[n].c(),L[n].m(Y,null))}for(;n<L.length;n+=1)L[n].d(1);L.length=he.length}if(S[0]&16&&_!==(_=r[4].moveBy+"")&&oe(V,_),S[0]&1&&C.value!==r[0]&&(C.value=r[0]),S[0]&4108){fe=te(r[2].slice(0,50).sort(Ze));let n;for(n=0;n<fe.length;n+=1){const B=He(r,fe,n);O[n]?O[n].p(B,S):(O[n]=Xe(B),O[n].c(),O[n].m(b,x))}for(;n<O.length;n+=1)O[n].d(1);O.length=fe.length}r[2].length>50?z?z.p(r,S):(z=Ye(r),z.c(),z.m(b,null)):z&&(z.d(1),z=null)},i:ze,o:ze,d(r){r&&d(e),Le(I,r),Le(w,r),Le(L,r),Le(O,r),z&&z.d(),R=!1,ot(De)}}}const Ae=12,yt=30,Ne=12,Ct=30,Ze=([t],[e])=>t.localeCompare(e);function bt(t,e,l){let s,i,h,f,v,c,a,A,m,q,N,W,se,T,y,ne;ke(t,_e,o=>l(3,se=o)),ke(t,Qe,o=>l(18,T=o)),ke(t,pe,o=>l(4,y=o)),ke(t,ht,o=>l(19,ne=o));let j=y.queryValue||"";function ae(o){o.target.value.length>3&&(l(0,j=o.target.value),pe.update(_=>({..._,queryValue:j})))}const ve=[],me=[];function K(o,_){X(),_e.set([]),o==="clusterBy"?pe.update(V=>({...V,clusterBy:_})):o==="moveBy"&&pe.update(V=>({...V,moveBy:_}))}function ie(o){pe.update(H=>({...H,selectedClusterValue:o}));const _=j.toLowerCase(),V=y.queryCategory||"name",Q=[];Object.entries(je(Qe)).forEach(([H,C])=>{const P=C.dataPoints.some(x=>{var R;return((R=x[y.clusterBy])==null?void 0:R.toString())===o.toString()}),b=C.dataPoints.some(x=>{var R;return(R=x[V])==null?void 0:R.toString().toLowerCase().includes(_)});P&&b&&(Q.push(H),C.currentCategoryIndex=0,C.t=0,C.trail=[])}),_e.set(Q)}function X(){pe.update(o=>({...o,queryValue:"",selectedClusterValue:null})),l(0,j=""),_e.set([])}function ee(){const o={title:"",description:"",methodology:"",media:!0,config:{clusterBy:y.clusterBy,moveBy:y.moveBy,selectedClusterValue:y.selectedClusterValue||"",queryValue:j,queryCategory:y.queryCategory||"name",speed:y.speed||3,stroke:y.stroke||1,loops:y.loopsToComplete||1,highlightedEntities:je(_e)}},_=JSON.stringify(o,null,2);navigator.clipboard.writeText(_).then(()=>{alert("Config copied to clipboard!")}).catch(V=>{console.error("Could not copy text: ",V)})}function Ee(o){return a===A?Ae:Ae+(o-a)*(yt-Ae)/(A-a)}function ye(o){return N===W?Ne:Ne+(o-N)*(Ct-Ne)/(W-N)}const Y=o=>K("clusterBy",o),Ce=o=>ie(o),U=o=>K("moveBy",o),Z=o=>_e.set([o]);return t.$$.update=()=>{t.$$.dirty[0]&524288&&l(15,h=ne.map(([o])=>o)),t.$$.dirty[0]&262161&&l(17,f=Object.entries(T).filter(([o,_])=>{const V=y.selectedClusterValue?_.dataPoints.some(P=>{var b;return((b=P[y.clusterBy])==null?void 0:b.toString())===y.selectedClusterValue.toString()}):!0,Q=j.toLowerCase(),H=y.queryCategory||"name",C=Q.length>=3?_.dataPoints.some(P=>{var b;return(b=P[H])==null?void 0:b.toString().toLowerCase().includes(Q)}):!0;return V&&C}).reduce((o,[_,V])=>(o[_]=V,o),{})),t.$$.dirty[0]&131072&&l(2,v=Object.entries(f).map(([o,_])=>[o,_.dataPoints.length])),t.$$.dirty[0]&4&&l(16,c=v.map(([o,_])=>_)),t.$$.dirty[0]&65536&&(a=c.length>0?Math.min(...c):0),t.$$.dirty[0]&65536&&(A=c.length>0?Math.max(...c):1),t.$$.dirty[0]&294920&&l(1,m=(()=>{const o=Object.values(T),_=new Set(se),V=_.size>0;let Q=h;const H=[];V&&(Q=h.filter(C=>{for(let P=0;P<o.length;P++){const b=o[P];if(_.has(b.moveBy)&&b.categories.includes(C))return!0}return!1}));for(let C=0;C<Q.length;C++){const P=Q[C];let b=0;for(let x=0;x<o.length;x++){const R=o[x];(!V||_.has(R.moveBy))&&R.categories.includes(P)&&b++}H.push([P,b])}return H})()),t.$$.dirty[0]&2&&l(14,q=m.map(([o,_])=>_)),t.$$.dirty[0]&16384&&(N=q.length>0?Math.min(...q):0),t.$$.dirty[0]&16384&&(W=q.length>0?Math.max(...q):1)},l(6,s=gt.filter(o=>!ve.includes(o))),l(5,i=vt.filter(o=>!me.includes(o))),[j,m,v,se,y,i,s,ae,K,ie,X,ee,Ee,ye,q,h,c,f,T,ne,Y,Ce,U,Z]}class kt extends et{constructor(e){super(),tt(this,e,bt,mt,$e,{},null,[-1,-1])}}function Et(t){let e,l="Loading...";return{c(){e=p("p"),e.textContent=l,this.h()},l(s){e=g(s,"P",{class:!0,"data-svelte-h":!0}),be(e)!=="svelte-qdsr2u"&&(e.textContent=l),this.h()},h(){k(e,"class","svelte-13tgnqv")},m(s,i){$(s,e,i)},i:ze,o:ze,d(s){s&&d(e)}}}function Bt(t){let e,l,s;return l=new pt({}),{c(){e=p("div"),lt(l.$$.fragment),this.h()},l(i){e=g(i,"DIV",{class:!0});var h=E(e);st(l.$$.fragment,h),h.forEach(d),this.h()},h(){k(e,"class","svelte-13tgnqv")},m(i,h){$(i,e,h),nt(l,e,null),s=!0},i(i){s||(Pe(l.$$.fragment,i),s=!0)},o(i){Oe(l.$$.fragment,i),s=!1},d(i){i&&d(e),rt(l)}}}function Vt(t){let e,l,s,i,h,f,v;const c=[Bt,Et],a=[];function A(m,q){return m[0].length>0?0:1}return l=A(t),s=a[l]=c[l](t),f=new kt({}),{c(){e=p("main"),s.c(),i=F(),h=p("div"),lt(f.$$.fragment),this.h()},l(m){e=g(m,"MAIN",{});var q=E(e);s.l(q),i=M(q),h=g(q,"DIV",{class:!0});var N=E(h);st(f.$$.fragment,N),N.forEach(d),q.forEach(d),this.h()},h(){k(h,"class","svelte-13tgnqv")},m(m,q){$(m,e,q),a[l].m(e,null),u(e,i),u(e,h),nt(f,h,null),v=!0},p(m,[q]){let N=l;l=A(m),l!==N&&(ct(),Oe(a[N],1,1,()=>{a[N]=null}),it(),s=a[l],s||(s=a[l]=c[l](m),s.c()),Pe(s,1),s.m(e,i))},i(m){v||(Pe(s),Pe(f.$$.fragment,m),v=!0)},o(m){Oe(s),Oe(f.$$.fragment,m),v=!1},d(m){m&&d(e),a[l].d(),rt(f)}}}function St(t,e,l){let s;return ke(t,Ue,i=>l(0,s=i)),at(async()=>{const i=await _t(ut+"/data/update-until-2022/data.tsv");Ue.set(i),ft.set(window.innerWidth),dt.set(600)}),[s]}class At extends et{constructor(e){super(),tt(this,e,St,Vt,$e,{})}}export{At as component};
