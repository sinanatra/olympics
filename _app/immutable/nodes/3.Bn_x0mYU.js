import{s as et,e as k,t as Q,a as N,c as C,b as V,d as G,f as _,g as T,l as Se,m as y,i as $,h as u,E as ce,j as se,n as Ne,B as ze,F as it,k as Be,G as ve,r as ye,I as Me,q as at}from"../chunks/scheduler.evRM0l9T.js";import{S as tt,i as lt,b as st,d as nt,m as rt,t as Fe,c as ct,a as Le,e as ot,g as ut}from"../chunks/index.aiZKxZDj.js";import{b as ht}from"../chunks/paths.BwAfQeKw.js";import{c as te,h as me,e as Ue,b as ft,d as Qe,w as dt,a as gt}from"../chunks/stores.D9mTdjSf.js";import{t as pt,S as _t}from"../chunks/dsv.BK2Qwquv.js";import{e as le}from"../chunks/each.D6YF6ztN.js";import{f as mt,a as vt}from"../chunks/constants.CA4Cg4R8.js";function Ge(t,e,l){const n=t.slice();return n[33]=e[l][0],n[34]=e[l][1],n}function He(t,e,l){const n=t.slice();return n[34]=e[l][0],n[37]=e[l][1],n}function Re(t,e,l){const n=t.slice();return n[40]=e[l],n}function Je(t,e,l){const n=t.slice();return n[43]=e[l],n}function We(t){let e,l=t[43].label+"",n,i,a,h="x",d,f,c;function J(){return t[22](t[43])}return{c(){e=k("span"),n=Q(l),i=N(),a=k("button"),a.textContent=h,d=N(),this.h()},l(m){e=C(m,"SPAN",{class:!0});var g=V(e);n=G(g,l),i=T(g),a=C(g,"BUTTON",{class:!0,"data-svelte-h":!0}),Se(a)!=="svelte-1drtrua"&&(a.textContent=h),d=T(g),g.forEach(_),this.h()},h(){y(a,"class","svelte-hkg2yx"),y(e,"class","filter svelte-hkg2yx")},m(m,g){$(m,e,g),u(e,n),u(e,i),u(e,a),u(e,d),f||(c=ce(e,"click",J),f=!0)},p(m,g){t=m,g[0]&8&&l!==(l=t[43].label+"")&&se(n,l)},d(m){m&&_(e),f=!1,c()}}}function Ke(t){let e,l=t[40]+"",n,i,a,h;function d(){return t[23](t[40])}return{c(){e=k("span"),n=Q(l),i=N(),this.h()},l(f){e=C(f,"SPAN",{class:!0});var c=V(e);n=G(c,l),i=T(c),c.forEach(_),this.h()},h(){y(e,"class","svelte-hkg2yx"),ve(e,"selected",t[40]===t[4].clusterBy)},m(f,c){$(f,e,c),u(e,n),u(e,i),a||(h=ce(e,"click",d),a=!0)},p(f,c){t=f,c[0]&128&&l!==(l=t[40]+"")&&se(n,l),c[0]&144&&ve(e,"selected",t[40]===t[4].clusterBy)},d(f){f&&_(e),a=!1,h()}}}function Xe(t){let e,l=t[34]+"",n,i,a,h;function d(){return t[24](t[34])}return{c(){e=k("span"),n=Q(l),i=N(),this.h()},l(f){e=C(f,"SPAN",{style:!0,class:!0});var c=V(e);n=G(c,l),i=T(c),c.forEach(_),this.h()},h(){ye(e,"font-size",t[15](t[37])+"px"),y(e,"class","svelte-hkg2yx"),ve(e,"highlighted",t[34]==t[4].selectedClusterValue)},m(f,c){$(f,e,c),u(e,n),u(e,i),a||(h=ce(e,"click",d),a=!0)},p(f,c){t=f,c[0]&2&&l!==(l=t[34]+"")&&se(n,l),c[0]&2&&ye(e,"font-size",t[15](t[37])+"px"),c[0]&18&&ve(e,"highlighted",t[34]==t[4].selectedClusterValue)},d(f){f&&_(e),a=!1,h()}}}function Ye(t){let e,l=t[33]+"",n,i,a;function h(){return t[25](t[33])}return{c(){e=k("span"),n=Q(l),this.h()},l(d){e=C(d,"SPAN",{style:!0,class:!0});var f=V(e);n=G(f,l),f.forEach(_),this.h()},h(){ye(e,"font-size",t[14](t[34])+"px"),y(e,"class","svelte-hkg2yx"),ve(e,"highlighted",t[5].includes(t[33]))},m(d,f){$(d,e,f),u(e,n),i||(a=ce(e,"click",h),i=!0)},p(d,f){t=d,f[0]&4&&l!==(l=t[33]+"")&&se(n,l),f[0]&4&&ye(e,"font-size",t[14](t[34])+"px"),f[0]&36&&ve(e,"highlighted",t[5].includes(t[33]))},d(d){d&&_(e),i=!1,a()}}}function Ze(t){let e,l,n=t[2].length+"",i;return{c(){e=k("p"),l=Q("50 out of "),i=Q(n),this.h()},l(a){e=C(a,"P",{style:!0});var h=V(e);l=G(h,"50 out of "),i=G(h,n),h.forEach(_),this.h()},h(){ye(e,"border-top","1px solid"),ye(e,"padding-top","10px")},m(a,h){$(a,e,h),u(e,l),u(e,i)},p(a,h){h[0]&4&&n!==(n=a[2].length+"")&&se(i,n)},d(a){a&&_(e)}}}function yt(t){let e,l,n,i,a,h,d,f,c,J="Reset",m,g,x="Copy Config",ne,M,v,U,re="Cluster By:",oe,q,ke,W,K,ue,ee=t[4].clusterBy+"",ie,Ce,be,Z,Ve,H,X,Ee,ae=t[4].moveBy+"",r,p,E,B,R,b,I,P,Y,A=le(t[3]),w=[];for(let o=0;o<A.length;o+=1)w[o]=We(Je(t,A,o));let he=le(t[7]),O=[];for(let o=0;o<he.length;o+=1)O[o]=Ke(Re(t,he,o));let fe=le(t[1]),z=[];for(let o=0;o<fe.length;o+=1)z[o]=Xe(He(t,fe,o));let de=le(t[2].slice(0,50).sort($e)),F=[];for(let o=0;o<de.length;o+=1)F[o]=Ye(Ge(t,de,o));let L=t[2].length>50&&Ze(t);return{c(){e=k("header"),l=k("div"),n=k("div"),i=Q(t[6]),a=N(),h=k("div"),d=k("div");for(let o=0;o<w.length;o+=1)w[o].c();f=N(),c=k("button"),c.textContent=J,m=N(),g=k("button"),g.textContent=x,ne=N(),M=k("div"),v=k("div"),U=k("label"),U.textContent=re,oe=N(),q=k("div");for(let o=0;o<O.length;o+=1)O[o].c();ke=N(),W=k("div"),K=k("label"),ue=Q("Filter "),ie=Q(ee),Ce=Q(":"),be=N(),Z=k("div");for(let o=0;o<z.length;o+=1)z[o].c();Ve=N(),H=k("div"),X=k("label"),Ee=Q("Filter "),r=Q(ae),p=Q(":"),E=N(),B=k("input"),R=N(),b=k("div");for(let o=0;o<F.length;o+=1)F[o].c();I=N(),L&&L.c(),this.h()},l(o){e=C(o,"HEADER",{class:!0});var S=V(e);l=C(S,"DIV",{class:!0});var s=V(l);n=C(s,"DIV",{class:!0});var j=V(n);i=G(j,t[6]),j.forEach(_),a=T(s),h=C(s,"DIV",{class:!0});var ge=V(h);d=C(ge,"DIV",{class:!0});var De=V(d);for(let D=0;D<w.length;D+=1)w[D].l(De);De.forEach(_),f=T(ge),c=C(ge,"BUTTON",{class:!0,"data-svelte-h":!0}),Se(c)!=="svelte-qy1k7w"&&(c.textContent=J),m=T(ge),g=C(ge,"BUTTON",{class:!0,"data-svelte-h":!0}),Se(g)!=="svelte-i2notl"&&(g.textContent=x),ge.forEach(_),s.forEach(_),ne=T(S),M=C(S,"DIV",{class:!0});var pe=V(M);v=C(pe,"DIV",{class:!0});var qe=V(v);U=C(qe,"LABEL",{class:!0,"data-svelte-h":!0}),Se(U)!=="svelte-1ekr4iz"&&(U.textContent=re),oe=T(qe),q=C(qe,"DIV",{class:!0});var xe=V(q);for(let D=0;D<O.length;D+=1)O[D].l(xe);xe.forEach(_),qe.forEach(_),ke=T(pe),W=C(pe,"DIV",{class:!0});var Ie=V(W);K=C(Ie,"LABEL",{class:!0});var Pe=V(K);ue=G(Pe,"Filter "),ie=G(Pe,ee),Ce=G(Pe,":"),Pe.forEach(_),be=T(Ie),Z=C(Ie,"DIV",{class:!0});var je=V(Z);for(let D=0;D<z.length;D+=1)z[D].l(je);je.forEach(_),Ie.forEach(_),Ve=T(pe),H=C(pe,"DIV",{class:!0});var _e=V(H);X=C(_e,"LABEL",{class:!0});var we=V(X);Ee=G(we,"Filter "),r=G(we,ae),p=G(we,":"),we.forEach(_),E=T(_e),B=C(_e,"INPUT",{type:!0,placeholder:!0,class:!0}),R=T(_e),b=C(_e,"DIV",{class:!0});var Oe=V(b);for(let D=0;D<F.length;D+=1)F[D].l(Oe);I=T(Oe),L&&L.l(Oe),Oe.forEach(_),_e.forEach(_),pe.forEach(_),S.forEach(_),this.h()},h(){y(n,"class","methodology svelte-hkg2yx"),y(d,"class","active-filters svelte-hkg2yx"),y(c,"class","reset svelte-hkg2yx"),y(g,"class","copy-config svelte-hkg2yx"),y(h,"class","header-buttons svelte-hkg2yx"),y(l,"class","header-info svelte-hkg2yx"),y(U,"class","svelte-hkg2yx"),y(q,"class","options svelte-hkg2yx"),y(v,"class","category svelte-hkg2yx"),y(K,"class","svelte-hkg2yx"),y(Z,"class","options tiny svelte-hkg2yx"),y(W,"class","filtered-cluster-values svelte-hkg2yx"),y(X,"class","svelte-hkg2yx"),y(B,"type","text"),y(B,"placeholder","Enter your query"),B.value=t[0],y(B,"class","svelte-hkg2yx"),y(b,"class","options tiny svelte-hkg2yx"),y(H,"class","filtered-entities svelte-hkg2yx"),y(M,"class","categories svelte-hkg2yx"),y(e,"class","svelte-hkg2yx")},m(o,S){$(o,e,S),u(e,l),u(l,n),u(n,i),u(l,a),u(l,h),u(h,d);for(let s=0;s<w.length;s+=1)w[s]&&w[s].m(d,null);u(h,f),u(h,c),u(h,m),u(h,g),u(e,ne),u(e,M),u(M,v),u(v,U),u(v,oe),u(v,q);for(let s=0;s<O.length;s+=1)O[s]&&O[s].m(q,null);u(M,ke),u(M,W),u(W,K),u(K,ue),u(K,ie),u(K,Ce),u(W,be),u(W,Z);for(let s=0;s<z.length;s+=1)z[s]&&z[s].m(Z,null);u(M,Ve),u(M,H),u(H,X),u(X,Ee),u(X,r),u(X,p),u(H,E),u(H,B),u(H,R),u(H,b);for(let s=0;s<F.length;s+=1)F[s]&&F[s].m(b,null);u(b,I),L&&L.m(b,null),P||(Y=[ce(c,"click",t[12]),ce(g,"click",t[13]),ce(B,"input",t[8])],P=!0)},p(o,S){if(S[0]&64&&se(i,o[6]),S[0]&1032){A=le(o[3]);let s;for(s=0;s<A.length;s+=1){const j=Je(o,A,s);w[s]?w[s].p(j,S):(w[s]=We(j),w[s].c(),w[s].m(d,null))}for(;s<w.length;s+=1)w[s].d(1);w.length=A.length}if(S[0]&656){he=le(o[7]);let s;for(s=0;s<he.length;s+=1){const j=Re(o,he,s);O[s]?O[s].p(j,S):(O[s]=Ke(j),O[s].c(),O[s].m(q,null))}for(;s<O.length;s+=1)O[s].d(1);O.length=he.length}if(S[0]&16&&ee!==(ee=o[4].clusterBy+"")&&se(ie,ee),S[0]&34834){fe=le(o[1]);let s;for(s=0;s<fe.length;s+=1){const j=He(o,fe,s);z[s]?z[s].p(j,S):(z[s]=Xe(j),z[s].c(),z[s].m(Z,null))}for(;s<z.length;s+=1)z[s].d(1);z.length=fe.length}if(S[0]&16&&ae!==(ae=o[4].moveBy+"")&&se(r,ae),S[0]&1&&B.value!==o[0]&&(B.value=o[0]),S[0]&16420){de=le(o[2].slice(0,50).sort($e));let s;for(s=0;s<de.length;s+=1){const j=Ge(o,de,s);F[s]?F[s].p(j,S):(F[s]=Ye(j),F[s].c(),F[s].m(b,I))}for(;s<F.length;s+=1)F[s].d(1);F.length=de.length}o[2].length>50?L?L.p(o,S):(L=Ze(o),L.c(),L.m(b,null)):L&&(L.d(1),L=null)},i:Ne,o:Ne,d(o){o&&_(e),ze(w,o),ze(O,o),ze(z,o),ze(F,o),L&&L.d(),P=!1,it(Y)}}}const Te=12,kt=30,Ae=12,Ct=30;function bt(t){return Object.values(t).reduce((e,l)=>e+l.dataPoints.length,0)}function Vt(t,e){const l={city:"cities",sport:"sports",height:"heights",noc:"NOCs",team:"teams",weight:"weights",year:"years",age:"ages",event:"events",medal:"medals",name:"names"};return t===1?e:l[e]||`${e}s`}function Et(t){return t.clusterBy?t.clusterBy:"all clusters"}function Bt(t){return t.moveBy?t.moveBy:"participants"}const $e=([t],[e])=>t.localeCompare(e);function St(t,e,l){let n,i,a,h,d,f,c,J,m,g,x,ne,M,v,U,re,oe;Be(t,te,r=>l(4,v=r)),Be(t,me,r=>l(5,U=r)),Be(t,Ue,r=>l(20,re=r)),Be(t,ft,r=>l(21,oe=r));let q=v.queryValue||"";function ke(r){r.target.value.length>3&&(l(0,q=r.target.value),te.update(p=>({...p,queryValue:q})))}const W=[],K=[];function ue(r,p){r==="clusterBy"?te.update(E=>({...E,clusterBy:p})):r==="moveBy"&&te.update(E=>({...E,moveBy:p}))}function ee(r){r.type==="clusterValue"?te.update(p=>({...p,selectedClusterValue:null})):r.type==="query"?(l(0,q=""),te.update(p=>({...p,queryValue:""}))):r.type==="name"&&me.set([])}function ie(r){te.update(R=>({...R,selectedClusterValue:r}));const p=q.toLowerCase(),E=v.queryCategory||"name",B=[];Object.entries(Me(Ue)).forEach(([R,b])=>{const I=b.dataPoints.some(Y=>{var A;return((A=Y[v.clusterBy])==null?void 0:A.toString())===r.toString()}),P=b.dataPoints.some(Y=>{var A;return(A=Y[E])==null?void 0:A.toString().toLowerCase().includes(p)});I&&P&&(B.push(R),b.currentCategoryIndex=0,b.t=0,b.trail=[])}),me.set(B)}function Ce(){te.update(r=>({...r,queryValue:"",selectedClusterValue:null})),l(0,q=""),me.set([])}function be(){const r={title:"",description:"",methodology:"",media:!0,config:{clusterBy:v.clusterBy,moveBy:v.moveBy,selectedClusterValue:v.selectedClusterValue||"",queryValue:q,queryCategory:v.queryCategory||"name",speed:v.speed||3,stroke:v.stroke||1,loops:v.loopsToComplete||1,highlightedEntities:Me(me)}},p=JSON.stringify(r,null,2);navigator.clipboard.writeText(p).then(()=>{alert("Config copied to clipboard!")}).catch(E=>{console.error("Could not copy text: ",E)})}function Z(r){return c===J?Te:Te+(r-c)*(kt-Te)/(J-c)}function Ve(r){return x===ne?Ae:Ae+(r-x)*(Ct-Ae)/(ne-x)}const H=r=>ee(r),X=r=>ue("clusterBy",r),Ee=r=>ie(r),ae=r=>me.set([r]);return t.$$.update=()=>{t.$$.dirty[0]&2097152&&l(18,i=oe.map(([r])=>r)),t.$$.dirty[0]&1048593&&l(16,a=Object.entries(re).filter(([r,p])=>{const E=v.selectedClusterValue?p.dataPoints.some(I=>{var P;return((P=I[v.clusterBy])==null?void 0:P.toString())===v.selectedClusterValue.toString()}):!0,B=q.toLowerCase(),R=v.queryCategory||"name",b=B.length>=3?p.dataPoints.some(I=>{var P;return(P=I[R])==null?void 0:P.toString().toLowerCase().includes(B)}):!0;return E&&b}).reduce((r,[p,E])=>(r[p]=E,r),{})),t.$$.dirty[0]&57&&(l(3,h=[]),v.selectedClusterValue&&h.push({label:`${v.selectedClusterValue}`,type:"clusterValue"}),q&&h.push({label:`${q}`,type:"query"}),U.length===1&&h.push({label:`${U[0]}`,type:"name"})),t.$$.dirty[0]&65536&&l(2,d=Object.entries(a).map(([r,p])=>[r,p.dataPoints.length])),t.$$.dirty[0]&4&&l(19,f=d.map(([r,p])=>p)),t.$$.dirty[0]&524288&&(c=f.length>0?Math.min(...f):0),t.$$.dirty[0]&524288&&(J=f.length>0?Math.max(...f):1),t.$$.dirty[0]&1310752&&l(1,m=(()=>{const r=Object.values(re),p=new Set(U),E=p.size>0;let B=i;const R=[];E&&(B=i.filter(b=>{for(let I=0;I<r.length;I++){const P=r[I];if(p.has(P.moveBy)&&P.categories.includes(b))return!0}return!1}));for(let b=0;b<B.length;b++){const I=B[b];let P=0;for(let Y=0;Y<r.length;Y++){const A=r[Y];(!E||p.has(A.moveBy))&&A.categories.includes(I)&&P++}R.push([I,P])}return R})()),t.$$.dirty[0]&2&&l(17,g=m.map(([r,p])=>p)),t.$$.dirty[0]&131072&&(x=g.length>0?Math.min(...g):0),t.$$.dirty[0]&131072&&(ne=g.length>0?Math.max(...g):1),t.$$.dirty[0]&65552&&l(6,M=(()=>{const r=Et(v),p=Bt(v),E=bt(a);return`This visualization represents ${E} ${Vt(E,"participant")}, grouped by ${p} across ${r}.`})())},l(7,n=mt.filter(r=>!W.includes(r))),vt.filter(r=>!K.includes(r)),l(3,h=[]),[q,m,d,h,v,U,M,n,ke,ue,ee,ie,Ce,be,Z,Ve,a,g,i,f,re,oe,H,X,Ee,ae]}class qt extends tt{constructor(e){super(),lt(this,e,St,yt,et,{},null,[-1,-1])}}function It(t){let e,l="Loading...";return{c(){e=k("p"),e.textContent=l,this.h()},l(n){e=C(n,"P",{class:!0,"data-svelte-h":!0}),Se(e)!=="svelte-qdsr2u"&&(e.textContent=l),this.h()},h(){y(e,"class","svelte-13tgnqv")},m(n,i){$(n,e,i)},i:Ne,o:Ne,d(n){n&&_(e)}}}function Pt(t){let e,l,n;return l=new _t({}),{c(){e=k("div"),st(l.$$.fragment),this.h()},l(i){e=C(i,"DIV",{class:!0});var a=V(e);nt(l.$$.fragment,a),a.forEach(_),this.h()},h(){y(e,"class","svelte-13tgnqv")},m(i,a){$(i,e,a),rt(l,e,null),n=!0},i(i){n||(Le(l.$$.fragment,i),n=!0)},o(i){Fe(l.$$.fragment,i),n=!1},d(i){i&&_(e),ot(l)}}}function wt(t){let e,l,n,i,a,h,d;const f=[Pt,It],c=[];function J(m,g){return m[0].length>0?0:1}return l=J(t),n=c[l]=f[l](t),h=new qt({}),{c(){e=k("main"),n.c(),i=N(),a=k("div"),st(h.$$.fragment),this.h()},l(m){e=C(m,"MAIN",{});var g=V(e);n.l(g),i=T(g),a=C(g,"DIV",{class:!0});var x=V(a);nt(h.$$.fragment,x),x.forEach(_),g.forEach(_),this.h()},h(){y(a,"class","svelte-13tgnqv")},m(m,g){$(m,e,g),c[l].m(e,null),u(e,i),u(e,a),rt(h,a,null),d=!0},p(m,[g]){let x=l;l=J(m),l!==x&&(ut(),Fe(c[x],1,1,()=>{c[x]=null}),ct(),n=c[l],n||(n=c[l]=f[l](m),n.c()),Le(n,1),n.m(e,i))},i(m){d||(Le(n),Le(h.$$.fragment,m),d=!0)},o(m){Fe(n),Fe(h.$$.fragment,m),d=!1},d(m){m&&_(e),c[l].d(),ot(h)}}}function Ot(t,e,l){let n;return Be(t,Qe,i=>l(0,n=i)),at(async()=>{const a=(await pt(ht+"/data/update-until-2022/data.tsv")).map(h=>{const d={};for(const[f,c]of Object.entries(h))d[f]=c!=null&&c.trim()?c:"NA";return d});Qe.set(a),dt.set(window.innerWidth),gt.set(600)}),[n]}class xt extends tt{constructor(e){super(),lt(this,e,Ot,wt,et,{})}}export{xt as component};
