import{s as tt,e as k,t as Q,a as T,c as C,b as V,d as H,f as _,g as A,l as Se,m as y,i as $,h as u,E as ce,j as se,n as Ne,B as ze,F as at,k as Be,G as ye,r as ke,I as Me,q as ct}from"../chunks/scheduler.evRM0l9T.js";import{S as lt,i as st,b as nt,d as rt,m as ot,t as Fe,c as ut,a as Le,e as it,g as ht}from"../chunks/index.aiZKxZDj.js";import{b as ft}from"../chunks/paths.B-U6-FcK.js";import{h as ve,c as te,e as Ue,b as dt,d as Qe,w as gt,a as pt}from"../chunks/stores.D9mTdjSf.js";import{t as _t,S as mt}from"../chunks/dsv.sLneVvC_.js";import{e as le}from"../chunks/each.D6YF6ztN.js";import{f as vt,a as yt}from"../chunks/constants.CA4Cg4R8.js";function He(t,e,l){const n=t.slice();return n[33]=e[l][0],n[34]=e[l][1],n}function Re(t,e,l){const n=t.slice();return n[34]=e[l][0],n[37]=e[l][1],n}function Ge(t,e,l){const n=t.slice();return n[40]=e[l],n}function Je(t,e,l){const n=t.slice();return n[43]=e[l],n}function We(t){let e,l=t[43].label+"",n,i,a,h="x",d,f,c;function J(){return t[22](t[43])}return{c(){e=k("span"),n=Q(l),i=T(),a=k("button"),a.textContent=h,d=T(),this.h()},l(m){e=C(m,"SPAN",{class:!0});var g=V(e);n=H(g,l),i=A(g),a=C(g,"BUTTON",{class:!0,"data-svelte-h":!0}),Se(a)!=="svelte-1drtrua"&&(a.textContent=h),d=A(g),g.forEach(_),this.h()},h(){y(a,"class","svelte-hkg2yx"),y(e,"class","filter svelte-hkg2yx")},m(m,g){$(m,e,g),u(e,n),u(e,i),u(e,a),u(e,d),f||(c=ce(e,"click",J),f=!0)},p(m,g){t=m,g[0]&8&&l!==(l=t[43].label+"")&&se(n,l)},d(m){m&&_(e),f=!1,c()}}}function Ke(t){let e,l=t[40]+"",n,i,a,h;function d(){return t[23](t[40])}return{c(){e=k("span"),n=Q(l),i=T(),this.h()},l(f){e=C(f,"SPAN",{class:!0});var c=V(e);n=H(c,l),i=A(c),c.forEach(_),this.h()},h(){y(e,"class","svelte-hkg2yx"),ye(e,"selected",t[40]===t[5].clusterBy)},m(f,c){$(f,e,c),u(e,n),u(e,i),a||(h=ce(e,"click",d),a=!0)},p(f,c){t=f,c[0]&128&&l!==(l=t[40]+"")&&se(n,l),c[0]&160&&ye(e,"selected",t[40]===t[5].clusterBy)},d(f){f&&_(e),a=!1,h()}}}function Xe(t){let e,l=t[34]+"",n,i,a,h;function d(){return t[24](t[34])}return{c(){e=k("span"),n=Q(l),i=T(),this.h()},l(f){e=C(f,"SPAN",{style:!0,class:!0});var c=V(e);n=H(c,l),i=A(c),c.forEach(_),this.h()},h(){ke(e,"font-size",t[15](t[37])+"px"),y(e,"class","svelte-hkg2yx"),ye(e,"highlighted",t[34]==t[5].selectedClusterValue)},m(f,c){$(f,e,c),u(e,n),u(e,i),a||(h=ce(e,"click",d),a=!0)},p(f,c){t=f,c[0]&2&&l!==(l=t[34]+"")&&se(n,l),c[0]&2&&ke(e,"font-size",t[15](t[37])+"px"),c[0]&34&&ye(e,"highlighted",t[34]==t[5].selectedClusterValue)},d(f){f&&_(e),a=!1,h()}}}function Ye(t){let e,l=t[33]+"",n,i,a;function h(){return t[25](t[33])}return{c(){e=k("span"),n=Q(l),this.h()},l(d){e=C(d,"SPAN",{style:!0,class:!0});var f=V(e);n=H(f,l),f.forEach(_),this.h()},h(){ke(e,"font-size",t[14](t[34])+"px"),y(e,"class","svelte-hkg2yx"),ye(e,"highlighted",t[4].includes(t[33]))},m(d,f){$(d,e,f),u(e,n),i||(a=ce(e,"click",h),i=!0)},p(d,f){t=d,f[0]&4&&l!==(l=t[33]+"")&&se(n,l),f[0]&4&&ke(e,"font-size",t[14](t[34])+"px"),f[0]&20&&ye(e,"highlighted",t[4].includes(t[33]))},d(d){d&&_(e),i=!1,a()}}}function Ze(t){let e,l,n=t[2].length+"",i;return{c(){e=k("p"),l=Q("50 out of "),i=Q(n),this.h()},l(a){e=C(a,"P",{style:!0});var h=V(e);l=H(h,"50 out of "),i=H(h,n),h.forEach(_),this.h()},h(){ke(e,"border-top","1px solid"),ke(e,"padding-top","10px")},m(a,h){$(a,e,h),u(e,l),u(e,i)},p(a,h){h[0]&4&&n!==(n=a[2].length+"")&&se(i,n)},d(a){a&&_(e)}}}function kt(t){let e,l,n,i,a,h,d,f,c,J="Reset",m,g,j="Copy Config",ne,U,L,v,re="Cluster By:",oe,q,Ce,W,K,ue,ee=t[5].clusterBy+"",ie,he,be,Z,Ve,R,X,Ee,ae=t[5].moveBy+"",r,p,S,E,G,b,I,P,Y,D=le(t[3]),w=[];for(let o=0;o<D.length;o+=1)w[o]=We(Je(t,D,o));let fe=le(t[7]),O=[];for(let o=0;o<fe.length;o+=1)O[o]=Ke(Ge(t,fe,o));let de=le(t[1]),z=[];for(let o=0;o<de.length;o+=1)z[o]=Xe(Re(t,de,o));let ge=le(t[2].slice(0,50).sort(et)),F=[];for(let o=0;o<ge.length;o+=1)F[o]=Ye(He(t,ge,o));let N=t[2].length>50&&Ze(t);return{c(){e=k("header"),l=k("div"),n=k("div"),i=Q(t[6]),a=T(),h=k("div"),d=k("div");for(let o=0;o<w.length;o+=1)w[o].c();f=T(),c=k("button"),c.textContent=J,m=T(),g=k("button"),g.textContent=j,ne=T(),U=k("div"),L=k("div"),v=k("label"),v.textContent=re,oe=T(),q=k("div");for(let o=0;o<O.length;o+=1)O[o].c();Ce=T(),W=k("div"),K=k("label"),ue=Q("Filter "),ie=Q(ee),he=Q(":"),be=T(),Z=k("div");for(let o=0;o<z.length;o+=1)z[o].c();Ve=T(),R=k("div"),X=k("label"),Ee=Q("Filter "),r=Q(ae),p=Q(":"),S=T(),E=k("input"),G=T(),b=k("div");for(let o=0;o<F.length;o+=1)F[o].c();I=T(),N&&N.c(),this.h()},l(o){e=C(o,"HEADER",{class:!0});var B=V(e);l=C(B,"DIV",{class:!0});var s=V(l);n=C(s,"DIV",{class:!0});var M=V(n);i=H(M,t[6]),M.forEach(_),a=A(s),h=C(s,"DIV",{class:!0});var pe=V(h);d=C(pe,"DIV",{class:!0});var De=V(d);for(let x=0;x<w.length;x+=1)w[x].l(De);De.forEach(_),f=A(pe),c=C(pe,"BUTTON",{class:!0,"data-svelte-h":!0}),Se(c)!=="svelte-qy1k7w"&&(c.textContent=J),m=A(pe),g=C(pe,"BUTTON",{class:!0,"data-svelte-h":!0}),Se(g)!=="svelte-i2notl"&&(g.textContent=j),pe.forEach(_),s.forEach(_),ne=A(B),U=C(B,"DIV",{class:!0});var _e=V(U);L=C(_e,"DIV",{class:!0});var qe=V(L);v=C(qe,"LABEL",{class:!0,"data-svelte-h":!0}),Se(v)!=="svelte-1ekr4iz"&&(v.textContent=re),oe=A(qe),q=C(qe,"DIV",{class:!0});var xe=V(q);for(let x=0;x<O.length;x+=1)O[x].l(xe);xe.forEach(_),qe.forEach(_),Ce=A(_e),W=C(_e,"DIV",{class:!0});var Ie=V(W);K=C(Ie,"LABEL",{class:!0});var Pe=V(K);ue=H(Pe,"Filter "),ie=H(Pe,ee),he=H(Pe,":"),Pe.forEach(_),be=A(Ie),Z=C(Ie,"DIV",{class:!0});var je=V(Z);for(let x=0;x<z.length;x+=1)z[x].l(je);je.forEach(_),Ie.forEach(_),Ve=A(_e),R=C(_e,"DIV",{class:!0});var me=V(R);X=C(me,"LABEL",{class:!0});var we=V(X);Ee=H(we,"Filter "),r=H(we,ae),p=H(we,":"),we.forEach(_),S=A(me),E=C(me,"INPUT",{type:!0,placeholder:!0,class:!0}),G=A(me),b=C(me,"DIV",{class:!0});var Oe=V(b);for(let x=0;x<F.length;x+=1)F[x].l(Oe);I=A(Oe),N&&N.l(Oe),Oe.forEach(_),me.forEach(_),_e.forEach(_),B.forEach(_),this.h()},h(){y(n,"class","methodology svelte-hkg2yx"),y(d,"class","active-filters svelte-hkg2yx"),y(c,"class","reset svelte-hkg2yx"),y(g,"class","copy-config svelte-hkg2yx"),y(h,"class","header-buttons svelte-hkg2yx"),y(l,"class","header-info svelte-hkg2yx"),y(v,"class","svelte-hkg2yx"),y(q,"class","options svelte-hkg2yx"),y(L,"class","category svelte-hkg2yx"),y(K,"class","svelte-hkg2yx"),y(Z,"class","options tiny svelte-hkg2yx"),y(W,"class","filtered-cluster-values svelte-hkg2yx"),y(X,"class","svelte-hkg2yx"),y(E,"type","text"),y(E,"placeholder","Enter your query"),E.value=t[0],y(E,"class","svelte-hkg2yx"),y(b,"class","options tiny svelte-hkg2yx"),y(R,"class","filtered-entities svelte-hkg2yx"),y(U,"class","categories svelte-hkg2yx"),y(e,"class","svelte-hkg2yx")},m(o,B){$(o,e,B),u(e,l),u(l,n),u(n,i),u(l,a),u(l,h),u(h,d);for(let s=0;s<w.length;s+=1)w[s]&&w[s].m(d,null);u(h,f),u(h,c),u(h,m),u(h,g),u(e,ne),u(e,U),u(U,L),u(L,v),u(L,oe),u(L,q);for(let s=0;s<O.length;s+=1)O[s]&&O[s].m(q,null);u(U,Ce),u(U,W),u(W,K),u(K,ue),u(K,ie),u(K,he),u(W,be),u(W,Z);for(let s=0;s<z.length;s+=1)z[s]&&z[s].m(Z,null);u(U,Ve),u(U,R),u(R,X),u(X,Ee),u(X,r),u(X,p),u(R,S),u(R,E),u(R,G),u(R,b);for(let s=0;s<F.length;s+=1)F[s]&&F[s].m(b,null);u(b,I),N&&N.m(b,null),P||(Y=[ce(c,"click",t[12]),ce(g,"click",t[13]),ce(E,"input",t[8])],P=!0)},p(o,B){if(B[0]&64&&se(i,o[6]),B[0]&1032){D=le(o[3]);let s;for(s=0;s<D.length;s+=1){const M=Je(o,D,s);w[s]?w[s].p(M,B):(w[s]=We(M),w[s].c(),w[s].m(d,null))}for(;s<w.length;s+=1)w[s].d(1);w.length=D.length}if(B[0]&672){fe=le(o[7]);let s;for(s=0;s<fe.length;s+=1){const M=Ge(o,fe,s);O[s]?O[s].p(M,B):(O[s]=Ke(M),O[s].c(),O[s].m(q,null))}for(;s<O.length;s+=1)O[s].d(1);O.length=fe.length}if(B[0]&32&&ee!==(ee=o[5].clusterBy+"")&&se(ie,ee),B[0]&34850){de=le(o[1]);let s;for(s=0;s<de.length;s+=1){const M=Re(o,de,s);z[s]?z[s].p(M,B):(z[s]=Xe(M),z[s].c(),z[s].m(Z,null))}for(;s<z.length;s+=1)z[s].d(1);z.length=de.length}if(B[0]&32&&ae!==(ae=o[5].moveBy+"")&&se(r,ae),B[0]&1&&E.value!==o[0]&&(E.value=o[0]),B[0]&16404){ge=le(o[2].slice(0,50).sort(et));let s;for(s=0;s<ge.length;s+=1){const M=He(o,ge,s);F[s]?F[s].p(M,B):(F[s]=Ye(M),F[s].c(),F[s].m(b,I))}for(;s<F.length;s+=1)F[s].d(1);F.length=ge.length}o[2].length>50?N?N.p(o,B):(N=Ze(o),N.c(),N.m(b,null)):N&&(N.d(1),N=null)},i:Ne,o:Ne,d(o){o&&_(e),ze(w,o),ze(O,o),ze(z,o),ze(F,o),N&&N.d(),P=!1,at(Y)}}}const Te=12,Ct=30,Ae=12,bt=30;function $e(t,e){const l={city:"cities",sport:"sports",height:"heights",noc:"NOCs",team:"teams",weight:"weights",year:"years",age:"ages",event:"events",medal:"medals",name:"names"};return t===1?e:l[e]||`${e}s`}function Vt(t){return t.clusterBy?t.clusterBy:"all clusters"}function Et(t){return t.moveBy?t.moveBy:"participants"}function Bt(t){return Object.values(t).reduce((e,l)=>e+l.dataPoints.length,0)}const et=([t],[e])=>t.localeCompare(e);function St(t,e,l){let n,i,a,h,d,f,c,J,m,g,j,ne,U,L,v,re,oe;Be(t,ve,r=>l(4,L=r)),Be(t,te,r=>l(5,v=r)),Be(t,Ue,r=>l(20,re=r)),Be(t,dt,r=>l(21,oe=r));let q=v.queryValue||"";function Ce(r){r.target.value.length>3&&(l(0,q=r.target.value),te.update(p=>({...p,queryValue:q})))}const W=[],K=[];function ue(r,p){r==="clusterBy"?te.update(S=>({...S,clusterBy:p})):r==="moveBy"&&te.update(S=>({...S,moveBy:p}))}function ee(r){r.type==="clusterValue"?te.update(p=>({...p,selectedClusterValue:null})):r.type==="query"?(l(0,q=""),te.update(p=>({...p,queryValue:""}))):r.type==="name"&&ve.set([])}function ie(r){te.update(G=>({...G,selectedClusterValue:r}));const p=q.toLowerCase(),S=v.queryCategory||"name",E=[];Object.entries(Me(Ue)).forEach(([G,b])=>{const I=b.dataPoints.some(Y=>{var D;return((D=Y[v.clusterBy])==null?void 0:D.toString())===r.toString()}),P=b.dataPoints.some(Y=>{var D;return(D=Y[S])==null?void 0:D.toString().toLowerCase().includes(p)});I&&P&&(E.push(G),b.currentCategoryIndex=0,b.t=0,b.trail=[])}),ve.set(E)}function he(){te.update(r=>({...r,queryValue:"",selectedClusterValue:null})),l(0,q=""),ve.set([])}function be(){const r={title:"",description:"",methodology:"",media:!0,config:{clusterBy:v.clusterBy,moveBy:v.moveBy,selectedClusterValue:v.selectedClusterValue||"",queryValue:q,queryCategory:v.queryCategory||"name",speed:v.speed||3,stroke:v.stroke||1,loops:v.loopsToComplete||1,highlightedEntities:Me(ve)}},p=JSON.stringify(r,null,2);navigator.clipboard.writeText(p).then(()=>{alert("Config copied to clipboard!")}).catch(S=>{console.error("Could not copy text: ",S)})}function Z(r){return c===J?Te:Te+(r-c)*(Ct-Te)/(J-c)}function Ve(r){return j===ne?Ae:Ae+(r-j)*(bt-Ae)/(ne-j)}const R=r=>ee(r),X=r=>ue("clusterBy",r),Ee=r=>ie(r),ae=r=>ve.set([r]);return t.$$.update=()=>{t.$$.dirty[0]&2097152&&l(18,i=oe.map(([r])=>r)),t.$$.dirty[0]&1048609&&l(16,a=Object.entries(re).filter(([r,p])=>{const S=v.selectedClusterValue?p.dataPoints.some(I=>{var P;return((P=I[v.clusterBy])==null?void 0:P.toString())===v.selectedClusterValue.toString()}):!0,E=q.toLowerCase(),G=v.queryCategory||"name",b=E.length>=3?p.dataPoints.some(I=>{var P;return(P=I[G])==null?void 0:P.toString().toLowerCase().includes(E)}):!0;return S&&b}).reduce((r,[p,S])=>(r[p]=S,r),{})),t.$$.dirty[0]&57&&(l(3,h=[]),v.selectedClusterValue&&h.push({label:`${v.selectedClusterValue}`,type:"clusterValue"}),q&&h.push({label:`${q}`,type:"query"}),L.length===1&&h.push({label:`${L[0]}`,type:"name"}),h.length==0&&he()),t.$$.dirty[0]&65536&&l(2,d=Object.entries(a).map(([r,p])=>[r,p.dataPoints.length])),t.$$.dirty[0]&4&&l(19,f=d.map(([r,p])=>p)),t.$$.dirty[0]&524288&&(c=f.length>0?Math.min(...f):0),t.$$.dirty[0]&524288&&(J=f.length>0?Math.max(...f):1),t.$$.dirty[0]&1310736&&l(1,m=(()=>{const r=Object.values(re),p=new Set(L),S=p.size>0;let E=i;const G=[];S&&(E=i.filter(b=>{for(let I=0;I<r.length;I++){const P=r[I];if(p.has(P.moveBy)&&P.categories.includes(b))return!0}return!1}));for(let b=0;b<E.length;b++){const I=E[b];let P=0;for(let Y=0;Y<r.length;Y++){const D=r[Y];(!S||p.has(D.moveBy))&&D.categories.includes(I)&&P++}G.push([I,P])}return G})()),t.$$.dirty[0]&2&&l(17,g=m.map(([r,p])=>p)),t.$$.dirty[0]&131072&&(j=g.length>0?Math.min(...g):0),t.$$.dirty[0]&131072&&(ne=g.length>0?Math.max(...g):1),t.$$.dirty[0]&65584&&l(6,U=(()=>{const r=Vt(v);Et(v);const p=L.length==0?Bt(a):L.length;return`This visualization clusters ${p} ${$e(p,"participant")}, based on ${$e(r,r)}.`})())},l(7,n=vt.filter(r=>!W.includes(r))),yt.filter(r=>!K.includes(r)),l(3,h=[]),[q,m,d,h,L,v,U,n,Ce,ue,ee,ie,he,be,Z,Ve,a,g,i,f,re,oe,R,X,Ee,ae]}class qt extends lt{constructor(e){super(),st(this,e,St,kt,tt,{},null,[-1,-1])}}function It(t){let e,l="Loading...";return{c(){e=k("p"),e.textContent=l,this.h()},l(n){e=C(n,"P",{class:!0,"data-svelte-h":!0}),Se(e)!=="svelte-qdsr2u"&&(e.textContent=l),this.h()},h(){y(e,"class","svelte-13tgnqv")},m(n,i){$(n,e,i)},i:Ne,o:Ne,d(n){n&&_(e)}}}function Pt(t){let e,l,n;return l=new mt({}),{c(){e=k("div"),nt(l.$$.fragment),this.h()},l(i){e=C(i,"DIV",{class:!0});var a=V(e);rt(l.$$.fragment,a),a.forEach(_),this.h()},h(){y(e,"class","svelte-13tgnqv")},m(i,a){$(i,e,a),ot(l,e,null),n=!0},i(i){n||(Le(l.$$.fragment,i),n=!0)},o(i){Fe(l.$$.fragment,i),n=!1},d(i){i&&_(e),it(l)}}}function wt(t){let e,l,n,i,a,h,d;const f=[Pt,It],c=[];function J(m,g){return m[0].length>0?0:1}return l=J(t),n=c[l]=f[l](t),h=new qt({}),{c(){e=k("main"),n.c(),i=T(),a=k("div"),nt(h.$$.fragment),this.h()},l(m){e=C(m,"MAIN",{});var g=V(e);n.l(g),i=A(g),a=C(g,"DIV",{class:!0});var j=V(a);rt(h.$$.fragment,j),j.forEach(_),g.forEach(_),this.h()},h(){y(a,"class","svelte-13tgnqv")},m(m,g){$(m,e,g),c[l].m(e,null),u(e,i),u(e,a),ot(h,a,null),d=!0},p(m,[g]){let j=l;l=J(m),l!==j&&(ht(),Fe(c[j],1,1,()=>{c[j]=null}),ut(),n=c[l],n||(n=c[l]=f[l](m),n.c()),Le(n,1),n.m(e,i))},i(m){d||(Le(n),Le(h.$$.fragment,m),d=!0)},o(m){Fe(n),Fe(h.$$.fragment,m),d=!1},d(m){m&&_(e),c[l].d(),it(h)}}}function Ot(t,e,l){let n;return Be(t,Qe,i=>l(0,n=i)),ct(async()=>{const a=(await _t(ft+"/data/update-until-2022/data.tsv")).map(h=>{const d={};for(const[f,c]of Object.entries(h))d[f]=c!=null&&c.trim()?c:"NA";return d});Qe.set(a),gt.set(window.innerWidth),pt.set(600)}),[n]}class xt extends lt{constructor(e){super(),st(this,e,Ot,wt,tt,{})}}export{xt as component};
