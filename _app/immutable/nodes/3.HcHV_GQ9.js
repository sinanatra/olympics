const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/RecordRTC.Bv7qv1Kq.js","../chunks/_commonjsHelpers.Cpj98o6Y.js"])))=>i.map(i=>d[i]);
import{s as x,e as S,t as O,a as D,c as E,b as T,d as C,f as R,g as N,i as L,h as b,u as I,n as j,w as oe,y as Q,p as W,k as se,q as ae,m as ne,o as P,j as re}from"../chunks/scheduler.C4GZKIzL.js";import{S as ee,i as te,a as M,c as le,t as U,g as ie,b as F,d as K,m as z,f as G}from"../chunks/index.DmHFZWEd.js";import{b as ce}from"../chunks/paths.D-RuGml8.js";import{g as de,b as V,f as ue,d as X,w as fe,h as pe,a as me}from"../chunks/stores.CwAAUsJi.js";import{m as Y,t as _e,S as ge}from"../chunks/dsv.D85iOu-l.js";import{C as be}from"../chunks/ControlPanel.B7LShnDM.js";import{_ as ve}from"../chunks/preload-helper.C1FmrZbK.js";import{c as Z}from"../chunks/constants.CgZt1VnM.js";const he=async({fetch:n})=>({posts:await(await n("/api/snippets")).json()}),je=Object.freeze(Object.defineProperty({__proto__:null,load:he},Symbol.toStringTag,{value:"Module"}));function ye(n){let e,t,s,r,c,a,l,o,u,d,h,p,A,v,m,f,k,y;return{c(){e=S("div"),t=S("button"),s=O("Start Manual Recording"),c=D(),a=S("button"),l=O("Stop Manual Recording"),u=D(),d=S("button"),h=O("Start Auto-Recording"),A=D(),v=S("button"),m=O("Start Advanced Auto-Recording"),this.h()},l(i){e=E(i,"DIV",{});var _=T(e);t=E(_,"BUTTON",{});var g=T(t);s=C(g,"Start Manual Recording"),g.forEach(R),c=N(_),a=E(_,"BUTTON",{});var w=T(a);l=C(w,"Stop Manual Recording"),w.forEach(R),u=N(_),d=E(_,"BUTTON",{});var $=T(d);h=C($,"Start Auto-Recording"),$.forEach(R),A=N(_),v=E(_,"BUTTON",{});var B=T(v);m=C(B,"Start Advanced Auto-Recording"),B.forEach(R),_.forEach(R),this.h()},h(){t.disabled=r=n[0]||n[1]||n[2],a.disabled=o=!n[0]||n[1]||n[2],d.disabled=p=n[1]||n[2],v.disabled=f=n[2]||n[1]},m(i,_){L(i,e,_),b(e,t),b(t,s),b(e,c),b(e,a),b(a,l),b(e,u),b(e,d),b(d,h),b(e,A),b(e,v),b(v,m),k||(y=[I(t,"click",n[3]),I(a,"click",n[4]),I(d,"click",n[5]),I(v,"click",n[6])],k=!0)},p(i,[_]){_&7&&r!==(r=i[0]||i[1]||i[2])&&(t.disabled=r),_&7&&o!==(o=!i[0]||i[1]||i[2])&&(a.disabled=o),_&6&&p!==(p=i[1]||i[2])&&(d.disabled=p),_&6&&f!==(f=i[2]||i[1])&&(v.disabled=f)},i:j,o:j,d(i){i&&R(e),k=!1,oe(y)}}}const we=6e4;function Re(n,e,t){let s,r=!1,c=!1,a=!1,l=0,o;async function u(){const m=Q(de);if(m){const{default:f}=await ve(async()=>{const{default:y}=await import("../chunks/RecordRTC.Bv7qv1Kq.js").then(i=>i.R);return{default:y}},__vite__mapDeps([0,1]),import.meta.url),k=m.captureStream(30);s=new f(k,{type:"video",mimeType:"video/webm",videoBitsPerSecond:15e6}),s.startRecording(),t(0,r=!0),console.log("Recording started")}else console.error("Canvas not found")}async function d(){s&&r?(s.stopRecording(()=>{const m=s.getBlob(),f=document.createElement("a");f.href=URL.createObjectURL(m),f.download="canvas_recording.webm",f.click(),console.log("Recording stopped and saved")}),t(0,r=!1)):console.error("No active recording")}function h(){if(c)return;t(1,c=!0);const m=Object.keys(Z).filter(f=>f!=="name");console.log("Auto-recording started"),r||u(),setInterval(()=>{if(l>=m.length){console.log("All steps completed. Stopping auto-recording."),p();return}const f=m[l];V.update(k=>({...k,clusterBy:f})),console.log(`Updated clusterBy to: ${f}`),l++},we)}async function p(){c&&(clearInterval(o),t(1,c=!1),l=0,await d(),console.log("Auto-recording stopped"))}async function A(){if(a)return;t(2,a=!0);const m=Object.keys(Z).filter(y=>y!=="name");let f;console.log("Advanced auto-recording started"),r||await u();async function k(y){f=Q(ue);for(const i of f)V.update(_=>({..._,clusterBy:y,filters:{[y]:[i[0]]},speed:5})),await new Promise(_=>{Y.subscribe(g=>{g&&(Y.set(!1),_())})})}for(const y of m)if(V.update(i=>({...i,clusterBy:y,filters:{}})),await new Promise(i=>setTimeout(i,2e3)),await k(y),l++,l>=m.length){console.log("All categories and filters completed.");break}await v()}async function v(){a&&(t(2,a=!1),l=0,await d(),console.log("Advanced auto-recording stopped"))}return[r,c,a,u,d,h,A]}class ke extends ee{constructor(e){super(),te(this,e,Re,ye,x,{})}}function Ae(n){let e,t="...";return{c(){e=S("p"),e.textContent=t,this.h()},l(s){e=E(s,"P",{class:!0,"data-svelte-h":!0}),ne(e)!=="svelte-nvw4vi"&&(e.textContent=t),this.h()},h(){P(e,"class","svelte-wohxbi")},m(s,r){L(s,e,r)},p:j,i:j,o:j,d(s){s&&R(e)}}}function Se(n){var i,_;let e,t,s,r,c,a,l,o=(((_=(i=n[0].posts[n[1]])==null?void 0:i.meta)==null?void 0:_.title)||"No Title")+"",u,d,h,p,A,v,m,f,k,y;return s=new ge({}),p=new ke({}),m=new be({}),{c(){e=S("main"),t=S("div"),F(s.$$.fragment),r=D(),c=S("div"),a=S("button"),l=O("Select Story: "),u=O(o),d=D(),h=S("div"),F(p.$$.fragment),A=D(),v=S("div"),F(m.$$.fragment),this.h()},l(g){e=E(g,"MAIN",{});var w=T(e);t=E(w,"DIV",{class:!0});var $=T(t);K(s.$$.fragment,$),$.forEach(R),r=N(w),c=E(w,"DIV",{class:!0});var B=T(c);a=E(B,"BUTTON",{});var q=T(a);l=C(q,"Select Story: "),u=C(q,o),q.forEach(R),B.forEach(R),d=N(w),h=E(w,"DIV",{class:!0});var H=T(h);K(p.$$.fragment,H),H.forEach(R),A=N(w),v=E(w,"DIV",{class:!0});var J=T(v);K(m.$$.fragment,J),J.forEach(R),w.forEach(R),this.h()},h(){P(t,"class","svelte-wohxbi"),P(c,"class","svelte-wohxbi"),P(h,"class","svelte-wohxbi"),P(v,"class","svelte-wohxbi")},m(g,w){L(g,e,w),b(e,t),z(s,t,null),b(e,r),b(e,c),b(c,a),b(a,l),b(a,u),b(e,d),b(e,h),z(p,h,null),b(e,A),b(e,v),z(m,v,null),f=!0,k||(y=I(a,"click",n[3]),k=!0)},p(g,w){var $,B;(!f||w&3)&&o!==(o=(((B=($=g[0].posts[g[1]])==null?void 0:$.meta)==null?void 0:B.title)||"No Title")+"")&&re(u,o)},i(g){f||(U(s.$$.fragment,g),U(p.$$.fragment,g),U(m.$$.fragment,g),f=!0)},o(g){M(s.$$.fragment,g),M(p.$$.fragment,g),M(m.$$.fragment,g),f=!1},d(g){g&&R(e),G(s),G(p),G(m),k=!1,y()}}}function Ee(n){let e,t,s,r;const c=[Se,Ae],a=[];function l(o,u){return o[2].length>0?0:1}return e=l(n),t=a[e]=c[e](n),{c(){t.c(),s=W()},l(o){t.l(o),s=W()},m(o,u){a[e].m(o,u),L(o,s,u),r=!0},p(o,[u]){let d=e;e=l(o),e===d?a[e].p(o,u):(ie(),M(a[d],1,1,()=>{a[d]=null}),le(),t=a[e],t?t.p(o,u):(t=a[e]=c[e](o),t.c()),U(t,1),t.m(s.parentNode,s))},i(o){r||(U(t),r=!0)},o(o){M(t),r=!1},d(o){o&&R(s),a[e].d(o)}}}function Te(n,e,t){let s;se(n,X,l=>t(2,s=l));let{data:r}=e,c=-1;ae(async()=>{const o=(await _e(ce+"/data/update-until-2022/data.tsv")).map(u=>{const d={};for(const[h,p]of Object.entries(u))d[h]=p!=null&&p.trim()?p:"NA";return d});X.set(o),fe.set(3240),pe.set(1080)});const a=()=>{var l,o,u;t(1,c=(c+1)%r.posts.length),V.update(d=>{var h,p,A,v;return{...d,...(p=(h=r.posts[c])==null?void 0:h.meta)==null?void 0:p.config,caption:(v=(A=r.posts[c])==null?void 0:A.meta)==null?void 0:v.caption}}),me.set(((u=(o=(l=r.posts[c])==null?void 0:l.meta)==null?void 0:o.config)==null?void 0:u.highlightedEntities)||[])};return n.$$set=l=>{"data"in l&&t(0,r=l.data)},[r,c,s,a]}class Me extends ee{constructor(e){super(),te(this,e,Te,Ee,x,{data:0})}}export{Me as component,je as universal};
