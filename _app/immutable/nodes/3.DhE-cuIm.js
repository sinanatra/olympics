import{s as xe,e as v,a as F,t as G,c as g,b as E,l as ke,g as M,f as d,d as J,m as k,i as ee,h as u,E as re,j as oe,n as ze,B as Le,F as ot,k as Ee,G as se,r as pe,I as je,q as it}from"../chunks/scheduler.evRM0l9T.js";import{S as et,i as tt,b as lt,d as st,m as nt,t as Oe,c as at,a as Pe,e as rt,g as ct}from"../chunks/index.aiZKxZDj.js";import{b as ut}from"../chunks/paths.uGGLEvkw.js";import{h as ve,e as Qe,a as ge,f as ht,g as ft,i as dt,d as Ue,w as _t,b as vt}from"../chunks/constants.BgQT8P0G.js";import{t as gt,S as pt}from"../chunks/dsv.BltfF5KI.js";import{e as le}from"../chunks/each.D6YF6ztN.js";function He(t,e,l){const s=t.slice();return s[30]=e[l][0],s[31]=e[l][1],s}function Re(t,e,l){const s=t.slice();return s[31]=e[l][0],s[34]=e[l][1],s}function Ge(t,e,l){const s=t.slice();return s[37]=e[l],s}function Je(t,e,l){const s=t.slice();return s[37]=e[l],s}function We(t){let e,l=t[37]+"",s,a,h,f;function p(){return t[20](t[37])}return{c(){e=v("span"),s=G(l),a=F(),this.h()},l(c){e=g(c,"SPAN",{class:!0});var i=E(e);s=J(i,l),a=M(i),i.forEach(d),this.h()},h(){k(e,"class","svelte-1cvs0si"),se(e,"selected",t[37]===t[4].clusterBy)},m(c,i){ee(c,e,i),u(e,s),u(e,a),h||(f=re(e,"click",p),h=!0)},p(c,i){t=c,i[0]&64&&l!==(l=t[37]+"")&&oe(s,l),i[0]&80&&se(e,"selected",t[37]===t[4].clusterBy)},d(c){c&&d(e),h=!1,f()}}}function Ke(t){let e,l=t[37]+"",s,a,h,f;function p(){return t[21](t[37])}return{c(){e=v("span"),s=G(l),a=F(),this.h()},l(c){e=g(c,"SPAN",{class:!0});var i=E(e);s=J(i,l),a=M(i),i.forEach(d),this.h()},h(){k(e,"class","svelte-1cvs0si"),se(e,"selected",t[37]===t[4].moveBy)},m(c,i){ee(c,e,i),u(e,s),u(e,a),h||(f=re(e,"click",p),h=!0)},p(c,i){t=c,i[0]&32&&l!==(l=t[37]+"")&&oe(s,l),i[0]&48&&se(e,"selected",t[37]===t[4].moveBy)},d(c){c&&d(e),h=!1,f()}}}function Xe(t){let e,l=t[31]+"",s,a,h,f;function p(){return t[22](t[31])}return{c(){e=v("span"),s=G(l),a=F(),this.h()},l(c){e=g(c,"SPAN",{style:!0,class:!0});var i=E(e);s=J(i,l),a=M(i),i.forEach(d),this.h()},h(){pe(e,"font-size",t[13](t[34])+"px"),k(e,"class","svelte-1cvs0si"),se(e,"highlighted",t[31]==t[4].selectedClusterValue)},m(c,i){ee(c,e,i),u(e,s),u(e,a),h||(f=re(e,"click",p),h=!0)},p(c,i){t=c,i[0]&2&&l!==(l=t[31]+"")&&oe(s,l),i[0]&2&&pe(e,"font-size",t[13](t[34])+"px"),i[0]&18&&se(e,"highlighted",t[31]==t[4].selectedClusterValue)},d(c){c&&d(e),h=!1,f()}}}function Ye(t){let e,l=t[30]+"",s,a,h;function f(){return t[23](t[30])}return{c(){e=v("span"),s=G(l),this.h()},l(p){e=g(p,"SPAN",{style:!0,class:!0});var c=E(e);s=J(c,l),c.forEach(d),this.h()},h(){pe(e,"font-size",t[12](t[31])+"px"),k(e,"class","svelte-1cvs0si"),se(e,"highlighted",t[3].includes(t[30]))},m(p,c){ee(p,e,c),u(e,s),a||(h=re(e,"click",f),a=!0)},p(p,c){t=p,c[0]&4&&l!==(l=t[30]+"")&&oe(s,l),c[0]&4&&pe(e,"font-size",t[12](t[31])+"px"),c[0]&12&&se(e,"highlighted",t[3].includes(t[30]))},d(p){p&&d(e),a=!1,h()}}}function Ze(t){let e,l,s=t[2].length+"",a;return{c(){e=v("p"),l=G("50 out of "),a=G(s),this.h()},l(h){e=g(h,"P",{style:!0});var f=E(e);l=J(f,"50 out of "),a=J(f,s),f.forEach(d),this.h()},h(){pe(e,"border-top","1px solid"),pe(e,"padding-top","10px")},m(h,f){ee(h,e,f),u(e,l),u(e,a)},p(h,f){f[0]&4&&s!==(s=h[2].length+"")&&oe(a,s)},d(h){h&&d(e)}}}function mt(t){let e,l,s,a="Reset",h,f,p="Copy Config",c,i,A,m,q="Cluster By:",N,W,ne,T,b,ie="Move By:",K,Z,me,Y,X,ae,te=t[4].clusterBy+"",ce,ye,Ce,$,be,Q,x,o,_=t[4].moveBy+"",V,j,U,y,P,C,H,R,De,ue=le(t[6]),I=[];for(let r=0;r<ue.length;r+=1)I[r]=We(Je(t,ue,r));let he=le(t[5]),w=[];for(let r=0;r<he.length;r+=1)w[r]=Ke(Ge(t,he,r));let fe=le(t[1]),L=[];for(let r=0;r<fe.length;r+=1)L[r]=Xe(Re(t,fe,r));let de=le(t[2].slice(0,50).sort($e)),O=[];for(let r=0;r<de.length;r+=1)O[r]=Ye(He(t,de,r));let z=t[2].length>50&&Ze(t);return{c(){e=v("header"),l=v("div"),s=v("button"),s.textContent=a,h=F(),f=v("button"),f.textContent=p,c=F(),i=v("div"),A=v("div"),m=v("label"),m.textContent=q,N=F(),W=v("div");for(let r=0;r<I.length;r+=1)I[r].c();ne=F(),T=v("div"),b=v("label"),b.textContent=ie,K=F(),Z=v("div");for(let r=0;r<w.length;r+=1)w[r].c();me=F(),Y=v("div"),X=v("label"),ae=G("Values for "),ce=G(te),ye=G(":"),Ce=F(),$=v("div");for(let r=0;r<L.length;r+=1)L[r].c();be=F(),Q=v("div"),x=v("label"),o=G("Filter "),V=G(_),j=G(" By:"),U=F(),y=v("input"),P=F(),C=v("div");for(let r=0;r<O.length;r+=1)O[r].c();H=F(),z&&z.c(),this.h()},l(r){e=g(r,"HEADER",{class:!0});var S=E(e);l=g(S,"DIV",{class:!0});var n=E(l);s=g(n,"BUTTON",{class:!0,"data-svelte-h":!0}),ke(s)!=="svelte-qy1k7w"&&(s.textContent=a),h=M(n),f=g(n,"BUTTON",{class:!0,"data-svelte-h":!0}),ke(f)!=="svelte-18xqo2h"&&(f.textContent=p),n.forEach(d),c=M(S),i=g(S,"DIV",{class:!0});var B=E(i);A=g(B,"DIV",{class:!0});var Be=E(A);m=g(Be,"LABEL",{"data-svelte-h":!0}),ke(m)!=="svelte-1ekr4iz"&&(m.textContent=q),N=M(Be),W=g(Be,"DIV",{class:!0});var Fe=E(W);for(let D=0;D<I.length;D+=1)I[D].l(Fe);Fe.forEach(d),Be.forEach(d),ne=M(B),T=g(B,"DIV",{class:!0});var Ve=E(T);b=g(Ve,"LABEL",{"data-svelte-h":!0}),ke(b)!=="svelte-8r6yw"&&(b.textContent=ie),K=M(Ve),Z=g(Ve,"DIV",{class:!0});var Me=E(Z);for(let D=0;D<w.length;D+=1)w[D].l(Me);Me.forEach(d),Ve.forEach(d),me=M(B),Y=g(B,"DIV",{class:!0});var Se=E(Y);X=g(Se,"LABEL",{});var qe=E(X);ae=J(qe,"Values for "),ce=J(qe,te),ye=J(qe,":"),qe.forEach(d),Ce=M(Se),$=g(Se,"DIV",{class:!0});var Te=E($);for(let D=0;D<L.length;D+=1)L[D].l(Te);Te.forEach(d),Se.forEach(d),be=M(B),Q=g(B,"DIV",{class:!0});var _e=E(Q);x=g(_e,"LABEL",{});var Ie=E(x);o=J(Ie,"Filter "),V=J(Ie,_),j=J(Ie," By:"),Ie.forEach(d),U=M(_e),y=g(_e,"INPUT",{type:!0,placeholder:!0,class:!0}),P=M(_e),C=g(_e,"DIV",{class:!0});var we=E(C);for(let D=0;D<O.length;D+=1)O[D].l(we);H=M(we),z&&z.l(we),we.forEach(d),_e.forEach(d),B.forEach(d),S.forEach(d),this.h()},h(){k(s,"class","reset svelte-1cvs0si"),k(f,"class","copy-config svelte-1cvs0si"),k(l,"class","header-buttons svelte-1cvs0si"),k(W,"class","options svelte-1cvs0si"),k(A,"class","category svelte-1cvs0si"),k(Z,"class","options svelte-1cvs0si"),k(T,"class","category svelte-1cvs0si"),k($,"class","options tiny svelte-1cvs0si"),k(Y,"class","filtered-cluster-values svelte-1cvs0si"),k(y,"type","text"),k(y,"placeholder","Enter your query"),y.value=t[0],k(y,"class","svelte-1cvs0si"),k(C,"class","options tiny svelte-1cvs0si"),k(Q,"class","filtered-entities svelte-1cvs0si"),k(i,"class","categories svelte-1cvs0si"),k(e,"class","svelte-1cvs0si")},m(r,S){ee(r,e,S),u(e,l),u(l,s),u(l,h),u(l,f),u(e,c),u(e,i),u(i,A),u(A,m),u(A,N),u(A,W);for(let n=0;n<I.length;n+=1)I[n]&&I[n].m(W,null);u(i,ne),u(i,T),u(T,b),u(T,K),u(T,Z);for(let n=0;n<w.length;n+=1)w[n]&&w[n].m(Z,null);u(i,me),u(i,Y),u(Y,X),u(X,ae),u(X,ce),u(X,ye),u(Y,Ce),u(Y,$);for(let n=0;n<L.length;n+=1)L[n]&&L[n].m($,null);u(i,be),u(i,Q),u(Q,x),u(x,o),u(x,V),u(x,j),u(Q,U),u(Q,y),u(Q,P),u(Q,C);for(let n=0;n<O.length;n+=1)O[n]&&O[n].m(C,null);u(C,H),z&&z.m(C,null),R||(De=[re(s,"click",t[10]),re(f,"click",t[11]),re(y,"input",t[7])],R=!0)},p(r,S){if(S[0]&336){ue=le(r[6]);let n;for(n=0;n<ue.length;n+=1){const B=Je(r,ue,n);I[n]?I[n].p(B,S):(I[n]=We(B),I[n].c(),I[n].m(W,null))}for(;n<I.length;n+=1)I[n].d(1);I.length=ue.length}if(S[0]&304){he=le(r[5]);let n;for(n=0;n<he.length;n+=1){const B=Ge(r,he,n);w[n]?w[n].p(B,S):(w[n]=Ke(B),w[n].c(),w[n].m(Z,null))}for(;n<w.length;n+=1)w[n].d(1);w.length=he.length}if(S[0]&16&&te!==(te=r[4].clusterBy+"")&&oe(ce,te),S[0]&8722){fe=le(r[1]);let n;for(n=0;n<fe.length;n+=1){const B=Re(r,fe,n);L[n]?L[n].p(B,S):(L[n]=Xe(B),L[n].c(),L[n].m($,null))}for(;n<L.length;n+=1)L[n].d(1);L.length=fe.length}if(S[0]&16&&_!==(_=r[4].moveBy+"")&&oe(V,_),S[0]&1&&y.value!==r[0]&&(y.value=r[0]),S[0]&4108){de=le(r[2].slice(0,50).sort($e));let n;for(n=0;n<de.length;n+=1){const B=He(r,de,n);O[n]?O[n].p(B,S):(O[n]=Ye(B),O[n].c(),O[n].m(C,H))}for(;n<O.length;n+=1)O[n].d(1);O.length=de.length}r[2].length>50?z?z.p(r,S):(z=Ze(r),z.c(),z.m(C,null)):z&&(z.d(1),z=null)},i:ze,o:ze,d(r){r&&d(e),Le(I,r),Le(w,r),Le(L,r),Le(O,r),z&&z.d(),R=!1,ot(De)}}}const Ae=12,yt=30,Ne=12,Ct=30,$e=([t],[e])=>t.localeCompare(e);function bt(t,e,l){let s,a,h,f,p,c,i,A,m,q,N,W,ne,T,b,ie;Ee(t,ve,o=>l(3,ne=o)),Ee(t,Qe,o=>l(18,T=o)),Ee(t,ge,o=>l(4,b=o)),Ee(t,ht,o=>l(19,ie=o));let K=b.queryValue||"";function Z(o){o.target.value.length>3&&(l(0,K=o.target.value),ge.update(_=>({..._,queryValue:K})))}const me=[],Y=[];function X(o,_){te(),ve.set([]),o==="clusterBy"?ge.update(V=>({...V,clusterBy:_})):o==="moveBy"&&ge.update(V=>({...V,moveBy:_}))}function ae(o){ge.update(U=>({...U,selectedClusterValue:o}));const _=K.toLowerCase(),V=b.queryCategory||"name",j=[];Object.entries(je(Qe)).forEach(([U,y])=>{const P=y.dataPoints.some(H=>{var R;return((R=H[b.clusterBy])==null?void 0:R.toString())===o.toString()}),C=y.dataPoints.some(H=>{var R;return(R=H[V])==null?void 0:R.toString().toLowerCase().includes(_)});P&&C&&(j.push(U),y.currentCategoryIndex=0,y.t=0,y.trail=[])}),ve.set(j)}function te(){ge.update(o=>({...o,queryValue:"",selectedClusterValue:null})),l(0,K=""),ve.set([])}function ce(){const o={title:"",description:"",methodology:"",media:!0,config:{clusterBy:b.clusterBy,moveBy:b.moveBy,selectedClusterValue:b.selectedClusterValue||"",queryValue:K,queryCategory:b.queryCategory||"name",speed:b.speed||3,stroke:b.stroke||1,loops:b.loopsToComplete||1,highlightedEntities:je(ve)}},_=JSON.stringify(o,null,2);navigator.clipboard.writeText(_).then(()=>{alert("Config copied to clipboard!")}).catch(V=>{console.error("Could not copy text: ",V)})}function ye(o){return i===A?Ae:Ae+(o-i)*(yt-Ae)/(A-i)}function Ce(o){return N===W?Ne:Ne+(o-N)*(Ct-Ne)/(W-N)}const $=o=>X("clusterBy",o),be=o=>X("moveBy",o),Q=o=>ae(o),x=o=>ve.set([o]);return t.$$.update=()=>{t.$$.dirty[0]&524288&&l(15,h=ie.map(([o])=>o)),t.$$.dirty[0]&262161&&l(17,f=Object.entries(T).filter(([o,_])=>{const V=b.selectedClusterValue?_.dataPoints.some(P=>{var C;return((C=P[b.clusterBy])==null?void 0:C.toString())===b.selectedClusterValue.toString()}):!0,j=K.toLowerCase(),U=b.queryCategory||"name",y=j.length>=3?_.dataPoints.some(P=>{var C;return(C=P[U])==null?void 0:C.toString().toLowerCase().includes(j)}):!0;return V&&y}).reduce((o,[_,V])=>(o[_]=V,o),{})),t.$$.dirty[0]&131072&&l(2,p=Object.entries(f).map(([o,_])=>[o,_.dataPoints.length])),t.$$.dirty[0]&4&&l(16,c=p.map(([o,_])=>_)),t.$$.dirty[0]&65536&&(i=c.length>0?Math.min(...c):0),t.$$.dirty[0]&65536&&(A=c.length>0?Math.max(...c):1),t.$$.dirty[0]&294920&&l(1,m=(()=>{const o=Object.values(T),_=new Set(ne),V=_.size>0;let j=h;const U=[];V&&(j=h.filter(y=>{for(let P=0;P<o.length;P++){const C=o[P];if(_.has(C.moveBy)&&C.categories.includes(y))return!0}return!1}));for(let y=0;y<j.length;y++){const P=j[y];let C=0;for(let H=0;H<o.length;H++){const R=o[H];(!V||_.has(R.moveBy))&&R.categories.includes(P)&&C++}U.push([P,C])}return U})()),t.$$.dirty[0]&2&&l(14,q=m.map(([o,_])=>_)),t.$$.dirty[0]&16384&&(N=q.length>0?Math.min(...q):0),t.$$.dirty[0]&16384&&(W=q.length>0?Math.max(...q):1)},l(6,s=ft.filter(o=>!me.includes(o))),l(5,a=dt.filter(o=>!Y.includes(o))),[K,m,p,ne,b,a,s,Z,X,ae,te,ce,ye,Ce,q,h,c,f,T,ie,$,be,Q,x]}class kt extends et{constructor(e){super(),tt(this,e,bt,mt,xe,{},null,[-1,-1])}}function Et(t){let e,l="Loading...";return{c(){e=v("p"),e.textContent=l,this.h()},l(s){e=g(s,"P",{class:!0,"data-svelte-h":!0}),ke(e)!=="svelte-qdsr2u"&&(e.textContent=l),this.h()},h(){k(e,"class","svelte-13tgnqv")},m(s,a){ee(s,e,a)},i:ze,o:ze,d(s){s&&d(e)}}}function Bt(t){let e,l,s;return l=new pt({}),{c(){e=v("div"),lt(l.$$.fragment),this.h()},l(a){e=g(a,"DIV",{class:!0});var h=E(e);st(l.$$.fragment,h),h.forEach(d),this.h()},h(){k(e,"class","svelte-13tgnqv")},m(a,h){ee(a,e,h),nt(l,e,null),s=!0},i(a){s||(Pe(l.$$.fragment,a),s=!0)},o(a){Oe(l.$$.fragment,a),s=!1},d(a){a&&d(e),rt(l)}}}function Vt(t){let e,l,s,a,h,f,p;const c=[Bt,Et],i=[];function A(m,q){return m[0].length>0?0:1}return l=A(t),s=i[l]=c[l](t),f=new kt({}),{c(){e=v("main"),s.c(),a=F(),h=v("div"),lt(f.$$.fragment),this.h()},l(m){e=g(m,"MAIN",{});var q=E(e);s.l(q),a=M(q),h=g(q,"DIV",{class:!0});var N=E(h);st(f.$$.fragment,N),N.forEach(d),q.forEach(d),this.h()},h(){k(h,"class","svelte-13tgnqv")},m(m,q){ee(m,e,q),i[l].m(e,null),u(e,a),u(e,h),nt(f,h,null),p=!0},p(m,[q]){let N=l;l=A(m),l!==N&&(ct(),Oe(i[N],1,1,()=>{i[N]=null}),at(),s=i[l],s||(s=i[l]=c[l](m),s.c()),Pe(s,1),s.m(e,a))},i(m){p||(Pe(s),Pe(f.$$.fragment,m),p=!0)},o(m){Oe(s),Oe(f.$$.fragment,m),p=!1},d(m){m&&d(e),i[l].d(),rt(f)}}}function St(t,e,l){let s;return Ee(t,Ue,a=>l(0,s=a)),it(async()=>{const a=await gt(ut+"/data/update-until-2022/data.tsv");Ue.set(a),_t.set(window.innerWidth),vt.set(600)}),[s]}class zt extends et{constructor(e){super(),tt(this,e,St,Vt,xe,{})}}export{zt as component};
