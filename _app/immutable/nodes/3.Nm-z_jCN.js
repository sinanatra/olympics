import{s as Ke,e as k,t as J,a as N,c as V,b as E,d as W,f as y,g as T,l as Ce,m as b,i as X,h as f,E as ne,j as re,n as Ie,B as Be,F as lt,k as ye,G as de,r as pe,I as Ne,q as st}from"../chunks/scheduler.evRM0l9T.js";import{S as Xe,i as Ye,b as Ze,d as $e,m as et,t as Se,c as nt,a as qe,e as tt,g as rt}from"../chunks/index.aiZKxZDj.js";import{b as ot}from"../chunks/paths.Bzgx7l6R.js";import{h as fe,c as se,e as Te,b as it,d as De,w as at,a as ct}from"../chunks/stores.D9mTdjSf.js";import{t as ut,S as ht}from"../chunks/dsv.D3hnXDw1.js";import{e as Z}from"../chunks/each.D6YF6ztN.js";import{f as ft,a as dt}from"../chunks/constants.CA4Cg4R8.js";function Ae(t,e,l){const n=t.slice();return n[33]=e[l][0],n[34]=e[l][1],n}function Le(t,e,l){const n=t.slice();return n[34]=e[l][0],n[37]=e[l][1],n}function je(t,e,l){const n=t.slice();return n[40]=e[l],n}function Me(t,e,l){const n=t.slice();return n[43]=e[l],n}function Ue(t){let e,l=t[43].label+"",n,i,a,u="x",d,h,c;function Q(){return t[22](t[43])}return{c(){e=k("span"),n=J(l),i=N(),a=k("button"),a.textContent=u,d=N(),this.h()},l(v){e=V(v,"SPAN",{class:!0});var p=E(e);n=W(p,l),i=T(p),a=V(p,"BUTTON",{class:!0,"data-svelte-h":!0}),Ce(a)!=="svelte-1drtrua"&&(a.textContent=u),d=T(p),p.forEach(y),this.h()},h(){b(a,"class","svelte-1ox4xy3"),b(e,"class","filter svelte-1ox4xy3")},m(v,p){X(v,e,p),f(e,n),f(e,i),f(e,a),f(e,d),h||(c=ne(e,"click",Q),h=!0)},p(v,p){t=v,p[0]&8&&l!==(l=t[43].label+"")&&re(n,l)},d(v){v&&y(e),h=!1,c()}}}function Qe(t){let e,l=t[40]+"",n,i,a,u;function d(){return t[23](t[40])}return{c(){e=k("span"),n=J(l),i=N(),this.h()},l(h){e=V(h,"SPAN",{class:!0});var c=E(e);n=W(c,l),i=T(c),c.forEach(y),this.h()},h(){b(e,"class","svelte-1ox4xy3"),de(e,"selected",t[40]===t[5].clusterBy)},m(h,c){X(h,e,c),f(e,n),f(e,i),a||(u=ne(e,"click",d),a=!0)},p(h,c){t=h,c[0]&128&&l!==(l=t[40]+"")&&re(n,l),c[0]&160&&de(e,"selected",t[40]===t[5].clusterBy)},d(h){h&&y(e),a=!1,u()}}}function He(t){let e,l=t[34]+"",n,i,a,u;function d(){return t[24](t[34])}return{c(){e=k("span"),n=J(l),i=N(),this.h()},l(h){e=V(h,"SPAN",{style:!0,class:!0});var c=E(e);n=W(c,l),i=T(c),c.forEach(y),this.h()},h(){pe(e,"font-size",t[15](t[37])+"px"),b(e,"class","svelte-1ox4xy3"),de(e,"highlighted",t[34]==t[5].selectedClusterValue)},m(h,c){X(h,e,c),f(e,n),f(e,i),a||(u=ne(e,"click",d),a=!0)},p(h,c){t=h,c[0]&2&&l!==(l=t[34]+"")&&re(n,l),c[0]&2&&pe(e,"font-size",t[15](t[37])+"px"),c[0]&34&&de(e,"highlighted",t[34]==t[5].selectedClusterValue)},d(h){h&&y(e),a=!1,u()}}}function Re(t){let e,l=t[33]+"",n,i,a;function u(){return t[25](t[33])}return{c(){e=k("span"),n=J(l),this.h()},l(d){e=V(d,"SPAN",{style:!0,class:!0});var h=E(e);n=W(h,l),h.forEach(y),this.h()},h(){pe(e,"font-size",t[14](t[34])+"px"),b(e,"class","svelte-1ox4xy3"),de(e,"highlighted",t[4].includes(t[33]))},m(d,h){X(d,e,h),f(e,n),i||(a=ne(e,"click",u),i=!0)},p(d,h){t=d,h[0]&4&&l!==(l=t[33]+"")&&re(n,l),h[0]&4&&pe(e,"font-size",t[14](t[34])+"px"),h[0]&20&&de(e,"highlighted",t[4].includes(t[33]))},d(d){d&&y(e),i=!1,a()}}}function Ge(t){let e,l,n=t[2].length+"",i;return{c(){e=k("p"),l=J("50 out of "),i=J(n),this.h()},l(a){e=V(a,"P",{style:!0});var u=E(e);l=W(u,"50 out of "),i=W(u,n),u.forEach(y),this.h()},h(){pe(e,"border-top","1px solid"),pe(e,"padding-top","10px")},m(a,u){X(a,e,u),f(e,l),f(e,i)},p(a,u){u[0]&4&&n!==(n=a[2].length+"")&&re(i,n)},d(a){a&&y(e)}}}function pt(t){let e,l,n,i,a,u,d,h,c,Q="Reset",v,p,D="Copy Config",$,j,P,C,ee="Cluster By:",te,O,ge,H,R,oe,Y=t[5].clusterBy+"",le,ie,_e,K,me,G,M,ae,ve,r,g,S,U,z=Z(t[3]),_=[];for(let o=0;o<z.length;o+=1)_[o]=Ue(Me(t,z,o));let q=Z(t[7]),m=[];for(let o=0;o<q.length;o+=1)m[o]=Qe(je(t,q,o));let A=Z(t[1]),x=[];for(let o=0;o<A.length;o+=1)x[o]=He(Le(t,A,o));let ce=Z(t[2].slice(0,50).sort(We)),I=[];for(let o=0;o<ce.length;o+=1)I[o]=Re(Ae(t,ce,o));let w=t[2].length>50&&Ge(t);return{c(){e=k("header"),l=k("div"),n=k("div"),i=J(t[6]),a=N(),u=k("div"),d=k("div");for(let o=0;o<_.length;o+=1)_[o].c();h=N(),c=k("button"),c.textContent=Q,v=N(),p=k("button"),p.textContent=D,$=N(),j=k("div"),P=k("div"),C=k("label"),C.textContent=ee,te=N(),O=k("div");for(let o=0;o<m.length;o+=1)m[o].c();ge=N(),H=k("div"),R=k("label"),oe=J("Filter "),le=J(Y),ie=J(":"),_e=N(),K=k("div");for(let o=0;o<x.length;o+=1)x[o].c();me=N(),G=k("div"),M=k("input"),ve=N(),r=k("div");for(let o=0;o<I.length;o+=1)I[o].c();g=N(),w&&w.c(),this.h()},l(o){e=V(o,"HEADER",{class:!0});var B=E(e);l=V(B,"DIV",{class:!0});var s=E(l);n=V(s,"DIV",{class:!0});var L=E(n);i=W(L,t[6]),L.forEach(y),a=T(s),u=V(s,"DIV",{class:!0});var ue=E(u);d=V(ue,"DIV",{class:!0});var Oe=E(d);for(let F=0;F<_.length;F+=1)_[F].l(Oe);Oe.forEach(y),h=T(ue),c=V(ue,"BUTTON",{class:!0,"data-svelte-h":!0}),Ce(c)!=="svelte-qy1k7w"&&(c.textContent=Q),v=T(ue),p=V(ue,"BUTTON",{class:!0,"data-svelte-h":!0}),Ce(p)!=="svelte-i2notl"&&(p.textContent=D),ue.forEach(y),s.forEach(y),$=T(B),j=V(B,"DIV",{class:!0});var he=E(j);P=V(he,"DIV",{class:!0});var be=E(P);C=V(be,"LABEL",{class:!0,"data-svelte-h":!0}),Ce(C)!=="svelte-1ekr4iz"&&(C.textContent=ee),te=T(be),O=V(be,"DIV",{class:!0});var ze=E(O);for(let F=0;F<m.length;F+=1)m[F].l(ze);ze.forEach(y),be.forEach(y),ge=T(he),H=V(he,"DIV",{class:!0});var ke=E(H);R=V(ke,"LABEL",{class:!0});var Ve=E(R);oe=W(Ve,"Filter "),le=W(Ve,Y),ie=W(Ve,":"),Ve.forEach(y),_e=T(ke),K=V(ke,"DIV",{class:!0});var Fe=E(K);for(let F=0;F<x.length;F+=1)x[F].l(Fe);Fe.forEach(y),ke.forEach(y),me=T(he),G=V(he,"DIV",{class:!0});var xe=E(G);M=V(xe,"INPUT",{type:!0,placeholder:!0,class:!0}),ve=T(xe),r=V(xe,"DIV",{class:!0});var Ee=E(r);for(let F=0;F<I.length;F+=1)I[F].l(Ee);g=T(Ee),w&&w.l(Ee),Ee.forEach(y),xe.forEach(y),he.forEach(y),B.forEach(y),this.h()},h(){b(n,"class","methodology svelte-1ox4xy3"),b(d,"class","active-filters svelte-1ox4xy3"),b(c,"class","reset svelte-1ox4xy3"),b(p,"class","copy-config svelte-1ox4xy3"),b(u,"class","header-buttons svelte-1ox4xy3"),b(l,"class","header-info svelte-1ox4xy3"),b(C,"class","svelte-1ox4xy3"),b(O,"class","options svelte-1ox4xy3"),b(P,"class","category svelte-1ox4xy3"),b(R,"class","svelte-1ox4xy3"),b(K,"class","options tiny svelte-1ox4xy3"),b(H,"class","filtered-cluster-values svelte-1ox4xy3"),b(M,"type","text"),b(M,"placeholder",ae="Filter "+t[5].moveBy+"..."),M.value=t[0],b(M,"class","svelte-1ox4xy3"),b(r,"class","options tiny svelte-1ox4xy3"),b(G,"class","filtered-entities svelte-1ox4xy3"),b(j,"class","categories svelte-1ox4xy3"),b(e,"class","svelte-1ox4xy3")},m(o,B){X(o,e,B),f(e,l),f(l,n),f(n,i),f(l,a),f(l,u),f(u,d);for(let s=0;s<_.length;s+=1)_[s]&&_[s].m(d,null);f(u,h),f(u,c),f(u,v),f(u,p),f(e,$),f(e,j),f(j,P),f(P,C),f(P,te),f(P,O);for(let s=0;s<m.length;s+=1)m[s]&&m[s].m(O,null);f(j,ge),f(j,H),f(H,R),f(R,oe),f(R,le),f(R,ie),f(H,_e),f(H,K);for(let s=0;s<x.length;s+=1)x[s]&&x[s].m(K,null);f(j,me),f(j,G),f(G,M),f(G,ve),f(G,r);for(let s=0;s<I.length;s+=1)I[s]&&I[s].m(r,null);f(r,g),w&&w.m(r,null),S||(U=[ne(c,"click",t[12]),ne(p,"click",t[13]),ne(M,"input",t[8])],S=!0)},p(o,B){if(B[0]&64&&re(i,o[6]),B[0]&1032){z=Z(o[3]);let s;for(s=0;s<z.length;s+=1){const L=Me(o,z,s);_[s]?_[s].p(L,B):(_[s]=Ue(L),_[s].c(),_[s].m(d,null))}for(;s<_.length;s+=1)_[s].d(1);_.length=z.length}if(B[0]&672){q=Z(o[7]);let s;for(s=0;s<q.length;s+=1){const L=je(o,q,s);m[s]?m[s].p(L,B):(m[s]=Qe(L),m[s].c(),m[s].m(O,null))}for(;s<m.length;s+=1)m[s].d(1);m.length=q.length}if(B[0]&32&&Y!==(Y=o[5].clusterBy+"")&&re(le,Y),B[0]&34850){A=Z(o[1]);let s;for(s=0;s<A.length;s+=1){const L=Le(o,A,s);x[s]?x[s].p(L,B):(x[s]=He(L),x[s].c(),x[s].m(K,null))}for(;s<x.length;s+=1)x[s].d(1);x.length=A.length}if(B[0]&32&&ae!==(ae="Filter "+o[5].moveBy+"...")&&b(M,"placeholder",ae),B[0]&1&&M.value!==o[0]&&(M.value=o[0]),B[0]&16404){ce=Z(o[2].slice(0,50).sort(We));let s;for(s=0;s<ce.length;s+=1){const L=Ae(o,ce,s);I[s]?I[s].p(L,B):(I[s]=Re(L),I[s].c(),I[s].m(r,g))}for(;s<I.length;s+=1)I[s].d(1);I.length=ce.length}o[2].length>50?w?w.p(o,B):(w=Ge(o),w.c(),w.m(r,null)):w&&(w.d(1),w=null)},i:Ie,o:Ie,d(o){o&&y(e),Be(_,o),Be(m,o),Be(x,o),Be(I,o),w&&w.d(),S=!1,lt(U)}}}const Pe=12,gt=30,we=12,_t=30;function Je(t,e){const l={city:"cities",sport:"sports",height:"heights",noc:"NOCs",team:"teams",weight:"weights",year:"years",age:"ages",event:"events",medal:"medals",name:"names"};return t===1?e:l[e]||`${e}s`}function mt(t){return t.clusterBy?t.clusterBy:"all clusters"}function vt(t){return t.moveBy?t.moveBy:"participants"}function yt(t){return Object.values(t).reduce((e,l)=>e+l.dataPoints.length,0)}const We=([t],[e])=>t.localeCompare(e);function Ct(t,e,l){let n,i,a,u,d,h,c,Q,v,p,D,$,j,P,C,ee,te;ye(t,fe,r=>l(4,P=r)),ye(t,se,r=>l(5,C=r)),ye(t,Te,r=>l(20,ee=r)),ye(t,it,r=>l(21,te=r));let O=C.queryValue||"";function ge(r){r.target.value.length>3&&l(0,O=r.target.value)}const H=[],R=[];function oe(r,g){r==="clusterBy"?se.update(S=>({...S,clusterBy:g})):r==="moveBy"&&se.update(S=>({...S,moveBy:g}))}function Y(r){r.type==="clusterValue"?se.update(g=>({...g,selectedClusterValue:null})):r.type==="query"?(l(0,O=""),se.update(g=>({...g,queryValue:""}))):r.type==="name"&&fe.set([])}function le(r){se.update(z=>({...z,selectedClusterValue:r}));const g=O.toLowerCase(),S=C.queryCategory||"name",U=[];Object.entries(Ne(Te)).forEach(([z,_])=>{const q=_.dataPoints.some(A=>{var x;return((x=A[C.clusterBy])==null?void 0:x.toString())===r.toString()}),m=_.dataPoints.some(A=>{var x;return(x=A[S])==null?void 0:x.toString().toLowerCase().includes(g)});q&&m&&(U.push(z),_.currentCategoryIndex=0,_.t=0,_.trail=[])}),fe.set(U)}function ie(){se.update(r=>({...r,queryValue:"",selectedClusterValue:null})),l(0,O=""),fe.set([])}function _e(){const r={title:"",description:"",methodology:"",media:!0,config:{clusterBy:C.clusterBy,moveBy:C.moveBy,selectedClusterValue:C.selectedClusterValue||"",queryValue:O,queryCategory:C.queryCategory||"name",speed:C.speed||3,stroke:C.stroke||1,loops:C.loopsToComplete||1,highlightedEntities:Ne(fe)}},g=JSON.stringify(r,null,2);navigator.clipboard.writeText(g).then(()=>{alert("Config copied to clipboard!")}).catch(S=>{console.error("Could not copy text: ",S)})}function K(r){return c===Q?Pe:Pe+(r-c)*(gt-Pe)/(Q-c)}function me(r){return D===$?we:we+(r-D)*(_t-we)/($-D)}const G=r=>Y(r),M=r=>oe("clusterBy",r),ae=r=>le(r),ve=r=>fe.set([r]);return t.$$.update=()=>{t.$$.dirty[0]&2097152&&l(18,i=te.map(([r])=>r)),t.$$.dirty[0]&1048609&&l(16,a=Object.entries(ee).filter(([r,g])=>{const S=C.selectedClusterValue?g.dataPoints.some(q=>{var m;return((m=q[C.clusterBy])==null?void 0:m.toString())===C.selectedClusterValue.toString()}):!0,U=O.toLowerCase(),z=C.queryCategory||"name",_=U.length>=3?g.dataPoints.some(q=>{var m;return(m=q[z])==null?void 0:m.toString().toLowerCase().includes(U)}):!0;return S&&_}).reduce((r,[g,S])=>(r[g]=S,r),{})),t.$$.dirty[0]&56&&(l(3,u=[]),C.selectedClusterValue&&u.push({label:`${C.selectedClusterValue}`,type:"clusterValue"}),P.length===1&&u.push({label:`${P[0]}`,type:"name"}),u.length==0&&ie()),t.$$.dirty[0]&65536&&l(2,d=Object.entries(a).map(([r,g])=>[r,g.dataPoints.length])),t.$$.dirty[0]&4&&l(19,h=d.map(([r,g])=>g)),t.$$.dirty[0]&524288&&(c=h.length>0?Math.min(...h):0),t.$$.dirty[0]&524288&&(Q=h.length>0?Math.max(...h):1),t.$$.dirty[0]&1310736&&l(1,v=(()=>{const r=Object.values(ee),g=new Set(P),S=g.size>0;let U=i;const z=[];S&&(U=i.filter(_=>{for(let q=0;q<r.length;q++){const m=r[q];if(g.has(m.moveBy)&&m.categories.includes(_))return!0}return!1}));for(let _=0;_<U.length;_++){const q=U[_];let m=0;for(let A=0;A<r.length;A++){const x=r[A];(!S||g.has(x.moveBy))&&x.categories.includes(q)&&m++}z.push([q,m])}return z})()),t.$$.dirty[0]&2&&l(17,p=v.map(([r,g])=>g)),t.$$.dirty[0]&131072&&(D=p.length>0?Math.min(...p):0),t.$$.dirty[0]&131072&&($=p.length>0?Math.max(...p):1),t.$$.dirty[0]&65584&&l(6,j=(()=>{const r=mt(C);vt(C);const g=P.length==0?yt(a):P.length;return`This visualization clusters ${g} ${Je(g,"participant")}, based on ${Je(r,r)}.`})())},l(7,n=ft.filter(r=>!H.includes(r))),dt.filter(r=>!R.includes(r)),l(3,u=[]),[O,v,d,u,P,C,j,n,ge,oe,Y,le,ie,_e,K,me,a,p,i,h,ee,te,G,M,ae,ve]}class bt extends Xe{constructor(e){super(),Ye(this,e,Ct,pt,Ke,{},null,[-1,-1])}}function kt(t){let e,l="Loading...";return{c(){e=k("p"),e.textContent=l,this.h()},l(n){e=V(n,"P",{class:!0,"data-svelte-h":!0}),Ce(e)!=="svelte-qdsr2u"&&(e.textContent=l),this.h()},h(){b(e,"class","svelte-13tgnqv")},m(n,i){X(n,e,i)},i:Ie,o:Ie,d(n){n&&y(e)}}}function Vt(t){let e,l,n;return l=new ht({}),{c(){e=k("div"),Ze(l.$$.fragment),this.h()},l(i){e=V(i,"DIV",{class:!0});var a=E(e);$e(l.$$.fragment,a),a.forEach(y),this.h()},h(){b(e,"class","svelte-13tgnqv")},m(i,a){X(i,e,a),et(l,e,null),n=!0},i(i){n||(qe(l.$$.fragment,i),n=!0)},o(i){Se(l.$$.fragment,i),n=!1},d(i){i&&y(e),tt(l)}}}function xt(t){let e,l,n,i,a,u,d;const h=[Vt,kt],c=[];function Q(v,p){return v[0].length>0?0:1}return l=Q(t),n=c[l]=h[l](t),u=new bt({}),{c(){e=k("main"),n.c(),i=N(),a=k("div"),Ze(u.$$.fragment),this.h()},l(v){e=V(v,"MAIN",{});var p=E(e);n.l(p),i=T(p),a=V(p,"DIV",{class:!0});var D=E(a);$e(u.$$.fragment,D),D.forEach(y),p.forEach(y),this.h()},h(){b(a,"class","svelte-13tgnqv")},m(v,p){X(v,e,p),c[l].m(e,null),f(e,i),f(e,a),et(u,a,null),d=!0},p(v,[p]){let D=l;l=Q(v),l!==D&&(rt(),Se(c[D],1,1,()=>{c[D]=null}),nt(),n=c[l],n||(n=c[l]=h[l](v),n.c()),qe(n,1),n.m(e,i))},i(v){d||(qe(n),qe(u.$$.fragment,v),d=!0)},o(v){Se(n),Se(u.$$.fragment,v),d=!1},d(v){v&&y(e),c[l].d(),tt(u)}}}function Et(t,e,l){let n;return ye(t,De,i=>l(0,n=i)),st(async()=>{const a=(await ut(ot+"/data/update-until-2022/data.tsv")).map(u=>{const d={};for(const[h,c]of Object.entries(u))d[h]=c!=null&&c.trim()?c:"NA";return d});De.set(a),at.set(window.innerWidth),ct.set(600)}),[n]}class zt extends Xe{constructor(e){super(),Ye(this,e,Et,xt,Ke,{})}}export{zt as component};
